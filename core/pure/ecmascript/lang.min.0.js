function n(){throw"TheLanguage PANIC";}function aa(a,b){return[10,a,b]}exports.new_comment=aa;function q(a){return 10===a[0]}exports.comment_p=q;exports.comment_comment=function(a){return a[1]};exports.comment_x=function(a){return a[2]};function ca(a){for(;q(a);)a=a[2];return a}exports.un_comment_all=ca;function t(a){return 0===a[0]}exports.atom_p=t;exports.new_atom=function(a){return[0,a]};exports.un_atom=function(a){return a[1]};function v(a,b){return a===b?!0:a[1]===b[1]?(w(a,b),!0):!1}
exports.atom_equal_p=v;function da(a,b){return[1,a,b]}exports.new_construction=da;function x(a){return 1===a[0]}exports.construction_p=x;function ea(a){return a[1]}exports.construction_head=ea;function fa(a){return a[2]}exports.construction_tail=fa;var y=[2];exports.null_v=y;function z(a){return 2===a[0]}exports.null_p=z;function ha(a,b){return[3,a,b]}exports.new_data=ha;function A(a){return 3===a[0]}exports.data_p=A;function ia(a){return a[1]}exports.data_name=ia;function ja(a){return a[2]}
exports.data_list=ja;function ka(a){return 4===a[0]}exports.just_p=ka;exports.evaluate=function(a,b){return[5,a,b]};function la(a){return a[2]}function C(a,b){return[6,a,b]}function ma(a,b){return[8,a,b]}exports.apply=ma;function na(a){a=D(a);if(A(a)||x(a)||q(a))a[1]=na(a[1]),a[2]=na(a[2]);return a}exports.force_all_rec=na;function oa(a){var b=pa(a);if(A(b)||x(b))if(b[1]=na(b[1]),b[2]=na(b[2]),q(b[1])||q(b[2])){a=[9];qa(a,b);var c=b[2];b=oa(b[1]);c=oa(c);a[1]=b;a[2]=c}else a=b;else a=b;return a}
exports.force_uncomment_all_rec=oa;exports.unlazy_all_rec=oa;function w(a,b){a!==b&&(a===y&&(a=b,b=y),a[0]=4,a[1]=b,a[2]=!1,a[3]=!1)}function qa(a,b){9===a[0]||n();9!==b[0]||n();a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3]}
var E=[0,"\u592a\u59cb\u521d\u6838"],ra=[0,"\u7b26\u540d"],F=[0,"\u5316\u6ec5"],G=[0,"\u5f0f\u5f62"],H=[0,"\u7279\u5b9a\u5176\u7269"],I=[0,"\u7701\u7565\u4e00\u7269"],sa=[0,"\u6620\u8868"],M=[0,"\u4e00\u985e\u4f55\u7269"],ta=[0,"\u662f\u975e"],ua=[0,"\u5176\u5b50"],va=[0,"\u723b\u967d"],ya=[0,"\u723b\u9670"],za=[0,"\u9023\u9838"],Aa=[0,"\u69cb\u7269"],Ba=[0,"\u8b2c\u8aa4"],Ca=[0,"\u5217\u5e8f"],Da=[0,"\u4e4b\u7269"],Ea=[0,"\u6548\u61c9"],Fa=[0,"\u8a3b\u758f"],Ha=Ga(N([0,"\u5b87\u5b99\u4ea1\u77e3"],
I));function O(a){return[3,ra,[1,E,[1,a,y]]]}function Ia(a,b){return O(N(M,N(F,N(a),I),b))}function Ja(a){return O(N(M,F,N(ta,N(M,a,I))))}
var Ka=O(N(M,N(F,I,Aa),H)),La=Ia(Aa,ra),Ma=Ia(Aa,Ca),Na=Ja(Aa),Oa=O(N(M,N(F,I,za),H)),Pa=Ja(za),Qa=Ia(za,[0,"\u9996\u59cb"]),Ra=Ia(za,[0,"\u5c3e\u672b"]),Sa=Ja([0,"\u8a5e\u7d20"]),Za=Ja([0,"\u9593\u7a7a"]),$a=O(N(M,F,N(ta,[0,"\u7b49\u540c"]))),ab=O(N(M,N(F,[1,F,I],I),[0,"\u61c9\u7528"])),bb=O(N(M,F,[0,"\u89e3\u7b97"])),cb=Ia(Ca,N(M,Da,I)),db=O(N(M,F,[0,"\u5982\u82e5"])),eb=O(N(M,G,[0,"\u5f15\u7528"])),fb=O(N(M,N(G,N(F,I,F)),H)),gb=O(N(G,N(E,F))),hb=O(N(G,N(E,G))),ib=O(N(G,G)),jb=O(N(M,F,Fa)),kb=O(N(M,
G,Fa)),lb=[3,ya,N()],mb=[3,va,N()];function Ga(a){return[3,Ba,[1,E,[1,a,y]]]}function P(a){for(var b=y,c=a.length-1;0<=c;c--)b=[1,a[c],b];return b}exports.jsArray_to_list=P;function nb(a,b,c){for(var d=[];x(a);)d.push(a[1]),a=a[2];return z(a)?b(d):c(d,a)}function Q(a){return nb(a,function(b){return b},function(){return!1})}exports.maybe_list_to_jsArray=Q;function N(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return P(a)}exports.new_list=N;
function S(a){if(!ka(a))return a;for(var b=[];ka(a);)b.push(a),a=a[1];for(var c=0;c<b.length;c++)w(b[c],a);return a}exports.un_just_all=S;exports.un_just_comment_all=function(a){for(;ka(a)||q(a);)a=S(ca(a));return a};function ob(a){return 5===a[0]||7===a[0]||6===a[0]||8===a[0]}exports.delay_p=ob;function T(a){return ka(a)||ob(a)}exports.delay_just_p=T;function pb(a){return T(a)||q(a)}exports.lazy_p=pb;
function qb(a){if(5===a[0])return a;if(7===a[0])throw"WIP";if(6===a[0])throw"WIP";if(8===a[0])throw"WIP";return n()}exports.delay_env=function(a){return qb(a)[1]};exports.delay_x=function(a){return qb(a)[2]};
function D(a,b,c,d){function f(L){w(m,L);for(var B=0;B<d.length;B++)w(d[B],L);return L}function k(){c[1]=!0;return g(Ha)}function g(L){f(L);return T(L)?(d.push(m),D(L,b,[!1,!1],d)):L}function h(){var L={},B;for(B in l)L[B]=!0;for(B in b)L[B]=!0;return L}void 0===b&&(b={});void 0===c&&(c=[!1,!1]);void 0===d&&(d=[]);var l={},m=a;for(a=0;T(m)&&32>a;a++)d.push(m),m=U(m);for(;T(m);){a=V(m);if(!0===b[a])return k();if(!0===l[a]){c[0]=!0;if(5===m[0])return k();if(6===m[0]){a=m[1];for(var u=m[2],J=!1,R=0,
ba=[La,Ma,Na,Pa,Qa,Ra,Sa,Za];R<ba.length;R++)if(W(ba[R],a)){J=!0;break}if(J)return 1===u.length||n(),!1===c[1]||n(),u=D(u[0],h(),c),c[1]?g(C(a,[u])):n();if(W(a,$a)||W(a,ab)||W(a,bb))return k();if(W(a,db)&&(3===u.length||n(),!1===c[1]||n(),a=D(u[0],h(),c),c[1]))return g(C(db,[a,u[1],u[2]]))}else if(7===m[0]||8===m[0])return k();return n()}l[a]=!0;d.push(m);m=U(m)}return f(m)}
function U(a){var b=S(a);!ka(b)||n();a=5===b[0]?rb(b[1],b[2],a):7===b[0]?sb(b[1],b[2],b[3]):6===b[0]?tb(b[1],b[2],a):8===b[0]?ub(b[1],b[2],a):b;a=S(a);w(b,a);return a}exports.force1=U;exports.force_all=function(a){return D(a)};function pa(a){for(;T(a)||q(a);)a=D(ca(a));return a}exports.force_uncomment_all=pa;exports.force_uncomment1=function(a){return q(a)?a[2]:U(a)};function vb(a){for(;q(a);)a=a[2];for(a=U(a);q(a);)a=a[2];return a}exports.unlazy1=vb;
function wb(a,b,c,d){var f=[],k=[];a=S(a);for(var g=!0;;){if(z(a))return d(k,f);if(q(a))k.push(a[1]),a=a[2];else if(x(a))f.push(a[1]),a=a[2];else if(T(a))if(g)g=!1,a=U(a);else return c();else return b()}}function xb(a){pb(a)&&(a=vb(a));if(pb(a))return null;if(t(a))return!0;if(!A(a))return!1;a=a[1];pb(a)&&(a=vb(a));return pb(a)?null:t(a)?v(a,ra):!1}var yb=[];exports.env_null_v=yb;
function zb(a,b,c){for(var d=[],f=0;f<a.length;f+=2){if(W(a[f],b)){d[f]=b;d[f+1]=c;for(f+=2;f<a.length;f+=2)d[f]=a[f],d[f+1]=a[f+1];return d}d[f]=a[f];d[f+1]=a[f+1]}d[a.length]=b;d[a.length+1]=c;return d}exports.env_set=zb;function Cb(a,b,c){for(var d=0;d<a.length;d+=2)if(W(a[d],b))return a[d+1];return c}exports.env_get=Cb;function Db(a,b){for(var c=0;c<a.length;c+=2)if(W(a[c],b))return a[c+1];return n()}function X(a){for(var b=y,c=0;c<a.length;c+=2)b=[1,N(a[c],a[c+1]),b];return[3,sa,N(b)]}
exports.env2val=X;function Eb(a,b){for(var c=0;c<a.length;c+=2)b(a[c],a[c+1])}exports.env_foreach=Eb;function Fb(a){a=D(a);if(!A(a))return!1;var b=D(a[1]);if(!t(b)||!v(b,sa))return!1;b=D(a[2]);if(!x(b)||!z(D(b[2])))return!1;a=[];for(b=D(b[1]);!z(b);){if(!x(b))return!1;var c=D(b[1]);b=D(b[2]);if(!x(c))return!1;var d=c[1];c=D(c[2]);if(!x(c))return!1;var f=c[1];if(!z(D(c[2])))return!1;c=!0;for(var k=0;k<a.length;k+=2)if(W(a[k],d)){a[k+1]=f;c=!1;break}c&&(a.push(d),a.push(f))}return a}
exports.val2env=Fb;
function rb(a,b,c){function d(){return Ga(N(gb,N(bb,N(X(a),f))))}var f=U(b);if(T(f))return c;if(x(f))return wb(f,d,function(){return c},function(k,g){if(0!==k.length)throw"WIP";if(W(g[0],hb)){if(1===g.length)return d();for(var h=g[1],l=[],m=2;m<g.length;m++)l.push(g[m]);return[7,a,h,l]}if(W(g[0],ib)){if(1===g.length)return d();h=D([5,a,g[1]]);if(!A(h))return d();l=U(h[1]);if(T(l))return c;if(!t(l)||!v(l,G))return d();l=U(h[2]);if(T(l))return c;if(!x(l))return d();h=l[1];l=U(l[2]);if(T(l))return c;
if(!z(l))return d();l=[X(a)];for(m=2;m<g.length;m++)l.push(g[m]);return[8,h,l]}if(W(g[0],gb)){if(1===g.length)return d();h=g[1];l=[];for(m=2;m<g.length;m++)l.push([5,a,g[m]]);return[6,h,l]}h=[5,a,g[0]];l=[];for(m=1;m<g.length;m++)l.push([5,a,g[m]]);return[8,h,l]});if(z(f))return f;b=xb(f);return null===b?c:!0===b?Cb(a,f,d()):d()}function Gb(a,b){return[a,1,function(c){c=U(c);return T(c)?C(a,[c]):b(c)?mb:lb}]}function Hb(a,b,c){return[a,1,function(d,f){d=U(d);return T(d)?C(a,[d]):b(d)?c(d):f()}]}
var Ib=[Gb(Na,A),[Ka,2,ha],Hb(La,A,ia),Hb(Ma,A,ja),Gb(Za,z),[Oa,2,da],Gb(Pa,x),Hb(Qa,x,ea),Hb(Ra,x,fa),[$a,2,function(a,b){function c(d,f,k,g){k=C($a,[k(d),k(f)]);d=C($a,[g(d),g(f)]);return C(db,[k,d,lb])}if(a===b)return mb;a=U(a);b=U(b);if(T(a)||T(b))return C($a,[a,b]);if(a===b)return mb;!T(a)||n();return z(a)?z(a)?mb:lb:t(a)?t(b)?v(a,b)?mb:lb:lb:A(a)?A(b)?c(a,b,ia,ja):lb:x(a)?x(b)?c(a,b,ea,fa):lb:n()}],[ab,2,function(a,b,c){var d=[];for(b=D(b);x(b);)d.push(b[1]),b=D(b[2]);return z(b)?[8,a,d]:c()}],
[bb,2,function(a,b,c){a=Fb(a);return!1===a?c():[5,a,b]}],Gb(Sa,t),[cb,1,function(a,b){a=U(a);return T(a)?C(cb,[a]):x(a)?a[1]:b()}],[db,3,function(a,b,c,d){a=U(a);if(T(a))return C(db,[a,b,c]);if(!A(a))return d();a=D(a[1]);return t(a)?v(a,va)?b:v(a,ya)?c:d():d()}],[jb,2,aa]];
function ub(a,b,c){function d(){return Ga(N(gb,N(ab,N(a,P(b)))))}a=U(a);if(T(a))return c;if(!A(a))return d();var f=D(a[1]);if(!t(f)||!v(f,F))return d();var k=D(a[2]);if(!x(k))return d();f=na(k[1]);k=D(k[2]);if(!x(k)||!z(D(k[2])))return d();k=k[1];for(var g=yb,h=0;!z(f);){var l=xb(f);if(null===l)return c;if(!0===l){l=y;for(var m=b.length-1;m>=h;m--)l=[1,b[m],l];g=zb(g,f,l);h=b.length;f=y}else if(x(f))if(h<b.length)l=b[h],h++,g=zb(g,f[1],l),f=f[2];else return d();else return d()}return b.length!==h?
d():[5,g,k]}function tb(a,b,c){function d(){return Ga(N(gb,N(a,P(b))))}for(var f=0;f<Ib.length;f++){var k=Ib[f];if(W(a,k[0])){if(b.length!==k[1])break;return 1===k[1]?k[2](b[0],d,c):2===k[1]?k[2](b[0],b[1],d,c):3===k[1]?k[2](b[0],b[1],b[2],d,c):n()}}return d()}function sb(a,b,c){function d(){return Ga(N(hb,N(X(a),b,P(c))))}return W(b,eb)?1!==c.length?d():c[0]:W(b,fb)?2!==c.length?d():Jb(a,c[0],c[1],d):W(b,kb)?2!==c.length?d():[10,c[0],[5,a,c[1]]]:d()}
function Jb(a,b,c,d){b=oa(b);for(var f=[],k=!1,g=b;!z(g);){var h=xb(g);null!==h||n();if(h)f.push(g),k=!0,g=y;else if(x(g))f.push(g[1]),g=g[2];else return d()}g=k?P(f):b;var l=[];Eb(a,function(m){for(var u=0;u<f.length;u++)if(W(f[u],m))return;l.push(m)});d=g;for(k=l.length-1;0<=k;k--)d=[1,l[k],d];for(k=l.length-1;0<=k;k--)g=da(N(hb,eb,Db(a,l[k])),g);return[3,F,N(b,[1,N(hb,eb,[3,F,N(d,c)]),g])]}
function Kb(a,b){function c(f,k,g,h){g=Kb(g(f),g(k));h=Kb(h(f),h(k));return!0===g&&!0===h?(w(f,k),!0):!1!==g&&!1!==h?null:!1}if(a===b)return!0;a=D(a);b=D(b);if(a===b)return!0;if(q(a)){var d=Kb(ca(a),b);!0===d&&(d=null);return d}if(q(b))return d=Kb(a,ca(b)),!0===d&&(d=null),d;if(z(a)){if(!z(b))return!1;w(a,b);return!0}return t(a)?t(b)?v(a,b):!1:x(a)?x(b)?c(a,b,ea,fa):!1:A(a)?A(b)?c(a,b,ia,ja):!1:n()}function W(a,b){return!1!==Kb(a,b)}exports.equal_p=W;
function Y(a,b){function c(d,f,k,g){return Y(k(d),k(f))&&Y(g(d),g(f))?(w(d,f),!0):!1}if(a===b)return!0;a=S(a);b=S(b);if(a===b)return!0;if(z(a)){if(!z(b))return!1;w(a,y);w(b,y);return!0}return t(a)?t(b)?v(a,b):!1:x(a)?x(b)?c(a,b,ea,fa):!1:A(a)?A(b)?c(a,b,ia,ja):!1:ob(a)?!1:n()}
function V(a){a=S(a);var b;if(z(a))return"()";if(x(a)){var c="(";for(b="";x(a);)c+=b+V(a[1]),b=" ",a=S(a[2]);return c=z(a)?c+")":c+(" . "+V(a)+")")}return A(a)?"#"+V([1,a[1],a[2]]):t(a)?a[1]:q(a)?";("+V(a[1])+" "+V(a[2])+")":5===a[0]?"$("+V(X(a[1]))+" "+V(a[2])+")":6===a[0]?"%("+V(a[1])+" "+V(P(a[2]))+")":7===a[0]?"@("+V(X(a[1]))+" "+V(a[2])+" "+V(P(a[3]))+")":8===a[0]?"^("+V(a[1])+" "+V(P(a[2]))+")":n()}exports.simple_print=V;
function Lb(a){function b(){return Ta.length===wa}function c(){!b()||n();var e=Ta[wa];wa++;return e}function d(e){Ta[wa-1]===e||n();wa--}function f(e){void 0===e&&(e="");throw"TheLanguage parse ERROR!"+e;}function k(e){return" "===e||"\n"===e||"\t"===e||"\r"===e}function g(){if(b())return!1;var e=c();if(!k(e))return d(e),!1;for(;k(e)&&!b();)e=c();k(e)||d(e);return!0}function h(){if(b())return!1;var e=c(),p="";if(!J(e))return d(e),!1;for(;J(e)&&!b();)p+=e,e=c();J(e)?p+=e:d(e);return[0,p]}function l(){if(b())return!1;
var e=c();if("("!==e)return d(e),!1;for(var p=[9],r=p;;){g();if(b())return f();e=c();if(")"===e)return qa(p,y),r;if("."===e){g();e=R();qa(p,e);g();if(b())return f();e=c();return")"!==e?f():r}d(e);e=R();var K=[9];qa(p,[1,e,K]);p=K}}function m(){if(b())return!1;var e=c();if("#"!==e)return d(e),!1;e=l();return!1!==e&&x(e)?[3,e[1],e[2]]:f()}function u(e,p){return function(){if(b())return!1;var r=c();if(r!==e)return d(r),!1;r=l();if(!1===r||!x(r))return f();var K=r[2];return x(K)&&z(K[2])?p(r[1],K[1]):
f()}}function J(e){if(k(e))return!1;for(var p=0,r="()!#.$%^@~/->_:?[]&;".split("");p<r.length;p++)if(r[p]===e)return!1;return!0}function R(){g();for(var e=0,p=[l,Sb,m,Ua,Va,Wa,Xa,Ya];e<p.length;e++){var r=(0,p[e])();if(!1!==r)return r}return f()}function ba(e){return!1===e?f():e}function L(e){ba(!b());ba(c()===e)}function B(e){function p(){L("[");var xa=B();L("]");return xa}void 0===e&&(e=!1);var r=0;for(e=e?[l,h,p,m,Ua,Va,Wa,Xa,Ya]:[l,Ab,m,Ua,Va,Wa,Xa,Ya];r<e.length;r++){var K=(0,e[r])();if(!1!==
K)return K}return f()}function Bb(e){if(b())return e;var p=c();if("."===p)return p=B(),N(M,N(F,N(e),I),p);if(":"===p)return p=B(),N(M,p,e);if("~"===p)return N(ta,e);if("@"===p)return p=B(),N(M,N(F,[1,e,I],I),p);if("?"===p)return N(M,F,N(ta,e));if("/"===p){for(e=[e];;){p=B(!0);e.push(p);if(b())break;p=c();if("/"!==p){d(p);break}}return N(ua,P(e))}d(p);return e}function Ab(){if(b())return!1;var e=c();if("&"===e){ba(!b());e=c();if("+"===e)return e=B(),N(G,N(E,e));d(e);e=B();return N(G,e)}if(":"===e){ba(!b());
e=c();if("&"===e)return L(">"),e=B(),N(M,N(G,N(F,I,e)),H);if(">"===e)return e=B(),N(M,N(F,I,e),H);d(e);e=B();return N(M,e,H)}if("+"===e)return e=B(),N(E,e);if("["===e)return e=B(),L("]"),Bb(e);if("_"===e)return L(":"),e=B(),N(M,e,I);d(e);e=h();return!1===e?!1:Bb(e)}function Sb(){var e=Ab();return!1===e?!1:t(e)?e:O(e)}var Ta=a,wa=0,Ua=u("$",function(e,p){var r=Fb(e);return!1===r?f():[5,r,p]}),Va=u("%",function(e,p){var r=nb(p,function(K){return K},function(){return f()});return[6,e,r]}),Wa=function(e,
p){return function(){if(b())return!1;var r=c();if(r!==e)return d(r),!1;r=l();if(!1===r||!x(r))return f();var K=r[2];if(!x(K))return f();var xa=K[2];return x(xa)&&z(xa[2])?p(r[1],K[1],xa[1]):f()}}("@",function(e,p,r){r=nb(r,function(K){return K},function(){return f()});e=Fb(e);return!1===e?f():[7,e,p,r]}),Xa=u("^",function(e,p){var r=nb(p,function(K){return K},function(){return f()});return[8,e,r]}),Ya=u(";",function(e,p){return[10,e,p]});return R()}exports.complex_parse=Lb;
function Z(a){function b(f,k){function g(J){return k?"["+J+"]":J}if(t(f))return f[1];var h=Q(f);if(!1!==h&&3===h.length&&Y(h[0],M)){var l=Q(h[1]);if(!1!==l&&3===l.length&&Y(l[0],F)){var m=l[1],u=Q(m);if(!1!==u&&1===u.length&&Y(l[2],I))return g(b(u[0],!0)+"."+b(h[2],!0));if(x(m)&&Y(m[2],I)&&Y(l[2],I))return g(b(m[1],!0)+"@"+b(h[2],!0));if(Y(m,I)&&Y(h[2],H))return g(":>"+b(l[2],!0))}m=Q(h[2]);if(Y(h[1],F)&&!1!==m&&2===m.length&&Y(m[0],ta))return g(b(m[1],!0)+"?");if(!1!==l&&2===l.length&&Y(h[2],H)&&
Y(l[0],G)&&(l=Q(l[1]),!1!==l&&3===l.length&&Y(l[0],F)&&Y(l[1],I)))return g(":&>"+b(l[2],!0));l=void 0;l=Y(h[2],I)?"_":Y(h[2],H)?"":b(h[2],!0);return g(l+":"+b(h[1],!0))}if(!1!==h&&2===h.length){if(Y(h[0],G))return l=Q(h[1]),!1!==l&&2===l.length&&Y(l[0],E)?g("&+"+b(l[1],!0)):g("&"+b(h[1],!0));if(Y(h[0],ta))return g(b(h[1],!0)+"~");if(Y(h[0],E))return g("+"+b(h[1],!0));if(Y(h[0],ua)&&(h=Q(h[1]),!1!==h&&1<h.length)){l=b(h[0],!0);for(m=1;m<h.length;m++)l+="/"+b(h[m],!0);return g(l)}}return k?V(f):V(O(f))}
a=Lb(V(a));var c="",d="";if(z(a))return"()";if(x(a)){c="(";for(d="";x(a);)c+=d+Z(a[1]),d=" ",a=a[2];return c=z(a)?c+")":c+(" . "+Z(a)+")")}return A(a)?(c=a[1],a=a[2],d=Q(a),!1!==d&&2===d.length&&Y(c,ra)&&Y(d[0],E)?b(d[1],!1):"#"+Z([1,c,a])):t(a)?a[1]:q(a)?";("+Z(a[1])+" "+Z(a[2])+")":5===a[0]?"$("+Z(X(a[1]))+" "+Z(a[2])+")":6===a[0]?"%("+Z(a[1])+" "+Z(P(a[2]))+")":7===a[0]?"@("+Z(X(a[1]))+" "+Z(a[2])+" "+Z(P(a[3]))+")":8===a[0]?"^("+Z(a[1])+" "+Z(P(a[2]))+")":n()}exports.complex_print=Z;
exports.machinetext_parse=function(a){function b(m){void 0===m&&(m="");throw"MT parse ERROR "+m;}function c(m){if(!m)return b()}function d(){c(0!==k);k--;return a[k]}function f(m){var u=g.pop(),J=g.pop();return void 0===J||void 0===u?b():g.unshift(m(J,u))}for(var k=a.length,g=[];0!==k;){var h=d();if("^"===h){for(h="";;){var l=d();if("^"===l)break;h=l+h}g.unshift([0,h])}else if("."===h)f(da);else if("#"===h)f(ha);else if("$"===h)f(function(m,u){var J=Fb(m);return!1===J?b():[5,J,u]});else if("_"===
h)g.unshift(y);else return b()}c(0===k);c(1===g.length);return g[0]};exports.machinetext_print=function(a){function b(){for(var f=[],k=0,g=c;k<g.length;k++){var h=g[k];h=S(h);var l=function(m,u,J,R){d+=u;return f.push(J(m),R(m))};if(t(h))d+="^"+h[1]+"^";else if(x(h))l(h,".",ea,fa);else if(z(h))d+="_";else if(A(h))l(h,"#",ia,ja);else if(ob(h))h=qb(h),l(h,"$",function(m){return X(m[1])},la);else return{value:n()}}c=f}for(var c=[a],d="";0!==c.length;)if(a=b(),"object"===typeof a)return a.value;return d};
exports.Trampoline=function(){};function Mb(a){return function(){return[!1,a]}}exports.trampoline_return=Mb;function Nb(a){return function(){return[!0,a()]}}exports.trampoline_delay=Nb;function Ob(a){for(a=a();a[0];)a=a[1]();return a[1]}exports.run_trampoline=Ob;var Pb=O([1,ua,[1,[1,Ea,[1,[1,M,[1,Da,[1,I,y]]],y]],y]]);exports.return_effect_systemName=Pb;var Qb=O([1,ua,[1,[1,Ea,[1,za,y]],y]]);exports.bind_effect_systemName=Qb;exports.new_effect_bind=function(a,b){return[3,Qb,N(a,b)]};
exports.new_effect_return=function(a){return[3,Pb,a]};
function Rb(a,b,c,d,f){void 0===f&&(f=!1);c=D(c);if(A(c)){var k=c[1],g=c[2];if(W(k,Pb)){if(g=D(g),x(g)&&(k=g[1],g=D(g[2]),z(g))){if(!1===f){var h=k;k=function(){return a(h,d)}}else{var l=k;k=function(){return Rb(a,b,[8,f,l],d)}}return Nb(k)}}else if(W(k,Qb)&&(g=D(g),x(g)&&(k=g[1],g=D(g[2]),x(g)))){var m=g[1];g=D(g[2]);if(z(g)){if(!1===f){var u=k;k=function(){return Rb(a,b,u,d,m)}}else k=function(){throw"WIP";};return Nb(k)}}}return!1===f?Nb(function(){return b(c,d,a)}):Nb(function(){return b(c,d,
function(J,R){return Nb(function(){return Rb(a,b,ma(f,[J]),R)})})})}exports.run_monad_trampoline=function(a,b,c,d){return Rb(a,b,c,d)};exports.run_monad_stackoverflow=function(a,b,c,d){return Ob(Rb(function(f,k){return Mb(a(f,k))},function(f,k,g){return Mb(b(f,k,function(h,l){return Ob(g(h,l))}))},c,d))};
