function n(){throw"TheLanguage PANIC";}function aa(a,b){return[11,a,b]}exports.new_comment=aa;function q(a){return 11===a[0]}exports.comment_p=q;exports.comment_comment=function(a){return a[1]};exports.comment_x=function(a){return a[2]};function ba(a){for(;q(a);)a=a[2];return a}exports.un_comment_all=ba;function t(a){return 0===a[0]}exports.atom_p=t;exports.new_atom=function(a){return[0,a]};exports.un_atom=function(a){return a[1]};function v(a,b){return a===b?!0:a[1]===b[1]?(w(a,b),!0):!1}
exports.atom_equal_p=v;function ca(a,b){return[1,a,b]}exports.new_construction=ca;function x(a){return 1===a[0]}exports.construction_p=x;function da(a){return a[1]}exports.construction_head=da;function ea(a){return a[2]}exports.construction_tail=ea;var y=[2];exports.null_v=y;function z(a){return 2===a[0]}exports.null_p=z;function fa(a,b){return[3,a,b]}exports.new_data=fa;function A(a){return 3===a[0]}exports.data_p=A;function ha(a){return a[1]}exports.data_name=ha;function ia(a){return a[2]}
exports.data_list=ia;function ja(a,b){return[4,a,b]}exports.new_error=ja;function B(a){return 4===a[0]}exports.error_p=B;function ka(a){return a[1]}exports.error_name=ka;function la(a){return a[2]}exports.error_list=la;function ma(a){return 5===a[0]}exports.just_p=ma;exports.evaluate=function(a,b){return[6,a,b]};function na(a){return a[2]}function C(a,b){return[7,a,b]}function pa(a,b){return[9,a,b]}exports.apply=pa;
function qa(a){a=E(a);if(A(a)||B(a)||x(a)||q(a))a[1]=qa(a[1]),a[2]=qa(a[2]);return a}exports.force_all_rec=qa;function ra(a){var b=sa(a);if(A(b)||B(b)||x(b))if(b[1]=qa(b[1]),b[2]=qa(b[2]),q(b[1])||q(b[2])){a=[10];ta(a,b);var c=b[2];b=ra(b[1]);c=ra(c);a[1]=b;a[2]=c}else a=b;else a=b;return a}exports.force_uncomment_all_rec=ra;exports.unlazy_all_rec=ra;function w(a,b){a!==b&&(a===y&&(a=b,b=y),a[0]=5,a[1]=b,a[2]=!1,a[3]=!1)}
function ta(a,b){10===a[0]||n();10!==b[0]||n();a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3]}
var F=[0,"\u592a\u59cb\u521d\u6838"],ua=[0,"\u7b26\u540d"],G=[0,"\u5316\u6ec5"],I=[0,"\u5f0f\u5f62"],va=[0,"\u7279\u5b9a\u5176\u7269"],J=[0,"\u7701\u7565\u4e00\u7269"],wa=[0,"\u6620\u8868"],L=[0,"\u4e00\u985e\u4f55\u7269"],xa=[0,"\u662f\u975e"],ya=[0,"\u5176\u5b50"],za=[0,"\u723b\u967d"],Aa=[0,"\u723b\u9670"],Ba=[0,"\u9023\u9838"],Ca=[0,"\u69cb\u7269"],Fa=[0,"\u8b2c\u8aa4"],Ga=[0,"\u5217\u5e8f"],Ha=[0,"\u4e4b\u7269"],Ia=[0,"\u6548\u61c9"],Ja=[0,"\u8a3b\u758f"],Ka=[4,F,M([0,"\u5b87\u5b99\u4ea1\u77e3"],
J)];function N(a){return[3,ua,[1,F,[1,a,y]]]}function La(a){return N(M(L,M(G,J,a),va))}function Ma(a,b){return N(M(L,M(G,M(a),J),b))}function Na(a){return N(M(L,G,M(xa,M(L,a,J))))}
var Oa=La(Ca),Pa=Ma(Ca,ua),Qa=Ma(Ca,Ga),Ra=Na(Ca),Sa=La(Fa),Ta=Ma(Fa,ua),Ua=Ma(Fa,Ga),Va=Na(Fa),Wa=La(Ba),Xa=Na(Ba),Ya=Ma(Ba,[0,"\u9996\u59cb"]),Za=Ma(Ba,[0,"\u5c3e\u672b"]),fb=Na([0,"\u8a5e\u7d20"]),gb=Na([0,"\u9593\u7a7a"]),hb=N(M(L,G,M(xa,[0,"\u7b49\u540c"]))),ib=N(M(L,M(G,[1,G,J],J),[0,"\u61c9\u7528"])),jb=N(M(L,G,[0,"\u89e3\u7b97"])),kb=Ma(Ga,M(L,Ha,J)),lb=N(M(L,G,[0,"\u5982\u82e5"])),mb=N(M(L,I,[0,"\u5f15\u7528"])),nb=N(M(L,M(I,M(G,J,G)),va)),ob=N(M(I,M(F,G))),pb=N(M(I,M(F,I))),qb=N(M(I,I)),
rb=N(M(L,G,Ja)),sb=N(M(L,I,Ja)),tb=[3,Aa,M()],ub=[3,za,M()];function O(a){for(var b=y,c=a.length-1;0<=c;c--)b=[1,a[c],b];return b}exports.jsArray_to_list=O;function vb(a,b,c){for(var d=[];x(a);)d.push(a[1]),a=a[2];return z(a)?b(d):c(d,a)}function P(a){return vb(a,function(b){return b},function(){return!1})}exports.maybe_list_to_jsArray=P;function M(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return O(a)}exports.new_list=M;
function R(a){if(!ma(a))return a;for(var b=[];ma(a);)b.push(a),a=a[1];for(var c=0;c<b.length;c++)w(b[c],a);return a}exports.un_just_all=R;exports.un_just_comment_all=function(a){for(;ma(a)||q(a);)a=R(ba(a));return a};function wb(a){return 6===a[0]||8===a[0]||7===a[0]||9===a[0]}exports.delay_p=wb;function S(a){return ma(a)||wb(a)}exports.delay_just_p=S;function xb(a){return S(a)||q(a)}exports.lazy_p=xb;
function yb(a){if(6===a[0])return a;if(8===a[0])throw"WIP";if(7===a[0])throw"WIP";if(9===a[0])throw"WIP";return n()}exports.delay_env=function(a){return yb(a)[1]};exports.delay_x=function(a){return yb(a)[2]};
function E(a,b,c,d){function f(K){w(m,K);for(var Q=0;Q<d.length;Q++)w(d[Q],K);return K}function k(){c[1]=!0;return g(Ka)}function g(K){f(K);return S(K)?(d.push(m),E(K,b,[!1,!1],d)):K}function h(){var K={},Q;for(Q in l)K[Q]=!0;for(Q in b)K[Q]=!0;return K}void 0===b&&(b={});void 0===c&&(c=[!1,!1]);void 0===d&&(d=[]);var l={},m=a;for(a=0;S(m)&&32>a;a++)d.push(m),m=V(m);for(;S(m);){a=W(m);if(!0===b[a])return k();if(!0===l[a]){c[0]=!0;if(6===m[0])return k();if(7===m[0]){a=m[1];for(var u=m[2],D=!1,U=0,
oa=[Pa,Qa,Ra,Ta,Ua,Va,Xa,Ya,Za,fb,gb];U<oa.length;U++)if(X(oa[U],a)){D=!0;break}if(D)return 1===u.length||n(),!1===c[1]||n(),u=E(u[0],h(),c),c[1]?g(C(a,[u])):n();if(X(a,hb)||X(a,ib)||X(a,jb))return k();if(X(a,lb)&&(3===u.length||n(),!1===c[1]||n(),a=E(u[0],h(),c),c[1]))return g(C(lb,[a,u[1],u[2]]))}else if(8===m[0]||9===m[0])return k();return n()}l[a]=!0;d.push(m);m=V(m)}return f(m)}
function V(a){var b=R(a);!ma(b)||n();a=6===b[0]?zb(b[1],b[2],a):8===b[0]?Ab(b[1],b[2],b[3]):7===b[0]?Bb(b[1],b[2],a):9===b[0]?Cb(b[1],b[2],a):b;a=R(a);w(b,a);return a}exports.force1=V;exports.force_all=function(a){return E(a)};function sa(a){for(;S(a)||q(a);)a=E(ba(a));return a}exports.force_uncomment_all=sa;exports.force_uncomment1=function(a){return q(a)?a[2]:V(a)};function Db(a){for(;q(a);)a=a[2];for(a=V(a);q(a);)a=a[2];return a}exports.unlazy1=Db;
function Eb(a,b,c,d){var f=[],k=[];a=R(a);for(var g=!0;;){if(z(a))return d(k,f);if(q(a))k.push(a[1]),a=a[2];else if(x(a))f.push(a[1]),a=a[2];else if(S(a))if(g)g=!1,a=V(a);else return c();else return b()}}function Fb(a){xb(a)&&(a=Db(a));if(xb(a))return null;if(t(a))return!0;if(!A(a))return!1;a=a[1];xb(a)&&(a=Db(a));return xb(a)?null:t(a)?v(a,ua):!1}var Gb=[];exports.env_null_v=Gb;
function Hb(a,b,c){for(var d=[],f=0;f<a.length;f+=2){if(X(a[f],b)){d[f]=b;d[f+1]=c;for(f+=2;f<a.length;f+=2)d[f]=a[f],d[f+1]=a[f+1];return d}d[f]=a[f];d[f+1]=a[f+1]}d[a.length]=b;d[a.length+1]=c;return d}exports.env_set=Hb;function Ib(a,b,c){for(var d=0;d<a.length;d+=2)if(X(a[d],b))return a[d+1];return c}exports.env_get=Ib;function Lb(a,b){for(var c=0;c<a.length;c+=2)if(X(a[c],b))return a[c+1];return n()}function Mb(a){for(var b=y,c=0;c<a.length;c+=2)b=[1,M(a[c],a[c+1]),b];return[3,wa,M(b)]}
exports.env2val=Mb;function Nb(a,b){for(var c=0;c<a.length;c+=2)b(a[c],a[c+1])}exports.env_foreach=Nb;function Ob(a){a=E(a);if(!A(a))return!1;var b=E(a[1]);if(!t(b)||!v(b,wa))return!1;b=E(a[2]);if(!x(b)||!z(E(b[2])))return!1;a=[];for(b=E(b[1]);!z(b);){if(!x(b))return!1;var c=E(b[1]);b=E(b[2]);if(!x(c))return!1;var d=c[1];c=E(c[2]);if(!x(c))return!1;var f=c[1];if(!z(E(c[2])))return!1;c=!0;for(var k=0;k<a.length;k+=2)if(X(a[k],d)){a[k+1]=f;c=!1;break}c&&(a.push(d),a.push(f))}return a}
exports.val2env=Ob;
function zb(a,b,c){function d(){return[4,F,M(ob,M(jb,M(Mb(a),f)))]}var f=V(b);if(S(f))return c;if(x(f))return Eb(f,d,function(){return c},function(k,g){if(0!==k.length)throw"WIP";if(X(g[0],pb)){if(1===g.length)return d();for(var h=g[1],l=[],m=2;m<g.length;m++)l.push(g[m]);return[8,a,h,l]}if(X(g[0],qb)){if(1===g.length)return d();h=E([6,a,g[1]]);if(!A(h))return d();l=V(h[1]);if(S(l))return c;if(!t(l)||!v(l,I))return d();l=V(h[2]);if(S(l))return c;if(!x(l))return d();h=l[1];l=V(l[2]);if(S(l))return c;
if(!z(l))return d();l=[Mb(a)];for(m=2;m<g.length;m++)l.push(g[m]);return[9,h,l]}if(X(g[0],ob)){if(1===g.length)return d();h=g[1];l=[];for(m=2;m<g.length;m++)l.push([6,a,g[m]]);return[7,h,l]}h=[6,a,g[0]];l=[];for(m=1;m<g.length;m++)l.push([6,a,g[m]]);return[9,h,l]});if(z(f))return f;if(B(f))return d();b=Fb(f);return null===b?c:!0===b?Ib(a,f,d()):n()}function Pb(a,b){return[a,1,function(c){c=V(c);return S(c)?C(a,[c]):b(c)?ub:tb}]}
function Qb(a,b,c){return[a,1,function(d,f){d=V(d);return S(d)?C(a,[d]):b(d)?c(d):f()}]}
var Rb=[Pb(Ra,A),[Oa,2,fa],Qb(Pa,A,ha),Qb(Qa,A,ia),Pb(Va,B),[Sa,2,ja],Qb(Ta,B,ka),Qb(Ua,B,la),Pb(gb,z),[Wa,2,ca],Pb(Xa,x),Qb(Ya,x,da),Qb(Za,x,ea),[hb,2,function(a,b){function c(d,f,k,g){k=C(hb,[k(d),k(f)]);d=C(hb,[g(d),g(f)]);return C(lb,[k,d,tb])}if(a===b)return ub;a=V(a);b=V(b);if(S(a)||S(b))return C(hb,[a,b]);if(a===b)return ub;!S(a)||n();return z(a)?z(a)?ub:tb:t(a)?t(b)?v(a,b)?ub:tb:tb:A(a)?A(b)?c(a,b,ha,ia):tb:x(a)?x(b)?c(a,b,da,ea):tb:B(a)?B(b)?c(a,b,ka,la):tb:n()}],[ib,2,function(a,b,c){var d=
[];for(b=E(b);x(b);)d.push(b[1]),b=E(b[2]);return z(b)?[9,a,d]:c()}],[jb,2,function(a,b,c){a=Ob(a);return!1===a?c():[6,a,b]}],Pb(fb,t),[kb,1,function(a,b){a=V(a);return S(a)?C(kb,[a]):x(a)?a[1]:b()}],[lb,3,function(a,b,c,d){a=V(a);if(S(a))return C(lb,[a,b,c]);if(!A(a))return d();a=E(a[1]);return t(a)?v(a,za)?b:v(a,Aa)?c:d():d()}],[rb,2,aa]];
function Cb(a,b,c){function d(){return[4,F,M(ob,M(ib,M(a,O(b))))]}a=V(a);if(S(a))return c;if(!A(a))return d();var f=E(a[1]);if(!t(f)||!v(f,G))return d();var k=E(a[2]);if(!x(k))return d();f=qa(k[1]);k=E(k[2]);if(!x(k)||!z(E(k[2])))return d();k=k[1];for(var g=Gb,h=0;!z(f);){var l=Fb(f);if(null===l)return c;if(!0===l){l=y;for(var m=b.length-1;m>=h;m--)l=[1,b[m],l];g=Hb(g,f,l);h=b.length;f=y}else if(x(f))if(h<b.length)l=b[h],h++,g=Hb(g,f[1],l),f=f[2];else return d();else return d()}return b.length!==
h?d():[6,g,k]}function Bb(a,b,c){function d(){return[4,F,M(ob,M(a,O(b)))]}for(var f=0;f<Rb.length;f++){var k=Rb[f];if(X(a,k[0])){if(b.length!==k[1])break;return 1===k[1]?k[2](b[0],d,c):2===k[1]?k[2](b[0],b[1],d,c):3===k[1]?k[2](b[0],b[1],b[2],d,c):n()}}return d()}function Ab(a,b,c){function d(){return[4,F,M(pb,M(Mb(a),b,O(c)))]}return X(b,mb)?1!==c.length?d():c[0]:X(b,nb)?2!==c.length?d():Sb(a,c[0],c[1],d):X(b,sb)?2!==c.length?d():[11,c[0],[6,a,c[1]]]:d()}
function Sb(a,b,c,d){b=ra(b);for(var f=[],k=!1,g=b;!z(g);){var h=Fb(g);null!==h||n();if(h)f.push(g),k=!0,g=y;else if(x(g))f.push(g[1]),g=g[2];else return d()}g=k?O(f):b;var l=[];Nb(a,function(m){for(var u=0;u<f.length;u++)if(X(f[u],m))return;l.push(m)});d=g;for(k=l.length-1;0<=k;k--)d=[1,l[k],d];for(k=l.length-1;0<=k;k--)g=ca(M(pb,mb,Lb(a,l[k])),g);return[3,G,M(b,[1,M(pb,mb,[3,G,M(d,c)]),g])]}
function Tb(a,b){function c(f,k,g,h){g=Tb(g(f),g(k));h=Tb(h(f),h(k));return!0===g&&!0===h?(w(f,k),!0):!1!==g&&!1!==h?null:!1}if(a===b)return!0;a=E(a);b=E(b);if(a===b)return!0;if(q(a)){var d=Tb(ba(a),b);!0===d&&(d=null);return d}if(q(b))return d=Tb(a,ba(b)),!0===d&&(d=null),d;if(z(a)){if(!z(b))return!1;w(a,b);return!0}return t(a)?t(b)?v(a,b):!1:x(a)?x(b)?c(a,b,da,ea):!1:B(a)?B(b)?c(a,b,ka,la):!1:A(a)?A(b)?c(a,b,ha,ia):!1:n()}function X(a,b){return!1!==Tb(a,b)}exports.equal_p=X;
function Y(a,b){function c(d,f,k,g){return Y(k(d),k(f))&&Y(g(d),g(f))?(w(d,f),!0):!1}if(a===b)return!0;a=R(a);b=R(b);if(a===b)return!0;if(z(a)){if(!z(b))return!1;w(a,y);w(b,y);return!0}return t(a)?t(b)?v(a,b):!1:x(a)?x(b)?c(a,b,da,ea):!1:B(a)?B(b)?c(a,b,ka,la):!1:A(a)?A(b)?c(a,b,ha,ia):!1:wb(a)?!1:n()}
function W(a){a=R(a);var b;if(z(a))return"()";if(x(a)){var c="(";for(b="";x(a);)c+=b+W(a[1]),b=" ",a=R(a[2]);return c=z(a)?c+")":c+(" . "+W(a)+")")}return A(a)?"#"+W([1,a[1],a[2]]):B(a)?"!"+W([1,a[1],a[2]]):t(a)?a[1]:q(a)?";("+W(a[1])+" "+W(a[2])+")":6===a[0]?"$("+W(Mb(a[1]))+" "+W(a[2])+")":7===a[0]?"%("+W(a[1])+" "+W(O(a[2]))+")":8===a[0]?"@("+W(Mb(a[1]))+" "+W(a[2])+" "+W(O(a[3]))+")":9===a[0]?"^("+W(a[1])+" "+W(O(a[2]))+")":n()}exports.simple_print=W;
function Ub(a){function b(){return $a.length===Da}function c(){!b()||n();var e=$a[Da];Da++;return e}function d(e){$a[Da-1]===e||n();Da--}function f(e){void 0===e&&(e="");throw"TheLanguage parse ERROR!"+e;}function k(e){return" "===e||"\n"===e||"\t"===e||"\r"===e}function g(){if(b())return!1;var e=c();if(!k(e))return d(e),!1;for(;k(e)&&!b();)e=c();k(e)||d(e);return!0}function h(){if(b())return!1;var e=c(),p="";if(!U(e))return d(e),!1;for(;U(e)&&!b();)p+=e,e=c();U(e)?p+=e:d(e);return[0,p]}function l(){if(b())return!1;
var e=c();if("("!==e)return d(e),!1;for(var p=[10],r=p;;){g();if(b())return f();e=c();if(")"===e)return ta(p,y),r;if("."===e){g();e=oa();ta(p,e);g();if(b())return f();e=c();return")"!==e?f():r}d(e);e=oa();var H=[10];ta(p,[1,e,H]);p=H}}function m(){if(b())return!1;var e=c();if("#"!==e)return d(e),!1;e=l();return!1!==e&&x(e)?[3,e[1],e[2]]:f()}function u(){if(b())return!1;var e=c();if("!"!==e)return d(e),!1;e=l();return!1!==e&&x(e)?[4,e[1],e[2]]:f()}function D(e,p){return function(){if(b())return!1;
var r=c();if(r!==e)return d(r),!1;r=l();if(!1===r||!x(r))return f();var H=r[2];return x(H)&&z(H[2])?p(r[1],H[1]):f()}}function U(e){if(k(e))return!1;for(var p=0,r="()!#.$%^@~/->_:?[]&;".split("");p<r.length;p++)if(r[p]===e)return!1;return!0}function oa(){g();for(var e=0,p=[l,ac,m,u,ab,bb,cb,db,eb];e<p.length;e++){var r=(0,p[e])();if(!1!==r)return r}return f()}function K(e){return!1===e?f():e}function Q(e){K(!b());K(c()===e)}function T(e){function p(){Q("[");var Ea=T();Q("]");return Ea}void 0===e&&
(e=!1);var r=0;for(e=e?[l,h,p,m,u,ab,bb,cb,db,eb]:[l,Jb,m,u,ab,bb,cb,db,eb];r<e.length;r++){var H=(0,e[r])();if(!1!==H)return H}return f()}function Kb(e){if(b())return e;var p=c();if("."===p)return p=T(),M(L,M(G,M(e),J),p);if(":"===p)return p=T(),M(L,p,e);if("~"===p)return M(xa,e);if("@"===p)return p=T(),M(L,M(G,[1,e,J],J),p);if("?"===p)return M(L,G,M(xa,e));if("/"===p){for(e=[e];;){p=T(!0);e.push(p);if(b())break;p=c();if("/"!==p){d(p);break}}return M(ya,O(e))}d(p);return e}function Jb(){if(b())return!1;
var e=c();if("&"===e){K(!b());e=c();if("+"===e)return e=T(),M(I,M(F,e));d(e);e=T();return M(I,e)}if(":"===e){K(!b());e=c();if("&"===e)return Q(">"),e=T(),M(L,M(I,M(G,J,e)),va);if(">"===e)return e=T(),M(L,M(G,J,e),va);d(e);e=T();return M(L,e,va)}if("+"===e)return e=T(),M(F,e);if("["===e)return e=T(),Q("]"),Kb(e);if("_"===e)return Q(":"),e=T(),M(L,e,J);d(e);e=h();return!1===e?!1:Kb(e)}function ac(){var e=Jb();return!1===e?!1:t(e)?e:N(e)}var $a=a,Da=0,ab=D("$",function(e,p){var r=Ob(e);return!1===r?
f():[6,r,p]}),bb=D("%",function(e,p){var r=vb(p,function(H){return H},function(){return f()});return[7,e,r]}),cb=function(e,p){return function(){if(b())return!1;var r=c();if(r!==e)return d(r),!1;r=l();if(!1===r||!x(r))return f();var H=r[2];if(!x(H))return f();var Ea=H[2];return x(Ea)&&z(Ea[2])?p(r[1],H[1],Ea[1]):f()}}("@",function(e,p,r){r=vb(r,function(H){return H},function(){return f()});e=Ob(e);return!1===e?f():[8,e,p,r]}),db=D("^",function(e,p){var r=vb(p,function(H){return H},function(){return f()});
return[9,e,r]}),eb=D(";",function(e,p){return[11,e,p]});return oa()}exports.complex_parse=Ub;
function Z(a){function b(f,k){function g(D){return k?"["+D+"]":D}if(t(f))return f[1];var h=P(f);if(!1!==h&&3===h.length&&Y(h[0],L)){var l=P(h[1]);if(!1!==l&&3===l.length&&Y(l[0],G)){var m=l[1],u=P(m);if(!1!==u&&1===u.length&&Y(l[2],J))return g(b(u[0],!0)+"."+b(h[2],!0));if(x(m)&&Y(m[2],J)&&Y(l[2],J))return g(b(m[1],!0)+"@"+b(h[2],!0));if(Y(m,J)&&Y(h[2],va))return g(":>"+b(l[2],!0))}m=P(h[2]);if(Y(h[1],G)&&!1!==m&&2===m.length&&Y(m[0],xa))return g(b(m[1],!0)+"?");if(!1!==l&&2===l.length&&Y(h[2],va)&&
Y(l[0],I)&&(l=P(l[1]),!1!==l&&3===l.length&&Y(l[0],G)&&Y(l[1],J)))return g(":&>"+b(l[2],!0));l=void 0;l=Y(h[2],J)?"_":Y(h[2],va)?"":b(h[2],!0);return g(l+":"+b(h[1],!0))}if(!1!==h&&2===h.length){if(Y(h[0],I))return l=P(h[1]),!1!==l&&2===l.length&&Y(l[0],F)?g("&+"+b(l[1],!0)):g("&"+b(h[1],!0));if(Y(h[0],xa))return g(b(h[1],!0)+"~");if(Y(h[0],F))return g("+"+b(h[1],!0));if(Y(h[0],ya)&&(h=P(h[1]),!1!==h&&1<h.length)){l=b(h[0],!0);for(m=1;m<h.length;m++)l+="/"+b(h[m],!0);return g(l)}}return k?W(f):W(N(f))}
a=Ub(W(a));var c="",d="";if(z(a))return"()";if(x(a)){c="(";for(d="";x(a);)c+=d+Z(a[1]),d=" ",a=a[2];return c=z(a)?c+")":c+(" . "+Z(a)+")")}return A(a)?(c=a[1],a=a[2],d=P(a),!1!==d&&2===d.length&&Y(c,ua)&&Y(d[0],F)?b(d[1],!1):"#"+Z([1,c,a])):B(a)?"!"+Z([1,a[1],a[2]]):t(a)?a[1]:q(a)?";("+Z(a[1])+" "+Z(a[2])+")":6===a[0]?"$("+Z(Mb(a[1]))+" "+Z(a[2])+")":7===a[0]?"%("+Z(a[1])+" "+Z(O(a[2]))+")":8===a[0]?"@("+Z(Mb(a[1]))+" "+Z(a[2])+" "+Z(O(a[3]))+")":9===a[0]?"^("+Z(a[1])+" "+Z(O(a[2]))+")":n()}
exports.complex_print=Z;
exports.machinetext_parse=function(a){function b(m){void 0===m&&(m="");throw"MT parse ERROR "+m;}function c(m){if(!m)return b()}function d(){c(0!==k);k--;return a[k]}function f(m){var u=g.pop(),D=g.pop();return void 0===D||void 0===u?b():g.unshift(m(D,u))}for(var k=a.length,g=[];0!==k;){var h=d();if("^"===h){for(h="";;){var l=d();if("^"===l)break;h=l+h}g.unshift([0,h])}else if("."===h)f(ca);else if("#"===h)f(fa);else if("!"===h)f(ja);else if("$"===h)f(function(m,u){var D=Ob(m);return!1===D?b():[6,
D,u]});else if("_"===h)g.unshift(y);else return b()}c(0===k);c(1===g.length);return g[0]};
exports.machinetext_print=function(a){function b(){for(var f=[],k=0,g=c;k<g.length;k++){var h=g[k];h=R(h);var l=function(m,u,D,U){d+=u;return f.push(D(m),U(m))};if(t(h))d+="^"+h[1]+"^";else if(x(h))l(h,".",da,ea);else if(z(h))d+="_";else if(A(h))l(h,"#",ha,ia);else if(B(h))l(h,"!",ka,la);else if(wb(h))h=yb(h),l(h,"$",function(m){return Mb(m[1])},na);else return{value:n()}}c=f}for(var c=[a],d="";0!==c.length;)if(a=b(),"object"===typeof a)return a.value;return d};exports.Trampoline=function(){};
function Vb(a){return function(){return[!1,a]}}exports.trampoline_return=Vb;function Wb(a){return function(){return[!0,a()]}}exports.trampoline_delay=Wb;function Xb(a){for(a=a();a[0];)a=a[1]();return a[1]}exports.run_trampoline=Xb;var Yb=N([1,ya,[1,[1,Ia,[1,[1,L,[1,Ha,[1,J,y]]],y]],y]]);exports.return_effect_systemName=Yb;var Zb=N([1,ya,[1,[1,Ia,[1,Ba,y]],y]]);exports.bind_effect_systemName=Zb;exports.new_effect_bind=function(a,b){return[3,Zb,M(a,b)]};
exports.new_effect_return=function(a){return[3,Yb,a]};
function $b(a,b,c,d,f){void 0===f&&(f=!1);c=E(c);if(A(c)){var k=c[1],g=c[2];if(X(k,Yb)){if(g=E(g),x(g)&&(k=g[1],g=E(g[2]),z(g))){if(!1===f){var h=k;k=function(){return a(h,d)}}else{var l=k;k=function(){return $b(a,b,[9,f,l],d)}}return Wb(k)}}else if(X(k,Zb)&&(g=E(g),x(g)&&(k=g[1],g=E(g[2]),x(g)))){var m=g[1];g=E(g[2]);if(z(g)){if(!1===f){var u=k;k=function(){return $b(a,b,u,d,m)}}else k=function(){throw"WIP";};return Wb(k)}}}return!1===f?Wb(function(){return b(c,d,a)}):Wb(function(){return b(c,d,
function(D,U){return Wb(function(){return $b(a,b,pa(f,[D]),U)})})})}exports.run_monad_trampoline=function(a,b,c,d){return $b(a,b,c,d)};exports.run_monad_stackoverflow=function(a,b,c,d){return Xb($b(function(f,k){return Vb(a(f,k))},function(f,k,g){return Vb(b(f,k,function(h,l){return Xb(g(h,l))}))},c,d))};
