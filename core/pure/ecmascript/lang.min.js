function n(){throw"TheLanguage PANIC";}function aa(a,b){return[11,a,b]}exports.new_comment=aa;function q(a){return 11===a[0]}exports.comment_p=q;exports.comment_comment=function(a){return a[1]};exports.comment_x=function(a){return a[2]};function ba(a){for(;q(a);)a=a[2];return a}exports.un_comment_all=ba;function t(a){return 0===a[0]}exports.atom_p=t;exports.new_atom=function(a){return[0,a]};exports.un_atom=function(a){return a[1]};function u(a,b){return a===b?!0:a[1]===b[1]?(w(a,b),!0):!1}
exports.atom_equal_p=u;function ca(a,b){return[1,a,b]}exports.new_construction=ca;function x(a){return 1===a[0]}exports.construction_p=x;function da(a){return a[1]}exports.construction_head=da;function ea(a){return a[2]}exports.construction_tail=ea;var y=[2];exports.null_v=y;function z(a){return 2===a[0]}exports.null_p=z;function fa(a,b){return[3,a,b]}exports.new_data=fa;function A(a){return 3===a[0]}exports.data_p=A;function ha(a){return a[1]}exports.data_name=ha;function ia(a){return a[2]}
exports.data_list=ia;function ja(a,b){return[4,a,b]}exports.new_error=ja;function B(a){return 4===a[0]}exports.error_p=B;function ka(a){return a[1]}exports.error_name=ka;function la(a){return a[2]}exports.error_list=la;function ma(a){return 5===a[0]}exports.just_p=ma;exports.evaluate=function(a,b){return[6,a,b]};function na(a){return a[2]}function C(a,b){return[7,a,b]}function pa(a,b){return[9,a,b]}exports.apply=pa;
function qa(a){a=D(a);if(A(a)||B(a)||x(a)||q(a))a[1]=qa(a[1]),a[2]=qa(a[2]);return a}exports.force_all_rec=qa;function ra(a){var b=sa(a);if(A(b)||B(b)||x(b))if(b[1]=qa(b[1]),b[2]=qa(b[2]),q(b[1])||q(b[2])){a=[10];ta(a,b);var c=b[2];b=ra(b[1]);c=ra(c);a[1]=b;a[2]=c}else a=b;else a=b;return a}exports.force_uncomment_all_rec=ra;function w(a,b){a!==b&&(a===y&&(a=b,b=y),a[0]=5,a[1]=b,a[2]=!1,a[3]=!1)}function ta(a,b){10===a[0]||n();10!==b[0]||n();a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3]}
var E=[0,"\u592a\u59cb\u521d\u6838"],ua=[0,"\u7b26\u540d"],H=[0,"\u5316\u6ec5"],I=[0,"\u5f0f\u5f62"],va=[0,"\u7279\u5b9a\u5176\u7269"],J=[0,"\u7701\u7565\u4e00\u7269"],wa=[0,"\u6620\u8868"],L=[0,"\u4e00\u985e\u4f55\u7269"],xa=[0,"\u662f\u975e"],Aa=[0,"\u5176\u5b50"],Ba=[0,"\u723b\u967d"],Ca=[0,"\u723b\u9670"],Da=[0,"\u9023\u9838"],Ea=[0,"\u69cb\u7269"],Fa=[0,"\u8b2c\u8aa4"],Ga=[0,"\u5217\u5e8f"],Ha=[0,"\u4e4b\u7269"],Ia=[0,"\u6548\u61c9"],Ja=[0,"\u8a3b\u758f"],Ka=[4,E,M([0,"\u5b87\u5b99\u4ea1\u77e3"],
J)];function N(a){return[3,ua,[1,E,[1,a,y]]]}function La(a){return N(M(L,M(H,J,a),va))}function Ma(a,b){return N(M(L,M(H,M(a),J),b))}function Na(a){return N(M(L,H,M(xa,M(L,a,J))))}
var Oa=La(Ea),Pa=Ma(Ea,ua),Qa=Ma(Ea,Ga),Ra=Na(Ea),Sa=La(Fa),Ta=Ma(Fa,ua),Ua=Ma(Fa,Ga),Va=Na(Fa),bb=La(Da),cb=Na(Da),db=Ma(Da,[0,"\u9996\u59cb"]),eb=Ma(Da,[0,"\u5c3e\u672b"]),fb=Na([0,"\u8a5e\u7d20"]),gb=Na([0,"\u9593\u7a7a"]),hb=N(M(L,H,M(xa,[0,"\u7b49\u540c"]))),ib=N(M(L,M(H,[1,H,J],J),[0,"\u61c9\u7528"])),jb=N(M(L,H,[0,"\u89e3\u7b97"])),kb=Ma(Ga,M(L,Ha,J)),lb=N(M(L,H,[0,"\u5982\u82e5"])),mb=N(M(L,I,[0,"\u5f15\u7528"])),nb=N(M(L,M(I,M(H,J,H)),va)),ob=N(M(I,M(E,H))),pb=N(M(I,M(E,I))),qb=N(M(I,I)),
rb=N(M(L,H,Ja)),sb=N(M(L,I,Ja)),tb=[3,Ca,M()],ub=[3,Ba,M()];function O(a){for(var b=y,c=a.length-1;0<=c;c--)b=[1,a[c],b];return b}exports.jsArray_to_list=O;function vb(a,b,c){for(var e=[];x(a);)e.push(a[1]),a=a[2];return z(a)?b(e):c(e,a)}function Q(a){return vb(a,function(b){return b},function(){return!1})}exports.maybe_list_to_jsArray=Q;function M(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return O(a)}exports.new_list=M;
function R(a){if(!ma(a))return a;for(var b=[];ma(a);)b.push(a),a=a[1];for(var c=0;c<b.length;c++)w(b[c],a);return a}exports.un_just_all=R;exports.un_just_comment_all=function(a){for(;ma(a)||q(a);)a=R(ba(a));return a};function wb(a){return 6===a[0]||8===a[0]||7===a[0]||9===a[0]}exports.delay_p=wb;function T(a){return ma(a)||wb(a)}exports.delay_just_p=T;function xb(a){if(6===a[0])return a;if(8===a[0])throw"WIP";if(7===a[0])throw"WIP";if(9===a[0])throw"WIP";return n()}exports.delay_env=function(a){return xb(a)[1]};
exports.delay_x=function(a){return xb(a)[2]};
function D(a,b,c,e){function f(K){w(m,K);for(var P=0;P<e.length;P++)w(e[P],K);return K}function k(){c[1]=!0;return g(Ka)}function g(K){f(K);return T(K)?(e.push(m),D(K,b,[!1,!1],e)):K}function h(){var K={},P;for(P in l)K[P]=!0;for(P in b)K[P]=!0;return K}void 0===b&&(b={});void 0===c&&(c=[!1,!1]);void 0===e&&(e=[]);var l={},m=a;for(a=0;T(m)&&32>a;a++)e.push(m),m=V(m);for(;T(m);){a=W(m);if(!0===b[a])return k();if(!0===l[a]){c[0]=!0;if(6===m[0])return k();if(7===m[0]){a=m[1];for(var v=m[2],F=!1,U=0,
oa=[Pa,Qa,Ra,Ta,Ua,Va,cb,db,eb,fb,gb];U<oa.length;U++)if(X(oa[U],a)){F=!0;break}if(F)return 1===v.length||n(),!1===c[1]||n(),v=D(v[0],h(),c),c[1]?g(C(a,[v])):n();if(X(a,hb)||X(a,ib)||X(a,jb))return k();if(X(a,lb)&&(3===v.length||n(),!1===c[1]||n(),a=D(v[0],h(),c),c[1]))return g(C(lb,[a,v[1],v[2]]))}else if(8===m[0]||9===m[0])return k();return n()}l[a]=!0;e.push(m);m=V(m)}return f(m)}
function V(a){var b=R(a);!ma(b)||n();a=6===b[0]?yb(b[1],b[2],a):8===b[0]?zb(b[1],b[2],b[3]):7===b[0]?Ab(b[1],b[2],a):9===b[0]?Bb(b[1],b[2],a):b;a=R(a);w(b,a);return a}exports.force1=V;exports.force_all=function(a){return D(a)};function sa(a){for(;T(a)||q(a);)a=D(ba(a));return a}exports.force_uncomment_all=sa;exports.force_uncomment1=function(a){return q(a)?a[2]:V(a)};var Cb=[];exports.env_null_v=Cb;
function Db(a,b,c){for(var e=[],f=0;f<a.length;f+=2){if(X(a[f],b)){e[f]=b;e[f+1]=c;for(f+=2;f<a.length;f+=2)e[f]=a[f],e[f+1]=a[f+1];return e}e[f]=a[f];e[f+1]=a[f+1]}e[a.length]=b;e[a.length+1]=c;return e}exports.env_set=Db;function Eb(a,b,c){for(var e=0;e<a.length;e+=2)if(X(a[e],b))return a[e+1];return c}exports.env_get=Eb;function Hb(a,b){for(var c=0;c<a.length;c+=2)if(X(a[c],b))return a[c+1];return n()}function Ib(a){for(var b=y,c=0;c<a.length;c+=2)b=[1,M(a[c],a[c+1]),b];return[3,wa,M(b)]}
exports.env2val=Ib;function Jb(a,b){for(var c=0;c<a.length;c+=2)b(a[c],a[c+1])}exports.env_foreach=Jb;function Kb(a){a=D(a);if(!A(a))return!1;var b=D(a[1]);if(!t(b)||!u(b,wa))return!1;b=D(a[2]);if(!x(b)||!z(D(b[2])))return!1;a=[];for(b=D(b[1]);!z(b);){if(!x(b))return!1;var c=D(b[1]);b=D(b[2]);if(!x(c))return!1;var e=c[1];c=D(c[2]);if(!x(c))return!1;var f=c[1];if(!z(D(c[2])))return!1;c=!0;for(var k=0;k<a.length;k+=2)if(X(a[k],e)){a[k+1]=f;c=!1;break}c&&(a.push(e),a.push(f))}return a}
exports.val2env=Kb;function Lb(a,b,c,e){var f=[],k=[];a=R(a);for(var g=!0;;){if(z(a))return e(k,f);if(q(a))k.push(a[1]),a=a[2];else if(x(a))f.push(a[1]),a=a[2];else if(T(a))if(g)g=!1,a=V(a);else return c();else return b()}}
function yb(a,b,c){function e(){return[4,E,M(ob,M(jb,M(Ib(a),f)))]}var f=V(b);return T(f)?c:x(f)?Lb(f,e,function(){return c},function(k,g){if(0!==k.length)throw"WIP";if(X(g[0],pb)){if(1===g.length)return e();for(var h=g[1],l=[],m=2;m<g.length;m++)l.push(g[m]);return[8,a,h,l]}if(X(g[0],qb)){if(1===g.length)return e();h=D([6,a,g[1]]);if(!A(h))return e();l=V(h[1]);if(T(l))return c;if(!t(l)||!u(l,I))return e();l=V(h[2]);if(T(l))return c;if(!x(l))return e();h=l[1];l=V(l[2]);if(T(l))return c;if(!z(l))return e();
l=[Ib(a)];for(m=2;m<g.length;m++)l.push(g[m]);return[9,h,l]}if(X(g[0],ob)){if(1===g.length)return e();h=g[1];l=[];for(m=2;m<g.length;m++)l.push([6,a,g[m]]);return[7,h,l]}h=[6,a,g[0]];l=[];for(m=1;m<g.length;m++)l.push([6,a,g[m]]);return[9,h,l]}):z(f)?f:t(f)||A(f)?Eb(a,f,e()):B(f)?e():n()}function Mb(a,b){return[a,1,function(c){c=V(c);return T(c)?C(a,[c]):b(c)?ub:tb}]}function Nb(a,b,c){return[a,1,function(e,f){e=V(e);return T(e)?C(a,[e]):b(e)?c(e):f()}]}
var Ob=[Mb(Ra,A),[Oa,2,fa],Nb(Pa,A,ha),Nb(Qa,A,ia),Mb(Va,B),[Sa,2,ja],Nb(Ta,B,ka),Nb(Ua,B,la),Mb(gb,z),[bb,2,ca],Mb(cb,x),Nb(db,x,da),Nb(eb,x,ea),[hb,2,function(a,b){function c(e,f,k,g){k=C(hb,[k(e),k(f)]);e=C(hb,[g(e),g(f)]);return C(lb,[k,e,tb])}if(a===b)return ub;a=V(a);b=V(b);if(T(a)||T(b))return C(hb,[a,b]);if(a===b)return ub;!T(a)||n();return z(a)?z(a)?ub:tb:t(a)?t(b)?u(a,b)?ub:tb:tb:A(a)?A(b)?c(a,b,ha,ia):tb:x(a)?x(b)?c(a,b,da,ea):tb:B(a)?B(b)?c(a,b,ka,la):tb:n()}],[ib,2,function(a,b,c){var e=
[];for(b=D(b);x(b);)e.push(b[1]),b=D(b[2]);return z(b)?[9,a,e]:c()}],[jb,2,function(a,b,c){a=Kb(a);return!1===a?c():[6,a,b]}],Mb(fb,t),[kb,1,function(a,b){a=V(a);return T(a)?C(kb,[a]):x(a)?a[1]:b()}],[lb,3,function(a,b,c,e){a=V(a);if(T(a))return C(lb,[a,b,c]);if(!A(a))return e();a=D(a[1]);return t(a)?u(a,Ba)?b:u(a,Ca)?c:e():e()}],[rb,2,aa]];
function Bb(a,b,c){function e(){return[4,E,M(ob,M(ib,M(a,O(b))))]}a=V(a);if(T(a))return c;if(!A(a))return e();c=D(a[1]);if(!t(c)||!u(c,H))return e();var f=D(a[2]);if(!x(f))return e();c=qa(f[1]);f=D(f[2]);if(!x(f)||!z(D(f[2])))return e();f=f[1];for(var k=Cb,g=0;!z(c);)if(t(c)||A(c)){for(var h=y,l=b.length-1;l>=g;l--)h=[1,b[l],h];k=Db(k,c,h);g=b.length;c=y}else if(x(c))if(g<b.length)h=b[g],g++,k=Db(k,c[1],h),c=c[2];else return e();else return e();return b.length!==g?e():[6,k,f]}
function Ab(a,b,c){function e(){return[4,E,M(ob,M(a,O(b)))]}for(var f=0;f<Ob.length;f++){var k=Ob[f];if(X(a,k[0])){if(b.length!==k[1])break;return 1===k[1]?k[2](b[0],e,c):2===k[1]?k[2](b[0],b[1],e,c):3===k[1]?k[2](b[0],b[1],b[2],e,c):n()}}return e()}function zb(a,b,c){function e(){return[4,E,M(pb,M(Ib(a),b,O(c)))]}return X(b,mb)?1!==c.length?e():c[0]:X(b,nb)?2!==c.length?e():Pb(a,c[0],c[1],e):X(b,sb)?2!==c.length?e():[11,c[0],[6,a,c[1]]]:e()}
function Pb(a,b,c,e){b=qa(b);for(var f=[],k=!1,g=b;!z(g);)if(t(g)||A(g))f.push(g),k=!0,g=y;else if(x(g))f.push(g[1]),g=g[2];else return e();g=k?O(f):b;var h=[];Jb(a,function(l){for(var m=0;m<f.length;m++)if(X(f[m],l))return;h.push(l)});e=g;for(k=h.length-1;0<=k;k--)e=[1,h[k],e];for(k=h.length-1;0<=k;k--)g=ca(M(pb,mb,Hb(a,h[k])),g);return[3,H,M(b,[1,M(pb,mb,[3,H,M(e,c)]),g])]}
function X(a,b){function c(e,f,k,g){return X(k(e),k(f))&&X(g(e),g(f))?(w(e,f),!0):!1}if(a===b)return!0;a=D(a);b=D(b);if(a===b)return!0;if(z(a)){if(!z(b))return!1;w(a,b);return!0}return t(a)?t(b)?u(a,b):!1:x(a)?x(b)?c(a,b,da,ea):!1:B(a)?B(b)?c(a,b,ka,la):!1:A(a)?A(b)?c(a,b,ha,ia):!1:n()}exports.equal_p=X;
function Y(a,b){function c(e,f,k,g){return Y(k(e),k(f))&&Y(g(e),g(f))?(w(e,f),!0):!1}if(a===b)return!0;a=R(a);b=R(b);if(a===b)return!0;if(z(a)){if(!z(b))return!1;w(a,y);w(b,y);return!0}return t(a)?t(b)?u(a,b):!1:x(a)?x(b)?c(a,b,da,ea):!1:B(a)?B(b)?c(a,b,ka,la):!1:A(a)?A(b)?c(a,b,ha,ia):!1:wb(a)?!1:n()}
function W(a){a=R(a);var b;if(z(a))return"()";if(x(a)){var c="(";for(b="";x(a);)c+=b+W(a[1]),b=" ",a=R(a[2]);return c=z(a)?c+")":c+(" . "+W(a)+")")}return A(a)?"#"+W([1,a[1],a[2]]):B(a)?"!"+W([1,a[1],a[2]]):t(a)?a[1]:q(a)?";("+W(a[1])+" "+W(a[2])+")":6===a[0]?"$("+W(Ib(a[1]))+" "+W(a[2])+")":7===a[0]?"%("+W(a[1])+" "+W(O(a[2]))+")":8===a[0]?"@("+W(Ib(a[1]))+" "+W(a[2])+" "+W(O(a[3]))+")":9===a[0]?"^("+W(a[1])+" "+W(O(a[2]))+")":n()}exports.simple_print=W;
function Qb(a){function b(){return Wa.length===ya}function c(){!b()||n();var d=Wa[ya];ya++;return d}function e(d){Wa[ya-1]===d||n();ya--}function f(d){void 0===d&&(d="");throw"TheLanguage parse ERROR!"+d;}function k(d){return" "===d||"\n"===d||"\t"===d||"\r"===d}function g(){if(b())return!1;var d=c();if(!k(d))return e(d),!1;for(;k(d)&&!b();)d=c();k(d)||e(d);return!0}function h(){if(b())return!1;var d=c(),p="";if(!U(d))return e(d),!1;for(;U(d)&&!b();)p+=d,d=c();U(d)?p+=d:e(d);return[0,p]}function l(){if(b())return!1;
var d=c();if("("!==d)return e(d),!1;for(var p=[10],r=p;;){g();if(b())return f();d=c();if(")"===d)return ta(p,y),r;if("."===d){g();d=oa();ta(p,d);g();if(b())return f();d=c();return")"!==d?f():r}e(d);d=oa();var G=[10];ta(p,[1,d,G]);p=G}}function m(){if(b())return!1;var d=c();if("#"!==d)return e(d),!1;d=l();return!1!==d&&x(d)?[3,d[1],d[2]]:f()}function v(){if(b())return!1;var d=c();if("!"!==d)return e(d),!1;d=l();return!1!==d&&x(d)?[4,d[1],d[2]]:f()}function F(d,p){return function(){if(b())return!1;
var r=c();if(r!==d)return e(r),!1;r=l();if(!1===r||!x(r))return f();var G=r[2];return x(G)&&z(G[2])?p(r[1],G[1]):f()}}function U(d){if(k(d))return!1;for(var p=0,r="()!#.$%^@~/->_:?[]&;".split("");p<r.length;p++)if(r[p]===d)return!1;return!0}function oa(){g();for(var d=0,p=[l,Xb,m,v,Xa,Ya,Za,$a,ab];d<p.length;d++){var r=(0,p[d])();if(!1!==r)return r}return f()}function K(d){return!1===d?f():d}function P(d){K(!b());K(c()===d)}function S(d){function p(){P("[");var za=S();P("]");return za}void 0===d&&
(d=!1);var r=0;for(d=d?[l,h,p,m,v,Xa,Ya,Za,$a,ab]:[l,Fb,m,v,Xa,Ya,Za,$a,ab];r<d.length;r++){var G=(0,d[r])();if(!1!==G)return G}return f()}function Gb(d){if(b())return d;var p=c();if("."===p)return p=S(),M(L,M(H,M(d),J),p);if(":"===p)return p=S(),M(L,p,d);if("~"===p)return M(xa,d);if("@"===p)return p=S(),M(L,M(H,[1,d,J],J),p);if("?"===p)return M(L,H,M(xa,d));if("/"===p){for(d=[d];;){p=S(!0);d.push(p);if(b())break;p=c();if("/"!==p){e(p);break}}return M(Aa,O(d))}e(p);return d}function Fb(){if(b())return!1;
var d=c();if("&"===d){K(!b());d=c();if("+"===d)return d=S(),M(I,M(E,d));e(d);d=S();return M(I,d)}if(":"===d){K(!b());d=c();if("&"===d)return P(">"),d=S(),M(L,M(I,M(H,J,d)),va);if(">"===d)return d=S(),M(L,M(H,J,d),va);e(d);d=S();return M(L,d,va)}if("+"===d)return d=S(),M(E,d);if("["===d)return d=S(),P("]"),Gb(d);if("_"===d)return P(":"),d=S(),M(L,d,J);e(d);d=h();return!1===d?!1:Gb(d)}function Xb(){var d=Fb();return!1===d?!1:t(d)?d:N(d)}var Wa=a,ya=0,Xa=F("$",function(d,p){var r=Kb(d);return!1===r?
f():[6,r,p]}),Ya=F("%",function(d,p){var r=vb(p,function(G){return G},function(){return f()});return[7,d,r]}),Za=function(d,p){return function(){if(b())return!1;var r=c();if(r!==d)return e(r),!1;r=l();if(!1===r||!x(r))return f();var G=r[2];if(!x(G))return f();var za=G[2];return x(za)&&z(za[2])?p(r[1],G[1],za[1]):f()}}("@",function(d,p,r){r=vb(r,function(G){return G},function(){return f()});d=Kb(d);return!1===d?f():[8,d,p,r]}),$a=F("^",function(d,p){var r=vb(p,function(G){return G},function(){return f()});
return[9,d,r]}),ab=F(";",function(d,p){return[11,d,p]});return oa()}exports.complex_parse=Qb;
function Z(a){function b(f,k){function g(F){return k?"["+F+"]":F}if(t(f))return f[1];var h=Q(f);if(!1!==h&&3===h.length&&Y(h[0],L)){var l=Q(h[1]);if(!1!==l&&3===l.length&&Y(l[0],H)){var m=l[1],v=Q(m);if(!1!==v&&1===v.length&&Y(l[2],J))return g(b(v[0],!0)+"."+b(h[2],!0));if(x(m)&&Y(m[2],J)&&Y(l[2],J))return g(b(m[1],!0)+"@"+b(h[2],!0));if(Y(m,J)&&Y(h[2],va))return g(":>"+b(l[2],!0))}m=Q(h[2]);if(Y(h[1],H)&&!1!==m&&2===m.length&&Y(m[0],xa))return g(b(m[1],!0)+"?");if(!1!==l&&2===l.length&&Y(h[2],va)&&
Y(l[0],I)&&(l=Q(l[1]),!1!==l&&3===l.length&&Y(l[0],H)&&Y(l[1],J)))return g(":&>"+b(l[2],!0));l=void 0;l=Y(h[2],J)?"_":Y(h[2],va)?"":b(h[2],!0);return g(l+":"+b(h[1],!0))}if(!1!==h&&2===h.length){if(Y(h[0],I))return l=Q(h[1]),!1!==l&&2===l.length&&Y(l[0],E)?g("&+"+b(l[1],!0)):g("&"+b(h[1],!0));if(Y(h[0],xa))return g(b(h[1],!0)+"~");if(Y(h[0],E))return g("+"+b(h[1],!0));if(Y(h[0],Aa)&&(h=Q(h[1]),!1!==h&&1<h.length)){l=b(h[0],!0);for(m=1;m<h.length;m++)l+="/"+b(h[m],!0);return g(l)}}return k?W(f):W(N(f))}
a=Qb(W(a));var c="",e="";if(z(a))return"()";if(x(a)){c="(";for(e="";x(a);)c+=e+Z(a[1]),e=" ",a=a[2];return c=z(a)?c+")":c+(" . "+Z(a)+")")}return A(a)?(c=a[1],a=a[2],e=Q(a),!1!==e&&2===e.length&&Y(c,ua)&&Y(e[0],E)?b(e[1],!1):"#"+Z([1,c,a])):B(a)?"!"+Z([1,a[1],a[2]]):t(a)?a[1]:q(a)?";("+Z(a[1])+" "+Z(a[2])+")":6===a[0]?"$("+Z(Ib(a[1]))+" "+Z(a[2])+")":7===a[0]?"%("+Z(a[1])+" "+Z(O(a[2]))+")":8===a[0]?"@("+Z(Ib(a[1]))+" "+Z(a[2])+" "+Z(O(a[3]))+")":9===a[0]?"^("+Z(a[1])+" "+Z(O(a[2]))+")":n()}
exports.complex_print=Z;
exports.machinetext_parse=function(a){function b(m){void 0===m&&(m="");throw"MT parse ERROR "+m;}function c(m){if(!m)return b()}function e(){c(0!==k);k--;return a[k]}function f(m){var v=g.pop(),F=g.pop();return void 0===F||void 0===v?b():g.unshift(m(F,v))}for(var k=a.length,g=[];0!==k;){var h=e();if("^"===h){for(h="";;){var l=e();if("^"===l)break;h=l+h}g.unshift([0,h])}else if("."===h)f(ca);else if("#"===h)f(fa);else if("!"===h)f(ja);else if("$"===h)f(function(m,v){var F=Kb(m);return!1===F?b():[6,
F,v]});else if("_"===h)g.unshift(y);else return b()}c(0===k);c(1===g.length);return g[0]};
exports.machinetext_print=function(a){function b(){for(var f=[],k=0,g=c;k<g.length;k++){var h=g[k];h=R(h);var l=function(m,v,F,U){e+=v;return f.push(F(m),U(m))};if(t(h))e+="^"+h[1]+"^";else if(x(h))l(h,".",da,ea);else if(z(h))e+="_";else if(A(h))l(h,"#",ha,ia);else if(B(h))l(h,"!",ka,la);else if(wb(h))h=xb(h),l(h,"$",function(m){return Ib(m[1])},na);else return{value:n()}}c=f}for(var c=[a],e="";0!==c.length;)if(a=b(),"object"===typeof a)return a.value;return e};exports.Trampoline=function(){};
function Rb(a){return function(){return[!1,a]}}exports.trampoline_return=Rb;function Sb(a){return function(){return[!0,a()]}}exports.trampoline_delay=Sb;function Tb(a){for(a=a();a[0];)a=a[1]();return a[1]}exports.run_trampoline=Tb;var Ub=N([1,Aa,[1,[1,Ia,[1,[1,L,[1,Ha,[1,J,y]]],y]],y]]);exports.return_effect_systemName=Ub;var Vb=N([1,Aa,[1,[1,Ia,[1,Da,y]],y]]);exports.bind_effect_systemName=Vb;exports.new_effect_bind=function(a,b){return[3,Vb,M(a,b)]};
exports.new_effect_return=function(a){return[3,Ub,a]};
function Wb(a,b,c,e,f){void 0===f&&(f=!1);c=D(c);if(A(c)){var k=c[1],g=c[2];if(X(k,Ub)){if(g=D(g),x(g)&&(k=g[1],g=D(g[2]),z(g))){if(!1===f){var h=k;k=function(){return a(h,e)}}else{var l=k;k=function(){return Wb(a,b,[9,f,l],e)}}return Sb(k)}}else if(X(k,Vb)&&(g=D(g),x(g)&&(k=g[1],g=D(g[2]),x(g)))){var m=g[1];g=D(g[2]);if(z(g)){if(!1===f){var v=k;k=function(){return Wb(a,b,v,e,m)}}else k=function(){throw"WIP";};return Sb(k)}}}return!1===f?Sb(function(){return b(c,e,a)}):Sb(function(){return b(c,e,
function(F,U){return Sb(function(){return Wb(a,b,pa(f,[F]),U)})})})}exports.run_monad_trampoline=function(a,b,c,e){return Wb(a,b,c,e)};exports.run_monad_stackoverflow=function(a,b,c,e){return Tb(Wb(function(f,k){return Rb(a(f,k))},function(f,k,g){return Rb(b(f,k,function(h,l){return Tb(g(h,l))}))},c,e))};
