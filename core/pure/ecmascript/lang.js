function h(){throw"TheLanguage PANIC";}function q(a){a in aa||h();return[0,aa[a]]}exports.new_symbol=q;function u(a){return 0===a[0]}exports.symbol_p=u;function ba(a){return ca[a[1]]}exports.un_symbol=ba;function da(a,b){return[1,a,b]}exports.new_construction=da;function v(a){return 1===a[0]}exports.construction_p=v;function ea(a){return a[1]}exports.construction_head=ea;function fa(a){return a[2]}exports.construction_tail=fa;var w=[2];exports.null_v=w;function x(a){return 2===a[0]}
exports.null_p=x;function ha(a,b){return[3,a,b]}exports.new_data=ha;function z(a){return 3===a[0]}exports.data_p=z;function ia(a){return a[1]}exports.data_name=ia;function ja(a){return a[2]}exports.data_list=ja;function ka(a,b){return[4,a,b]}exports.new_error=ka;function A(a){return 4===a[0]}exports.error_p=A;function la(a){return a[1]}exports.error_name=la;function ma(a){return a[2]}exports.error_list=ma;function C(a,b){a!==b&&(a[0]=5,a[1]=b,a[2]=!1,a[3]=!1)}
exports.evaluate=function(a,b){return[6,a,b]};function D(a,b){return[7,a,b]}exports.apply=function(a,b){return[9,a,b]};function E(a){a=F(a);if(z(a)){var b=a[1],c=a[2];a[1]=E(b);a[2]=E(c)}else A(a)?(b=a[1],c=a[2],a[1]=E(b),a[2]=E(c)):v(a)&&(b=a[1],c=a[2],a[1]=E(b),a[2]=E(c));return a}exports.force_all_rec=E;function na(a,b){10===a[0]||h();a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3]}
var aa={0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",A:"A",B:"B",C:"C",D:"D",E:"E",F:"F",G:"G",H:"H",I:"I",J:"J",K:"K",L:"L",M:"M",N:"N",O:"O",P:"P",Q:"Q",R:"R",S:"S",T:"T",U:"U",V:"V",W:"W",X:"X",Y:"Y",Z:"Z",a:"a",b:"b",c:"c",d:"d",e:"e",f:"f",g:"g",h:"h",i:"i",j:"j",k:"k",l:"l",m:"m",n:"n",o:"o",p:"p",q:"q",r:"r",s:"s",t:"t",u:"u",v:"v",w:"w",x:"x",y:"y",z:"z","\u4e00\u985e\u4f55\u7269":"\uff1a","\u4e4b\u7269":"\u7269","\u5176\u5b50":"\u5206","\u51fa\u5165\u6539\u6ec5":"\u8b8a","\u5217\u5e8f":"\u5217",
"\u5316\u6ec5":"\u5316","\u53c3\u5f62":"\u53c3","\u543e\u81ea":"\u81ea","\u592a\u59cb\u521d\u6838":"\u6838","\u5982\u82e5":"\u82e5","\u5b87\u5b99\u4ea1\u77e3":"\u6b62","\u5c3e\u672b":"\u5c3e","\u5e8f\u4e01":"\u4e01","\u5e8f\u4e19":"\u4e19","\u5e8f\u4e59":"\u4e59","\u5e8f\u7532":"\u7532","\u5f0f\u5f62":"\u5f62","\u5f15\u7528":"\u5f15","\u61c9\u7528":"\u7528","\u6548\u61c9":"\u6548","\u6620\u8868":"\u8868","\u662f\u975e":"\u6b24","\u69cb\u7269":"\u69cb","\u70ba\u7b26\u540d\u9023":"\u2010","\u7279\u5b9a\u5176\u7269":"\u7368",
"\u7701\u7565\u4e00\u7269":"\u67d0","\u7b26\u540d":"\u7b26","\u7b49\u540c":"\u7b49","\u89e3\u7b97":"\u7b97","\u8a5e\u7d20":"\u6587","\u8b2c\u8aa4":"\u8b2c","\u9023\u9838":"\u9023","\u9593\u7a7a":"\u7a7a","\u9670":"\u9670","\u967d":"\u967d","\u9996\u59cb":"\u9996"},ca={0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",A:"A",B:"B",C:"C",D:"D",E:"E",F:"F",G:"G",H:"H",I:"I",J:"J",K:"K",L:"L",M:"M",N:"N",O:"O",P:"P",Q:"Q",R:"R",S:"S",T:"T",U:"U",V:"V",W:"W",X:"X",Y:"Y",Z:"Z",a:"a",b:"b",c:"c",
d:"d",e:"e",f:"f",g:"g",h:"h",i:"i",j:"j",k:"k",l:"l",m:"m",n:"n",o:"o",p:"p",q:"q",r:"r",s:"s",t:"t",u:"u",v:"v",w:"w",x:"x",y:"y",z:"z","\uff1a":"\u4e00\u985e\u4f55\u7269","\u7269":"\u4e4b\u7269","\u5206":"\u5176\u5b50","\u8b8a":"\u51fa\u5165\u6539\u6ec5","\u5217":"\u5217\u5e8f","\u5316":"\u5316\u6ec5","\u53c3":"\u53c3\u5f62","\u81ea":"\u543e\u81ea","\u6838":"\u592a\u59cb\u521d\u6838","\u82e5":"\u5982\u82e5","\u6b62":"\u5b87\u5b99\u4ea1\u77e3","\u5c3e":"\u5c3e\u672b","\u4e01":"\u5e8f\u4e01","\u4e19":"\u5e8f\u4e19",
"\u4e59":"\u5e8f\u4e59","\u7532":"\u5e8f\u7532","\u5f62":"\u5f0f\u5f62","\u5f15":"\u5f15\u7528","\u7528":"\u61c9\u7528","\u6548":"\u6548\u61c9","\u8868":"\u6620\u8868","\u6b24":"\u662f\u975e","\u69cb":"\u69cb\u7269","\u2010":"\u70ba\u7b26\u540d\u9023","\u7368":"\u7279\u5b9a\u5176\u7269","\u67d0":"\u7701\u7565\u4e00\u7269","\u7b26":"\u7b26\u540d","\u7b49":"\u7b49\u540c","\u7b97":"\u89e3\u7b97","\u6587":"\u8a5e\u7d20","\u8b2c":"\u8b2c\u8aa4","\u9023":"\u9023\u9838","\u7a7a":"\u9593\u7a7a","\u9670":"\u9670",
"\u967d":"\u967d","\u9996":"\u9996\u59cb"},H=q("\u592a\u59cb\u521d\u6838"),oa=q("\u7b26\u540d"),I=q("\u5316\u6ec5"),K=q("\u5f0f\u5f62"),pa=q("\u7b49\u540c"),qa=q("\u89e3\u7b97"),ra=q("\u7279\u5b9a\u5176\u7269"),M=q("\u7701\u7565\u4e00\u7269"),sa=q("\u6620\u8868"),ta=q("\u5982\u82e5"),N=q("\u4e00\u985e\u4f55\u7269"),ua=q("\u662f\u975e"),va=q("\u5176\u5b50"),wa=q("\u967d"),xa=q("\u9670"),Aa=q("\u5f15\u7528"),Ba=q("\u61c9\u7528"),Ca=q("\u9593\u7a7a"),Da=q("\u9023\u9838"),Ea=q("\u69cb\u7269"),Fa=q("\u8b2c\u8aa4"),
Ga=q("\u8a5e\u7d20"),Ha=q("\u5217\u5e8f"),Ia=q("\u9996\u59cb"),Ja=q("\u5c3e\u672b"),Ka=q("\u4e4b\u7269"),La=q("\u5b87\u5b99\u4ea1\u77e3"),Ma=[4,H,P(La,M)];function Q(a){return[3,oa,P(H,a)]}function Na(a){return Q(P(N,P(I,M,a),ra))}function Oa(a,b){return Q(P(N,P(I,P(a),M),b))}function Pa(a){return Q(P(N,I,P(ua,P(N,a,M))))}
var Qa=Na(Ea),Xa=Oa(Ea,oa),Ya=Oa(Ea,Ha),Za=Pa(Ea),$a=Na(Fa),ab=Oa(Fa,oa),bb=Oa(Fa,Ha),cb=Pa(Fa),db=Na(Da),eb=Pa(Da),fb=Oa(Da,Ia),gb=Oa(Da,Ja),hb=Pa(Ga),ib=Pa(Ca),jb=Q(P(N,I,P(ua,pa))),kb=Q(P(N,P(I,[1,I,M],M),Ba)),lb=Q(P(N,I,qa)),mb=Oa(Ha,P(N,Ka,M)),nb=Q(P(N,I,ta)),ob=Q(P(N,K,Aa)),pb=Q(P(N,P(K,P(I,M,I)),ra)),qb=Q(P(K,P(H,I))),sb=Q(P(K,P(H,K))),tb=Q(P(K,K)),ub=[3,xa,P()],vb=[3,wa,P()];function wb(a,b){return a===b?!0:ba(a)===ba(b)?(C(a,b),!0):!1}
function R(a){for(var b=w,c=a.length-1;0<=c;c--)b=[1,a[c],b];return b}exports.jsArray_to_list=R;function xb(a,b,c){for(var d=[];v(a);)d.push(a[1]),a=a[2];return x(a)?b(d):c(d,a)}function S(a){return xb(a,function(b){return b},function(){return!1})}exports.maybe_list_to_jsArray=S;function P(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return R(a)}exports.new_list=P;function yb(a){for(var b=[];5===a[0];)b.push(a),a=a[1];for(var c=0;c<b.length;c++)C(b[c],a);return a}
function T(a){return 5===a[0]||6===a[0]||8===a[0]||7===a[0]||9===a[0]}exports.delay_p=T;
function F(a,b,c,d){function e(G){C(p,G);for(var L=0;L<d.length;L++)C(d[L],G);return G}function l(){c[1]=!0;return m(Ma)}function m(G){e(G);return T(G)?(d.push(p),F(G,b,[!1,!1],d)):G}function k(){var G={},L;for(L in n)G[L]=!0;for(L in b)G[L]=!0;return G}void 0===b&&(b={});void 0===c&&(c=[!1,!1]);void 0===d&&(d=[]);var n={},p=a;for(a=0;T(p)&&32>a;a++)d.push(p),p=U(p);for(;T(p);){a=V(p);if(!0===b[a])return l();if(!0===n[a]){c[0]=!0;if(6===p[0])return l();if(7===p[0]){a=p[1];for(var B=p[2],O=!1,J=0,
Z=[Xa,Ya,Za,ab,bb,cb,eb,fb,gb,hb,ib];J<Z.length;J++)if(W(Z[J],a)){O=!0;break}if(O)return 1===B.length||h(),!1===c[1]||h(),B=F(B[0],k(),c),c[1]?m(D(a,[B])):h();if(W(a,jb)||W(a,kb)||W(a,lb))return l();if(W(a,nb)&&(3===B.length||h(),!1===c[1]||h(),a=F(B[0],k(),c),c[1]))return m(D(nb,[a,B[1],B[2]]))}else if(8===p[0]||9===p[0])return l();return h()}n[a]=!0;d.push(p);p=U(p)}return e(p)}exports.force_all=F;
function U(a){var b=yb(a);5!==b[0]||h();if(6===b[0])a=zb(b[1],b[2],a);else if(8===b[0]){a=b[1];var c=b[2],d=b[3],e=[4,H,P(sb,P(Ab(a),c,R(d)))];a=W(c,ob)?1!==d.length?e:d[0]:W(c,pb)?2!==d.length?e:Bb(a,d[0],d[1],e):e}else if(7===b[0])a:{e=b[1];a=b[2];c=[4,H,P(qb,P(e,R(a)))];for(d=0;d<Cb.length;d++)if(W(e,Cb[d][0])){e=Cb[d][1];if(a.length!==e)break;d=Cb[d][2];a=1===e?d(a[0],c):2===e?d(a[0],a[1],c):3===e?d(a[0],a[1],a[2],c):h();break a}a=c}else a=9===b[0]?Db(b[1],b[2],a):b;a=yb(a);C(b,a);return a}
exports.force1=U;var Eb=[];exports.env_null_v=Eb;function Fb(a,b,c){for(var d=[],e=0;e<a.length;e+=2){if(W(a[e+0],b)){d[e+0]=b;d[e+1]=c;for(e+=2;e<a.length;e+=2)d[e+0]=a[e+0],d[e+1]=a[e+1];return d}d[e+0]=a[e+0];d[e+1]=a[e+1]}d[a.length+0]=b;d[a.length+1]=c;return d}exports.env_set=Fb;function Gb(a,b,c){for(var d=0;d<a.length;d+=2)if(W(a[d+0],b))return a[d+1];return c}exports.env_get=Gb;function Hb(a,b){for(var c=0;c<a.length;c+=2)if(W(a[c+0],b))return a[c+1];return h()}
function Ab(a){for(var b=w,c=0;c<a.length;c+=2)b=[1,P(a[c+0],a[c+1]),b];return[3,sa,P(b)]}exports.env2val=Ab;function Ib(a,b){for(var c=0;c<a.length;c+=2)b(a[c+0],a[c+1])}exports.env_foreach=Ib;
function Jb(a){a=F(a);if(!z(a))return!1;var b=F(a[1]);if(!u(b)||!wb(b,sa))return!1;b=F(a[2]);if(!v(b)||!x(F(b[2])))return!1;a=[];for(b=F(b[1]);!x(b);){if(!v(b))return!1;var c=F(b[1]);b=F(b[2]);if(!v(c))return!1;var d=c[1];c=F(c[2]);if(!v(c))return!1;var e=c[1];if(!x(F(c[2])))return!1;c=!0;for(var l=0;l<a.length;l+=2)if(W(a[l+0],d)){a[l+1]=e;c=!1;break}c&&(a.push(d),a.push(e))}return a}exports.val2env=Jb;
function zb(a,b,c){var d=U(b);if(T(d))return c;var e=[4,H,P(qb,P(lb,P(Ab(a),d)))];if(v(d)){for(b=[];!x(d);){if(T(d))return c;if(v(d))b.push(d[1]),d=U(d[2]);else return e}if(W(b[0],sb)){if(1===b.length)return e;d=b[1];c=[];for(e=2;e<b.length;e++)c.push(b[e]);return[8,a,d,c]}if(W(b[0],tb)){if(1===b.length)return e;d=F([6,a,b[1]]);if(!z(d))return e;var l=U(d[1]);if(T(l))return c;if(!u(l)||!wb(l,K))return e;l=U(d[2]);if(T(l))return c;if(!v(l))return e;d=l[1];l=U(l[2]);if(T(l))return c;if(!x(l))return e;
c=[Ab(a)];for(e=2;e<b.length;e++)c.push(b[e]);return[9,d,c]}if(W(b[0],qb)){if(1===b.length)return e;d=b[1];c=[];for(e=2;e<b.length;e++)c.push([6,a,b[e]]);return[7,d,c]}d=[6,a,b[0]];c=[];for(e=1;e<b.length;e++)c.push([6,a,b[e]]);return[9,d,c]}return x(d)?d:u(d)||z(d)?Gb(a,d,e):A(d)?e:h()}function Kb(a,b){return[a,1,function(c){c=U(c);return T(c)?D(a,[c]):b(c)?vb:ub}]}function Lb(a,b,c){return[a,1,function(d,e){d=U(d);return T(d)?D(a,[d]):b(d)?c(d):e}]}
var Cb=[Kb(Za,z),[Qa,2,ha],Lb(Xa,z,ia),Lb(Ya,z,ja),Kb(cb,A),[$a,2,ka],Lb(ab,A,la),Lb(bb,A,ma),Kb(ib,x),[db,2,da],Kb(eb,v),Lb(fb,v,ea),Lb(gb,v,fa),[jb,2,function(a,b){function c(d,e,l,m){l=D(jb,[l(d),l(e)]);d=D(jb,[m(d),m(e)]);return D(nb,[l,d,ub])}if(a===b)return vb;a=U(a);b=U(b);if(T(a)||T(b))return D(jb,[a,b]);if(a===b)return vb;!T(a)||h();return x(a)?x(a)?vb:ub:u(a)?u(b)?wb(a,b)?vb:ub:ub:z(a)?z(b)?c(a,b,ia,ja):ub:v(a)?v(b)?c(a,b,ea,fa):ub:A(a)?A(b)?c(a,b,la,ma):ub:h()}],[kb,2,function(a,b,c){var d=
[];for(b=F(b);v(b);)d.push(b[1]),b=F(b[2]);return x(b)?[9,a,d]:c}],[lb,2,function(a,b,c){a=Jb(a);return!1===a?c:[6,a,b]}],Kb(hb,u),[mb,1,function(a,b){a=U(a);return T(a)?D(mb,[a]):v(a)?a[1]:b}],[nb,3,function(a,b,c,d){a=U(a);if(T(a))return D(nb,[a,b,c]);if(!z(a))return d;a=F(a[1]);return u(a)?wb(a,wa)?b:wb(a,xa)?c:d:d}]];
function Db(a,b,c){function d(){return[4,H,P(qb,P(kb,P(a,R(b))))]}a=U(a);if(T(a))return c;if(!z(a))return d();c=F(a[1]);if(!u(c)||!wb(c,I))return d();var e=F(a[2]);if(!v(e))return d();c=E(e[1]);e=F(e[2]);if(!v(e)||!x(F(e[2])))return d();e=e[1];for(var l=Eb,m=0;!x(c);)if(u(c)||z(c)){for(var k=w,n=b.length-1;n>=m;n--)k=[1,b[n],k];l=Fb(l,c,k);m=b.length;c=w}else if(v(c))if(m<b.length)k=b[m],m++,l=Fb(l,c[1],k),c=c[2];else return d();else return d();return b.length!==m?d():[6,l,e]}
function Bb(a,b,c,d){void 0===d&&(d=!1);b=E(b);for(var e=[],l=!1,m=b;!x(m);)if(u(m)||z(m))e.push(m),l=!0,m=w;else if(v(m))e.push(m[1]),m=m[2];else return!1===d?ka(H,P(sb,P(Ab(a),pb,R([b,c])))):d;d=b;l&&(d=R(e));var k=[];Ib(a,function(n){for(var p=0;p<e.length;p++)if(W(e[p],n))return;k.push(n)});l=d;for(m=k.length-1;0<=m;m--)l=[1,k[m],l];for(m=k.length-1;0<=m;m--)d=da(P(sb,ob,Hb(a,k[m])),d);return ha(I,P(b,da(P(sb,ob,[3,I,P(l,c)]),d)))}
function W(a,b){function c(d,e,l,m){return W(l(d),l(e))&&W(m(d),m(e))?(C(d,e),!0):!1}if(a===b)return!0;a=F(a);b=F(b);if(a===b)return!0;if(x(a)){if(!x(b))return!1;C(a,w);C(b,w);return!0}return u(a)?u(b)?wb(a,b):!1:v(a)?v(b)?c(a,b,ea,fa):!1:A(a)?A(b)?c(a,b,la,ma):!1:z(a)?z(b)?c(a,b,ia,ja):!1:h()}exports.equal_p=W;
function X(a,b){function c(d,e,l,m){return X(l(d),l(e))&&X(m(d),m(e))?(C(d,e),!0):!1}if(a===b)return!0;a=yb(a);b=yb(b);if(a===b)return!0;if(x(a)){if(!x(b))return!1;C(a,w);C(b,w);return!0}return u(a)?u(b)?wb(a,b):!1:v(a)?v(b)?c(a,b,ea,fa):!1:A(a)?A(b)?c(a,b,la,ma):!1:z(a)?z(b)?c(a,b,ia,ja):!1:6===a[0]||7===a[0]||8===a[0]||9===a[0]?!1:h()}
function V(a){a=yb(a);var b;if(x(a))return"()";if(v(a)){var c="(";for(b="";v(a);)c+=b+V(a[1]),b=" ",a=yb(a[2]);return c=x(a)?c+")":c+(" . "+V(a)+")")}return z(a)?"#"+V([1,a[1],a[2]]):A(a)?"!"+V([1,a[1],a[2]]):u(a)?ba(a):6===a[0]?"$("+V(Ab(a[1]))+" "+V(a[2])+")":7===a[0]?"%("+V(a[1])+" "+V(R(a[2]))+")":8===a[0]?"@("+V(Ab(a[1]))+" "+V(a[2])+" "+V(R(a[3]))+")":9===a[0]?"^("+V(a[1])+" "+V(R(a[2]))+")":h()}exports.simple_print=V;exports.simple_print_force_all_rec=function(a){return V(E(a))};
function Mb(a){function b(){return Ra.length===ya}function c(){!b()||h();var f=Ra[ya];ya++;return f}function d(f){Ra[ya-1]===f||h();ya--}function e(f){void 0===f&&(f="");throw"TheLanguage parse ERROR!"+f;}function l(f){return" "===f||"\n"===f||"\t"===f||"\r"===f}function m(){if(b())return!1;var f=c();if(!l(f))return d(f),!1;for(;l(f)&&!b();)f=c();l(f)||d(f);return!0}function k(){if(b())return!1;var f=c(),t="";if(!J(f))return d(f),!1;for(;J(f)&&!b();)t+=f,f=c();J(f)?t+=f:d(f);t in aa||e("Not Symbol"+
t);return q(t)}function n(){if(b())return!1;var f=c();if("("!==f)return d(f),!1;for(var t=[10],g=t;;){m();if(b())return e();f=c();if(")"===f)return na(t,w),g;if("."===f){m();f=Z();na(t,f);m();if(b())return e();f=c();return")"!==f?e():g}d(f);f=Z();var r=[10];na(t,[1,f,r]);t=r}}function p(){if(b())return!1;var f=c();if("#"!==f)return d(f),!1;f=n();return!1!==f&&v(f)?[3,f[1],f[2]]:e()}function B(){if(b())return!1;var f=c();if("!"!==f)return d(f),!1;f=n();return!1!==f&&v(f)?[4,f[1],f[2]]:e()}function O(f,
t){return function(){if(b())return!1;var g=c();if(g!==f)return d(g),!1;g=n();if(!1===g||!v(g))return e();var r=g[2];return v(r)&&x(r[2])?t(g[1],r[1]):e()}}function J(f){if(l(f))return!1;for(var t="()!#.$%^@~/->_:?[]&".split(""),g=0;g<t.length;g++)if(f===t[g])return!1;return!0}function Z(){m();for(var f=[n,Nb,p,B,Sa,Ta,Ua,Va],t=0;t<f.length;t++){var g=f[t]();if(!1!==g)return g}return e()}function G(f){return!1===f?e():f}function L(f){G(!b());G(c()===f)}function za(){function f(r){function y(){L("[");
var Ob=f();L("]");return Ob}void 0===r&&(r=!1);r=r?[n,k,y,p,B,Sa,Ta,Ua,Va]:[n,za,p,B,Sa,Ta,Ua,Va];for(var Wa=0;Wa<r.length;Wa++){var rb=r[Wa]();if(!1!==rb)return rb}return e()}function t(r){if(b())return r;var y=c();if("."===y)return y=f(),P(N,P(I,P(r),M),y);if(":"===y)return y=f(),P(N,y,r);if("~"===y)return P(ua,r);if("@"===y)return y=f(),P(N,P(I,[1,r,M],M),y);if("?"===y)return P(N,I,P(ua,r));if("/"===y){for(r=[r];;){y=f(!0);r.push(y);if(b())break;y=c();if("/"!==y){d(y);break}}return P(va,R(r))}d(y);
return r}if(b())return!1;var g=c();if("&"===g){G(!b());g=c();if("+"===g)return g=f(),P(K,P(H,g));d(g);g=f();return P(K,g)}if(":"===g){G(!b());g=c();if("&"===g)return L(">"),g=f(),P(N,P(K,P(I,M,g)),ra);if(">"===g)return g=f(),P(N,P(I,M,g),ra);d(g);g=f();return P(N,g,ra)}if("+"===g)return g=f(),P(H,g);if("["===g)return g=f(),L("]"),t(g);if("_"===g)return L(":"),g=f(),P(N,g,M);d(g);g=k();return!1===g?!1:t(g)}function Nb(){var f=za();return!1===f?!1:u(f)?f:Q(f)}var Ra=a,ya=0,Sa=O("$",function(f,t){var g=
Jb(f);return!1===g?e():[6,g,t]}),Ta=O("%",function(f,t){var g=xb(t,function(r){return r},function(){return e()});return[7,f,g]}),Ua=function(f,t){return function(){if(b())return!1;var g=c();if(g!==f)return d(g),!1;g=n();if(!1===g||!v(g))return e();var r=g[2];if(!v(r))return e();var y=r[2];return v(y)&&x(y[2])?t(g[1],r[1],y[1]):e()}}("@",function(f,t,g){g=xb(g,function(r){return r},function(){return e()});f=Jb(f);return!1===f?e():[8,f,t,g]}),Va=O("^",function(f,t){var g=xb(t,function(r){return r},
function(){return e()});return[9,f,g]});return Z()}exports.complex_parse=Mb;
function Y(a){function b(e,l){function m(O){return"inner"===l?"["+O+"]":"top"===l?O:h()}if(u(e))return ba(e);var k=S(e);if(!1!==k&&3===k.length&&X(k[0],N)){var n=S(k[1]);if(!1!==n&&3===n.length&&X(n[0],I)){var p=n[1],B=S(p);if(!1!==B&&1===B.length&&X(n[2],M))return m(b(B[0],"inner")+"."+b(k[2],"inner"));if(v(p)&&X(p[2],M)&&X(n[2],M))return m(b(p[1],"inner")+"@"+b(k[2],"inner"));if(X(p,M)&&X(k[2],ra))return m(":>"+b(n[2],"inner"))}p=S(k[2]);if(X(k[1],I)&&!1!==p&&2===p.length&&X(p[0],ua))return m(b(p[1],
"inner")+"?");if(!1!==n&&2===n.length&&X(k[2],ra)&&X(n[0],K)&&(n=S(n[1]),!1!==n&&3===n.length&&X(n[0],I)&&X(n[1],M)))return m(":&>"+b(n[2],"inner"));n=X(k[2],M)?"_":X(k[2],ra)?"":b(k[2],"inner");return m(n+":"+b(k[1],"inner"))}if(!1!==k&&2===k.length){if(X(k[0],K))return n=S(k[1]),!1!==n&&2===n.length&&X(n[0],H)?m("&+"+b(n[1],"inner")):m("&"+b(k[1],"inner"));if(X(k[0],ua))return m(b(k[1],"inner")+"~");if(X(k[0],H))return m("+"+b(k[1],"inner"));if(X(k[0],va)&&(k=S(k[1]),!1!==k&&1<k.length)){n=b(k[0],
"inner");for(p=1;p<k.length;p++)n+="/"+b(k[p],"inner");return m(n)}}return"inner"===l?V(e):"top"===l?V(Q(e)):h()}a=Mb(V(a));var c="",d="";if(x(a))return"()";if(v(a)){c="(";for(d="";v(a);)c+=d+Y(a[1]),d=" ",a=a[2];return c=x(a)?c+")":c+(" . "+Y(a)+")")}return z(a)?(c=a[1],a=a[2],d=S(a),!1!==d&&2===d.length&&X(c,oa)&&X(d[0],H)?b(d[1],"top"):"#"+Y([1,c,a])):A(a)?"!"+Y([1,a[1],a[2]]):u(a)?ba(a):6===a[0]?"$("+Y(Ab(a[1]))+" "+Y(a[2])+")":7===a[0]?"%("+Y(a[1])+" "+Y(R(a[2]))+")":8===a[0]?"@("+Y(Ab(a[1]))+
" "+Y(a[2])+" "+Y(R(a[3]))+")":9===a[0]?"^("+Y(a[1])+" "+Y(R(a[2]))+")":h()}exports.complex_print=Y;
exports.machinetext_parse=function(a){function b(){function m(B){function O(G){var L=[10],za=[10];k.push(L);k.push(za);na(B,G(L,za))}var J=c();if("$"===J){for(J="";;){var Z=c();if("$"===Z)break;J+=Z}na(B,[0,J])}else if("."===J)O(da);else if("#"===J)O(ha);else if("!"===J)O(ka);else if("_"===J)na(B,w);else throw"WIP";}for(var k=[],n=0,p=e;n<p.length;n++)m(p[n]);e=k}function c(){if(!(a.length>l))throw"MT parse ERROR";var m=a[l];l++;return m}for(var d=[10],e=[d],l=0;0!==e.length;)b();if(l!=a.length)throw"MT parse ERROR";
return d};exports.machinetext_print=function(a){function b(){for(var e=[],l=0,m=c;l<m.length;l++){var k=m[l];k=yb(k);var n=function(p,B,O,J){d+=B;e.push(O(p));e.push(J(p))};if(u(k))d+="$",d+=k[1],d+="$";else if(v(k))n(k,".",ea,fa);else if(x(k))d+="_";else if(z(k))n(k,"#",ia,ja);else if(A(k))n(k,"!",la,ma);else throw"WIP";}c=e}for(var c=[a],d="";0!==c.length;)b();return d};
