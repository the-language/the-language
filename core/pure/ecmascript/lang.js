function k(){throw"TheLanguage PANIC";}exports.new_symbol=function(a){return[0,a]};function q(a){return 0===a[0]}exports.symbol_p=q;exports.un_symbol=function(a){return a[1]};function aa(a,b){return[1,a,b]}exports.new_construction=aa;function x(a){return 1===a[0]}exports.construction_p=x;function ba(a){return a[1]}exports.construction_head=ba;function da(a){return a[2]}exports.construction_tail=da;var z=[2];exports.null_v=z;function A(a){return 2===a[0]}exports.null_p=A;
function ea(a,b){return[3,a,b]}exports.new_data=ea;function B(a){return 3===a[0]}exports.data_p=B;function fa(a){return a[1]}exports.data_name=fa;function ha(a){return a[2]}exports.data_list=ha;function ia(a,b){return[4,a,b]}exports.new_error=ia;function D(a){return 4===a[0]}exports.error_p=D;function ja(a){return a[1]}exports.error_name=ja;function ka(a){return a[2]}exports.error_list=ka;function F(a,b){a!==b&&(a[0]=5,a[1]=b,a[2]=!1,a[3]=!1)}exports.evaluate=function(a,b){return[6,a,b]};
function ma(a,b){return[7,a,b]}exports.apply=function(a,b){return[9,a,b]};function na(a){a=G(a);if(B(a)){var b=a[1],c=a[2];a[1]=na(b);a[2]=na(c)}else D(a)?(b=a[1],c=a[2],a[1]=na(b),a[2]=na(c)):x(a)&&(b=a[1],c=a[2],a[1]=na(b),a[2]=na(c));return a}exports.force_all_rec=na;
var H=[0,"\u592a\u59cb\u521d\u6838"],oa=[0,"\u7b26\u540d"],J=[0,"\u5316\u6ec5"],K=[0,"\u5f0f\u5f62"],pa=[0,"\u7279\u5b9a\u5176\u7269"],L=[0,"\u7701\u7565\u4e00\u7269"],qa=[0,"\u6620\u8868"],N=[0,"\u4e00\u985e\u4f55\u7269"],ra=[0,"\u662f\u975e"],sa=[0,"\u5176\u5b50"],ta=[0,"\u967d"],ua=[0,"\u9670"],va=[0,"\u9023"],wa=[0,"\u69cb"],xa=[0,"\u8aa4"],ya=[0,"\u5217"],za={"\u4e19":!0,"\u4e59":!0,"\u7701\u7565\u4e00\u7269":!0,"\u89e3\u7b97":!0,"\u82e5":!0,"\u662f\u975e":!0,"\u5f15\u7528":!0,"\u5316\u6ec5":!0,
"\u7b49\u540c":!0,"\u7532":!0,"\u61c9\u7528":!0,A:!0,l:!0,"\u6620\u8868":!0,v:!0,6:!0,E:!0,N:!0,U:!0,Q:!0,x:!0,5:!0,D:!0,1:!0,a:!0,0:!0,"\u9670":!0,"\u7b26\u540d":!0,e:!0,t:!0,4:!0,"\u7269":!0,P:!0,y:!0,V:!0,F:!0,d:!0,"\u5217":!0,"\u8a5e\u7d20":!0,"\u7a7a":!0,"\u4e01":!0,"\u592a\u59cb\u521d\u6838":!0,"\u70ba\u7b26\u540d\u9023":!0,"\u7279\u5b9a\u5176\u7269":!0,"\u6548\u61c9":!0,"\u9996":!0,"\u9023":!0,"\u81ea":!0,"\u53c3\u5f62":!0,h:!0,g:!0,R:!0,r:!0,c:!0,J:!0,2:!0,"\u967d":!0,i:!0,X:!0,8:!0,"\u5176\u5b50":!0,
f:!0,O:!0,u:!0,T:!0,"\u4e00\u985e\u4f55\u7269":!0,q:!0,m:!0,b:!0,K:!0,p:!0,"\u51fa\u5165\u6539\u6ec5":!0,Y:!0,H:!0,n:!0,G:!0,W:!0,"\u8aa4":!0,L:!0,j:!0,9:!0,C:!0,o:!0,w:!0,7:!0,I:!0,M:!0,s:!0,3:!0,z:!0,Z:!0,S:!0,k:!0,B:!0,"\u5f0f\u5f62":!0,"\u69cb":!0,"\u5c3e":!0,"\u5b87\u5b99\u4ea1\u77e3":!0},Aa=[4,H,O([0,"\u5b87\u5b99\u4ea1\u77e3"],L)];function P(a){return[3,oa,O(H,a)]}function Ba(a){return P(O(N,O(J,L,a),pa))}function Da(a,b){return P(O(N,O(J,O(a),L),b))}
function Ea(a){return P(O(N,J,O(ra,O(N,a,L))))}
var Fa=Ba(wa),Ga=Da(wa,oa),Ha=Da(wa,ya),Ia=Ea(wa),Ka=Ba(xa),La=Da(xa,oa),Ma=Da(xa,ya),Na=Ea(xa),Oa=Ba(va),Pa=Ea(va),Qa=Da(va,[0,"\u9996"]),Ra=Da(va,[0,"\u5c3e"]),Ta=Ea([0,"\u8a5e\u7d20"]),Ua=Ea([0,"\u7a7a"]),Va=P(O(N,J,O(ra,[0,"\u7b49\u540c"]))),Wa=P(O(N,O(J,[1,J,L],L),[0,"\u61c9\u7528"])),Xa=P(O(N,J,[0,"\u89e3\u7b97"])),Ya=Da(ya,O(N,[0,"\u7269"],L)),Za=P(O(N,J,[0,"\u82e5"])),$a=P(O(N,K,[0,"\u5f15\u7528"])),ab=P(O(N,O(K,O(J,L,J)),pa)),bb=P(O(K,O(H,J))),cb=P(O(K,O(H,K))),db=P(O(K,K)),eb=[3,ua,O()],
fb=[3,ta,O()];function gb(a,b){return a===b?!0:a[1]===b[1]?(F(a,b),!0):!1}function Q(a){for(var b=z,c=a.length-1;0<=c;c--)b=[1,a[c],b];return b}exports.jsArray_to_list=Q;function hb(a,b,c){for(var d=[];x(a);)d.push(a[1]),a=a[2];return A(a)?b(d):c(d,a)}function ib(a){return hb(a,function(b){return b},function(){return!1})}exports.maybe_list_to_jsArray=ib;function O(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return Q(a)}exports.new_list=O;
function jb(a){for(var b=[];5===a[0];)b.push(a),a=a[1];for(var c=0;c<b.length;c++)F(b[c],a);return a}function R(a){return 5===a[0]||6===a[0]||8===a[0]||7===a[0]||9===a[0]}exports.delay_p=R;
function G(a,b,c,d){function e(E){F(v,E);for(var I=0;I<d.length;I++)F(d[I],E);return E}function l(){c[1]=!0;return m(Aa)}function m(E){e(E);return R(E)?(d.push(v),G(E,b,[!1,!1],d)):E}function p(){var E={},I;for(I in n)E[I]=!0;for(I in b)E[I]=!0;return E}void 0===b&&(b={});void 0===c&&(c=[!1,!1]);void 0===d&&(d=[]);for(var n={},v=a;R(v);){a=S(v);if(!0===b[a])return l();if(!0===n[a]){c[0]=!0;if(6===v[0])return l();if(7===v[0]){a=v[1];for(var M=v[2],V=[Ga,Ha,Ia,La,Ma,Na,Pa,Qa,Ra,Ta,Ua],ca=!1,Y=0;Y<V.length;Y++)T(V[Y],
a)&&(ca=!0);if(ca)return 1===M.length||k(),!1===c[1]||k(),M=G(M[0],p(),c),c[1]?m(ma(a,[M])):k();if(T(a,Va)||T(a,Wa)||T(a,Xa))return l();if(T(a,Za)&&(3===M.length||k(),!1===c[1]||k(),a=G(M[0],p(),c),c[1]))return m(ma(Za,[a,M[1],M[2]]))}else if(8===v[0]||9===v[0])return l();return k()}n[a]=!0;d.push(v);v=U(v)}return e(v)}exports.force_all=G;
function U(a){var b=jb(a);5!==b[0]||k();if(6===b[0])a=kb(b[1],b[2],a);else if(8===b[0]){a=b[1];var c=b[2],d=b[3],e=[4,H,O(cb,O(lb(a),c,Q(d)))];a=T(c,$a)?1!==d.length?e:d[0]:T(c,ab)?2!==d.length?e:mb(a,d[0],d[1],e):e}else if(7===b[0])a:{e=b[1];a=b[2];c=[4,H,O(bb,O(e,Q(a)))];for(d=0;d<nb.length;d++)if(T(e,nb[d][0])){e=nb[d][1];if(a.length!==e)break;d=nb[d][2];a=1===e?d(a[0],c):2===e?d(a[0],a[1],c):3===e?d(a[0],a[1],a[2],c):k();break a}a=c}else a=9===b[0]?ob(b[1],b[2],a):b;a=jb(a);F(b,a);return a}
exports.force1=U;var qb=[];exports.env_null_v=qb;function rb(a,b,c){for(var d=[],e=0;e<a.length;e+=2){if(T(a[e+0],b)){d[e+0]=b;d[e+1]=c;for(e+=2;e<a.length;e+=2)d[e+0]=a[e+0],d[e+1]=a[e+1];return d}d[e+0]=a[e+0];d[e+1]=a[e+1]}d[a.length+0]=b;d[a.length+1]=c;return d}exports.env_set=rb;function sb(a,b,c){for(var d=0;d<a.length;d+=2)if(T(a[d+0],b))return a[d+1];return c}exports.env_get=sb;function tb(a,b){for(var c=0;c<a.length;c+=2)if(T(a[c+0],b))return a[c+1];return k()}
function lb(a){for(var b=z,c=0;c<a.length;c+=2)b=[1,O(a[c+0],a[c+1]),b];return[3,qa,O(b)]}exports.env2val=lb;function ub(a,b){for(var c=0;c<a.length;c+=2)b(a[c+0],a[c+1])}exports.env_foreach=ub;
function vb(a){a=G(a);if(!B(a))return!1;var b=G(a[1]);if(!q(b)||!gb(b,qa))return!1;b=G(a[2]);if(!x(b)||!A(G(b[2])))return!1;a=[];for(b=G(b[1]);!A(b);){if(!x(b))return!1;var c=G(b[1]);b=G(b[2]);if(!x(c))return!1;var d=c[1];c=G(c[2]);if(!x(c))return!1;var e=c[1];if(!A(G(c[2])))return!1;c=!0;for(var l=0;l<a.length;l+=2)if(T(a[l+0],d)){a[l+1]=e;c=!1;break}c&&(a.push(d),a.push(e))}return a}exports.val2env=vb;
function kb(a,b,c){var d=U(b);if(R(d))return c;var e=[4,H,O(bb,O(Xa,O(lb(a),d)))];if(x(d)){for(b=[];!A(d);){if(R(d))return c;if(x(d))b.push(d[1]),d=U(d[2]);else return e}if(T(b[0],cb)){if(1===b.length)return e;d=b[1];c=[];for(e=2;e<b.length;e++)c[e-2]=b[e];return[8,a,d,c]}if(T(b[0],db)){if(1===b.length)return e;d=G([6,a,b[1]]);if(!B(d))return e;var l=U(d[1]);if(R(l))return c;if(!q(l)||!gb(l,K))return e;l=U(d[2]);if(R(l))return c;if(!x(l))return e;d=l[1];l=U(l[2]);if(R(l))return c;if(!A(l))return e;
c=[lb(a)];for(e=2;e<b.length;e++)c[e-1]=b[e];return[9,d,c]}if(T(b[0],bb)){if(1===b.length)return e;d=b[1];c=[];for(e=2;e<b.length;e++)c[e-2]=[6,a,b[e]];return[7,d,c]}d=[6,a,b[0]];c=[];for(e=1;e<b.length;e++)c[e-1]=[6,a,b[e]];return[9,d,c]}return A(d)?d:q(d)||B(d)?sb(a,d,e):D(d)?e:k()}function wb(a,b){return[a,1,function(c){c=U(c);return R(c)?ma(a,[c]):b(c)?fb:eb}]}function xb(a,b,c){return[a,1,function(d,e){d=U(d);return R(d)?ma(a,[d]):b(d)?c(d):e}]}
var nb=[wb(Ia,B),[Fa,2,ea],xb(Ga,B,fa),xb(Ha,B,ha),wb(Na,D),[Ka,2,ia],xb(La,D,ja),xb(Ma,D,ka),wb(Ua,A),[Oa,2,aa],wb(Pa,x),xb(Qa,x,ba),xb(Ra,x,da),[Va,2,function(a,b){function c(d,e,l,m){l=ma(Va,[l(d),l(e)]);d=ma(Va,[m(d),m(e)]);return ma(Za,[l,d,eb])}if(a===b)return fb;a=U(a);b=U(b);if(R(a)||R(b))return ma(Va,[a,b]);if(a===b)return fb;!R(a)||k();return A(a)?A(a)?fb:eb:q(a)?q(b)?gb(a,b)?fb:eb:eb:B(a)?B(b)?c(a,b,fa,ha):eb:x(a)?x(b)?c(a,b,ba,da):eb:D(a)?D(b)?c(a,b,ja,ka):eb:k()}],[Wa,2,function(a,b,
c){var d=[];for(b=G(b);x(b);)d.push(b[1]),b=G(b[2]);return A(b)?[9,a,d]:c}],[Xa,2,function(a,b,c){a=vb(a);return!1===a?c:[6,a,b]}],wb(Ta,q),[Ya,1,function(a,b){a=U(a);return R(a)?ma(Ya,[a]):x(a)?a[1]:b}],[Za,3,function(a,b,c,d){a=U(a);if(R(a))return ma(Za,[a,b,c]);if(!B(a))return d;a=G(a[1]);return q(a)?gb(a,ta)?b:gb(a,ua)?c:d:d}]];
function ob(a,b,c){function d(){return[4,H,O(bb,O(Wa,O(a,Q(b))))]}a=U(a);if(R(a))return c;if(!B(a))return d();c=G(a[1]);if(!q(c)||!gb(c,J))return d();var e=G(a[2]);if(!x(e))return d();c=na(e[1]);e=G(e[2]);if(!x(e)||!A(G(e[2])))return d();e=e[1];for(var l=qb,m=0;!A(c);)if(q(c)||B(c)){for(var p=z,n=b.length-1;n>=m;n--)p=[1,b[n],p];l=rb(l,c,p);m=b.length;c=z}else if(x(c))if(m<b.length)p=b[m],m++,l=rb(l,c[1],p),c=c[2];else return d();else return d();return b.length!==m?d():[6,l,e]}
function mb(a,b,c,d){void 0===d&&(d=!1);b=na(b);for(var e=[],l=!1,m=b;!A(m);)if(q(m)||B(m))e.push(m),l=!0,m=z;else if(x(m))e.push(m[1]),m=m[2];else return!1===d?ia(H,O(cb,O(lb(a),ab,Q([b,c])))):d;d=b;l&&(d=Q(e));var p=[];ub(a,function(n){for(var v=0;v<e.length;v++)if(T(e[v],n))return;p.push(n)});l=d;for(m=p.length-1;0<=m;m--)l=[1,p[m],l];for(m=p.length-1;0<=m;m--)d=aa(O(cb,$a,tb(a,p[m])),d);return[3,J,O(b,[1,O(cb,$a,[3,J,O(l,c)]),d])]}
function T(a,b){function c(d,e,l,m){return T(l(d),l(e))&&T(m(d),m(e))?(F(d,e),!0):!1}if(a===b)return!0;a=G(a);b=G(b);if(a===b)return!0;if(A(a)){if(!A(b))return!1;F(a,z);F(b,z);return!0}return q(a)?q(b)?gb(a,b):!1:x(a)?x(b)?c(a,b,ba,da):!1:D(a)?D(b)?c(a,b,ja,ka):!1:B(a)?B(b)?c(a,b,fa,ha):!1:k()}exports.equal_p=T;
function W(a,b){function c(d,e,l,m){return W(l(d),l(e))&&W(m(d),m(e))?(F(d,e),!0):!1}if(a===b)return!0;a=jb(a);b=jb(b);if(a===b)return!0;if(A(a)){if(!A(b))return!1;F(a,z);F(b,z);return!0}return q(a)?q(b)?gb(a,b):!1:x(a)?x(b)?c(a,b,ba,da):!1:D(a)?D(b)?c(a,b,ja,ka):!1:B(a)?B(b)?c(a,b,fa,ha):!1:6===a[0]||7===a[0]||8===a[0]||9===a[0]?!1:k()}
function S(a){a=jb(a);var b;if(A(a))return"()";if(x(a)){var c="(";for(b="";x(a);)c+=b+S(a[1]),b=" ",a=jb(a[2]);return c=A(a)?c+")":c+(" . "+S(a)+")")}return B(a)?"#"+S([1,a[1],a[2]]):D(a)?"!"+S([1,a[1],a[2]]):q(a)?a[1]:6===a[0]?"$("+S(lb(a[1]))+" "+S(a[2])+")":7===a[0]?"%("+S(a[1])+" "+S(Q(a[2]))+")":8===a[0]?"@("+S(lb(a[1]))+" "+S(a[2])+" "+S(Q(a[3]))+")":9===a[0]?"^("+S(a[1])+" "+S(Q(a[2]))+")":k()}exports.simple_print=S;exports.simple_print_force_all_rec=function(a){return S(na(a))};
function yb(a){function b(){return E.length===I}function c(){!b()||k();var g=E[I];I++;return g}function d(g){E[I-1]===g||k();I--}function e(g){void 0===g&&(g="");throw"TheLanguage parse ERROR!"+g;}function l(g){return" "===g||"\n"===g||"\t"===g||"\r"===g}function m(){if(b())return!1;var g=c();if(!l(g))return d(g),!1;for(;l(g)&&!b();)g=c();l(g)||d(g);return!0}function p(){if(b())return!1;var g=c(),u="";if(!ca(g))return d(g),!1;for(;ca(g)&&!b();)u+=g,g=c();ca(g)?u+=g:d(g);u in za||e("Not Symbol"+u);
return[0,u]}function n(){function g(f){if(C===t)C=f;else{for(var r=C;;){if(!x(r))return k();if(r[2]===t)break;r=r[2]}if(!x(r)||r[2]!==t)return k();r[2]=f}}if(b())return!1;var u=c();if("("!==u)return d(u),!1;for(var t=[0,"!!@@READ||HOLE@@!!"],C=t;;){m();if(b())return e();u=c();if(")"===u)return g(z),C;if("."===u){m();u=Y();g(u);m();if(b())return e();u=c();return")"!==u?e():C}d(u);u=Y();g([1,u,t])}}function v(){if(b())return!1;var g=c();if("#"!==g)return d(g),!1;g=n();return!1!==g&&x(g)?[3,g[1],g[2]]:
e()}function M(){if(b())return!1;var g=c();if("!"!==g)return d(g),!1;g=n();return!1!==g&&x(g)?[4,g[1],g[2]]:e()}function V(g,u){return function(){if(b())return!1;var t=c();if(t!==g)return d(t),!1;t=n();if(!1===t||!x(t))return e();var C=t[2];return x(C)&&A(C[2])?u(t[1],C[1]):e()}}function ca(g){if(l(g))return!1;for(var u="()!#.$%^@~/->_:?[]&".split(""),t=0;t<u.length;t++)if(g===u[t])return!1;return!0}function Y(){m();for(var g=[n,p,v,M,Ja,Sa,Ca,la],u=0;u<g.length;u++){var t=g[u]();if(!1!==t)return t}return e()}
var E=a,I=0,Ja=V("$",function(g,u){var t=vb(g);return!1===t?e():[6,t,u]}),Sa=V("%",function(g,u){var t=hb(u,function(C){return C},function(){return e()});return[7,g,t]}),Ca=function(g,u){return function(){if(b())return!1;var t=c();if(t!==g)return d(t),!1;t=n();if(!1===t||!x(t))return e();var C=t[2];if(!x(C))return e();var f=C[2];return x(f)&&A(f[2])?u(t[1],C[1],f[1]):e()}}("@",function(g,u,t){t=hb(t,function(C){return C},function(){return e()});g=vb(g);return!1===g?e():[8,g,u,t]}),la=V("^",function(g,
u){var t=hb(u,function(C){return C},function(){return e()});return[9,g,t]});return Y()}exports.simple_parse=yb;
exports.complex_parse=function(a){function b(){return Ca.length===la}function c(){!b()||k();var f=Ca[la];la++;return f}function d(f){Ca[la-1]===f||k();la--}function e(f){void 0===f&&(f="");throw"TheLanguage parse ERROR!"+f;}function l(f){return" "===f||"\n"===f||"\t"===f||"\r"===f}function m(){if(b())return!1;var f=c();if(!l(f))return d(f),!1;for(;l(f)&&!b();)f=c();l(f)||d(f);return!0}function p(){if(b())return!1;var f=c(),r="";if(!ca(f))return d(f),!1;for(;ca(f)&&!b();)r+=f,f=c();ca(f)?r+=f:d(f);
r in za||e("Not Symbol"+r);return[0,r]}function n(){function f(y){if(w===h)w=y;else{for(var Z=w;;){if(!x(Z))return k();if(Z[2]===h)break;Z=Z[2]}if(!x(Z)||Z[2]!==h)return k();Z[2]=y}}if(b())return!1;var r=c();if("("!==r)return d(r),!1;for(var h=[0,"!!@@READ||HOLE@@!!"],w=h;;){m();if(b())return e();r=c();if(")"===r)return f(z),w;if("."===r){m();r=Y();f(r);m();if(b())return e();r=c();return")"!==r?e():w}d(r);r=Y();f([1,r,h])}}function v(){if(b())return!1;var f=c();if("#"!==f)return d(f),!1;f=n();return!1!==
f&&x(f)?[3,f[1],f[2]]:e()}function M(){if(b())return!1;var f=c();if("!"!==f)return d(f),!1;f=n();return!1!==f&&x(f)?[4,f[1],f[2]]:e()}function V(f,r){return function(){if(b())return!1;var h=c();if(h!==f)return d(h),!1;h=n();if(!1===h||!x(h))return e();var w=h[2];return x(w)&&A(w[2])?r(h[1],w[1]):e()}}function ca(f){if(l(f))return!1;for(var r="()!#.$%^@~/->_:?[]&".split(""),h=0;h<r.length;h++)if(f===r[h])return!1;return!0}function Y(){m();for(var f=[n,Sa,v,M,g,u,t,C],r=0;r<f.length;r++){var h=f[r]();
if(!1!==h)return h}return e()}function E(f){return!1===f?e():f}function I(f){E(!b());E(c()===f)}function Ja(){function f(w){function y(){I("[");var zb=f();I("]");return zb}void 0===w&&(w=!1);w=w?[n,p,y,v,M,g,u,t,C]:[n,Ja,v,M,g,u,t,C];for(var Z=0;Z<w.length;Z++){var pb=w[Z]();if(!1!==pb)return pb}return e()}function r(w){if(b())return w;var y=c();if("."===y)return y=f(),O(N,O(J,O(w),L),y);if(":"===y)return y=f(),O(N,y,w);if("~"===y)return O(ra,w);if("@"===y)return y=f(),O(N,O(J,[1,w,L],L),y);if("?"===
y)return O(N,J,O(ra,w));if("/"===y){for(w=[w];;){y=f(!0);w.push(y);if(b())break;y=c();if("/"!==y){d(y);break}}return O(sa,Q(w))}d(y);return w}if(b())return!1;var h=c();if("&"===h){E(!b());h=c();if("+"===h)return h=f(),O(K,O(H,h));d(h);h=f();return O(K,h)}if(":"===h){E(!b());h=c();if("&"===h)return I(">"),h=f(),O(N,O(K,O(J,L,h)),pa);if(">"===h)return h=f(),O(N,O(J,L,h),pa);d(h);h=f();return O(N,h,pa)}if("+"===h)return h=f(),O(H,h);if("["===h)return h=f(),I("]"),r(h);if("_"===h)return I(":"),h=f(),
O(N,h,L);d(h);h=p();return!1===h?!1:r(h)}function Sa(){var f=Ja();return!1===f?!1:q(f)?f:P(f)}var Ca=a,la=0,g=V("$",function(f,r){var h=vb(f);return!1===h?e():[6,h,r]}),u=V("%",function(f,r){var h=hb(r,function(w){return w},function(){return e()});return[7,f,h]}),t=function(f,r){return function(){if(b())return!1;var h=c();if(h!==f)return d(h),!1;h=n();if(!1===h||!x(h))return e();var w=h[2];if(!x(w))return e();var y=w[2];return x(y)&&A(y[2])?r(h[1],w[1],y[1]):e()}}("@",function(f,r,h){h=hb(h,function(w){return w},
function(){return e()});f=vb(f);return!1===f?e():[8,f,r,h]}),C=V("^",function(f,r){var h=hb(r,function(w){return w},function(){return e()});return[9,f,h]});return Y()};
function X(a){function b(e,l){function m(V){return"inner"===l?"["+V+"]":"top"===l?V:k()}if(q(e))return e[1];var p=ib(e);if(!1!==p&&3===p.length&&W(p[0],N)){var n=ib(p[1]);if(!1!==n&&3===n.length&&W(n[0],J)){var v=n[1],M=ib(v);if(!1!==M&&1===M.length&&W(n[2],L))return m(b(M[0],"inner")+"."+b(p[2],"inner"));if(x(v)&&W(v[2],L)&&W(n[2],L))return m(b(v[1],"inner")+"@"+b(p[2],"inner"));if(W(v,L)&&W(p[2],pa))return m(":>"+b(n[2],"inner"))}v=ib(p[2]);if(W(p[1],J)&&!1!==v&&2===v.length&&W(v[0],ra))return m(b(v[1],
"inner")+"?");if(!1!==n&&2===n.length&&W(p[2],pa)&&W(n[0],K)&&(n=ib(n[1]),!1!==n&&3===n.length&&W(n[0],J)&&W(n[1],L)))return m(":&>"+b(n[2],"inner"));n=W(p[2],L)?"_":W(p[2],pa)?"":b(p[2],"inner");return m(n+":"+b(p[1],"inner"))}if(!1!==p&&2===p.length){if(W(p[0],K))return n=ib(p[1]),!1!==n&&2===n.length&&W(n[0],H)?m("&+"+b(n[1],"inner")):m("&"+b(p[1],"inner"));if(W(p[0],ra))return m(b(p[1],"inner")+"~");if(W(p[0],H))return m("+"+b(p[1],"inner"));if(W(p[0],sa)&&(p=ib(p[1]),!1!==p&&1<p.length)){n=b(p[0],
"inner");for(v=1;v<p.length;v++)n+="/"+b(p[v],"inner");return m(n)}}return"inner"===l?S(e):"top"===l?S(P(e)):k()}a=yb(S(a));var c="",d="";if(A(a))return"()";if(x(a)){c="(";for(d="";x(a);)c+=d+X(a[1]),d=" ",a=a[2];return c=A(a)?c+")":c+(" . "+X(a)+")")}return B(a)?(c=a[1],a=a[2],d=ib(a),!1!==d&&2===d.length&&W(c,oa)&&W(d[0],H)?b(d[1],"top"):"#"+X([1,c,a])):D(a)?"!"+X([1,a[1],a[2]]):q(a)?a[1]:6===a[0]?"$("+X(lb(a[1]))+" "+X(a[2])+")":7===a[0]?"%("+X(a[1])+" "+X(Q(a[2]))+")":8===a[0]?"@("+X(lb(a[1]))+
" "+X(a[2])+" "+X(Q(a[3]))+")":9===a[0]?"^("+X(a[1])+" "+X(Q(a[2]))+")":k()}exports.complex_print=X;
