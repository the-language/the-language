function ba(){var a={0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",A:"A",B:"B",C:"C",D:"D",E:"E",F:"F",G:"G",H:"H",I:"I",J:"J",K:"K",L:"L",M:"M",N:"N",O:"O",P:"P",Q:"Q",R:"R",S:"S",T:"T",U:"U",V:"V",W:"W",X:"X",Y:"Y",Z:"Z",a:"a",b:"b",c:"c",d:"d",e:"e",f:"f",g:"g",h:"h",i:"i",j:"j",k:"k",l:"l",m:"m",n:"n",o:"o",p:"p",q:"q",r:"r",s:"s",t:"t",u:"u",v:"v",w:"w",x:"x",y:"y",z:"z","\u4e00\u985e\u4f55\u7269":"\u3749","\u4e4b\u7269":"\ud86d\ude66","\u5176\u5b50":"\ud85a\udfaa","\u51fa\u5165\u6539\u6ec5":"\ud849\udc9f",
"\u5217\u5e8f":"\ud841\udf3a","\u5316\u6ec5":"\ud840\udfc1","\u53c3\u5f62":"\ud842\udef0","\u543e\u81ea":"\ud85a\udcf9","\u592a\u59cb\u521d\u6838":"\ud84d\udf57","\u5982\u82e5":"\ud85b\udc61","\u5b87\u5b99\u4ea1\u77e3":"\ud863\ude79","\u5c3e\u672b":"\ud847\udcb5","\u5e8f\u4e01":"\ud840\udda4","\u5e8f\u4e19":"\ud840\uddee","\u5e8f\u4e59":"\u3408","\u5e8f\u7532":"\ud840\uddda","\u5f0f\u5f62":"\u4f71","\u5f15\u7528":"\u39c8","\u61c9\u7528":"\ud853\udc06","\u6548\u61c9":"\u52b9","\u6620\u8868":"\ud850\udd54",
"\u662f\u975e":"\u6b24","\u69cb\u7269":"\ud845\udcab","\u70ba\u7b26\u540d\u9023":"\u2010","\u723b\u9670":"\u4f8c","\u723b\u967d":"\ud84c\udd84","\u7279\u5b9a\u5176\u7269":"\u4e93","\u7701\u7565\u4e00\u7269":"\u7567","\u7b26\u540d":"\u8b3c","\u7b49\u540c":"\u5f0c","\u89e3\u7b97":"\u7b6d","\u8a3b\u758f":"\u758e","\u8a5e\u7d20":"\ud85e\udd5d","\u8b2c\u8aa4":"\u4958","\u9023\u9838":"\u4e29","\u9593\u7a7a":"\ud84e\udcd3","\u9996\u59cb":"\ud866\udc10"};ba=function(){return a};return a}
function ca(){var a={0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",A:"A",B:"B",C:"C",D:"D",E:"E",F:"F",G:"G",H:"H",I:"I",J:"J",K:"K",L:"L",M:"M",N:"N",O:"O",P:"P",Q:"Q",R:"R",S:"S",T:"T",U:"U",V:"V",W:"W",X:"X",Y:"Y",Z:"Z",a:"a",b:"b",c:"c",d:"d",e:"e",f:"f",g:"g",h:"h",i:"i",j:"j",k:"k",l:"l",m:"m",n:"n",o:"o",p:"p",q:"q",r:"r",s:"s",t:"t",u:"u",v:"v",w:"w",x:"x",y:"y",z:"z","\u3749":"\u4e00\u985e\u4f55\u7269","\ud86d\ude66":"\u4e4b\u7269","\ud85a\udfaa":"\u5176\u5b50","\ud849\udc9f":"\u51fa\u5165\u6539\u6ec5",
"\ud841\udf3a":"\u5217\u5e8f","\ud840\udfc1":"\u5316\u6ec5","\ud842\udef0":"\u53c3\u5f62","\ud85a\udcf9":"\u543e\u81ea","\ud84d\udf57":"\u592a\u59cb\u521d\u6838","\ud85b\udc61":"\u5982\u82e5","\ud863\ude79":"\u5b87\u5b99\u4ea1\u77e3","\ud847\udcb5":"\u5c3e\u672b","\ud840\udda4":"\u5e8f\u4e01","\ud840\uddee":"\u5e8f\u4e19","\u3408":"\u5e8f\u4e59","\ud840\uddda":"\u5e8f\u7532","\u4f71":"\u5f0f\u5f62","\u39c8":"\u5f15\u7528","\ud853\udc06":"\u61c9\u7528","\u52b9":"\u6548\u61c9","\ud850\udd54":"\u6620\u8868",
"\u6b24":"\u662f\u975e","\ud845\udcab":"\u69cb\u7269","\u2010":"\u70ba\u7b26\u540d\u9023","\u4f8c":"\u723b\u9670","\ud84c\udd84":"\u723b\u967d","\u4e93":"\u7279\u5b9a\u5176\u7269","\u7567":"\u7701\u7565\u4e00\u7269","\u8b3c":"\u7b26\u540d","\u5f0c":"\u7b49\u540c","\u7b6d":"\u89e3\u7b97","\u758e":"\u8a3b\u758f","\ud85e\udd5d":"\u8a5e\u7d20","\u4958":"\u8b2c\u8aa4","\u4e29":"\u9023\u9838","\ud84e\udcd3":"\u9593\u7a7a","\ud866\udc10":"\u9996\u59cb"};ca=function(){return a};return a}
function n(){throw"TheLanguage PANIC";}function da(a,b){return[11,a,b]}exports.new_comment=da;function r(a){return 11===a[0]}exports.comment_p=r;exports.comment_comment=function(a){return a[1]};exports.comment_x=function(a){return a[2]};function ea(a){for(;r(a);)a=a[2];return a}exports.un_comment_all=ea;function u(a){return 0===a[0]}exports.symbol_p=u;function fa(a){return a in ba()}exports.can_new_symbol_p=fa;function v(a){return[0,ba()[a]]}exports.new_symbol=v;function ha(a){return ca()[a[1]]}
exports.un_symbol=ha;function ia(a,b){return[1,a,b]}exports.new_construction=ia;function w(a){return 1===a[0]}exports.construction_p=w;function ja(a){return a[1]}exports.construction_head=ja;function ka(a){return a[2]}exports.construction_tail=ka;var y=[2];exports.null_v=y;function z(a){return 2===a[0]}exports.null_p=z;function na(a,b){return[3,a,b]}exports.new_data=na;function A(a){return 3===a[0]}exports.data_p=A;function oa(a){return a[1]}exports.data_name=oa;function pa(a){return a[2]}
exports.data_list=pa;function sa(a,b){return[4,a,b]}exports.new_error=sa;function B(a){return 4===a[0]}exports.error_p=B;function ta(a){return a[1]}exports.error_name=ta;function ua(a){return a[2]}exports.error_list=ua;function va(a){return 5===a[0]}exports.just_p=va;exports.evaluate=function(a,b){return[6,a,b]};function wa(a){return a[2]}function C(a,b){return[7,a,b]}function xa(a,b){return[9,a,b]}exports.apply=xa;
function ya(a){a=D(a);if(A(a)||B(a)||w(a)||r(a))a[1]=ya(a[1]),a[2]=ya(a[2]);return a}exports.force_all_rec=ya;function za(a){var b=Aa(a);if(A(b)||B(b)||w(b))if(b[1]=ya(b[1]),b[2]=ya(b[2]),r(b[1])||r(b[2])){a=[10];Ba(a,b);var c=b[2];b=za(b[1]);c=za(c);a[1]=b;a[2]=c}else a=b;else a=b;return a}exports.force_uncomment_all_rec=za;function Ca(a,b){a!==b&&(a[0]=5,a[1]=b,a[2]=!1,a[3]=!1)}function Ba(a,b){10===a[0]||n();10!==b[0]||n();a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3]}
var E=v("\u592a\u59cb\u521d\u6838"),Da=v("\u7b26\u540d"),G=v("\u5316\u6ec5"),J=v("\u5f0f\u5f62"),Ea=v("\u7b49\u540c"),Fa=v("\u89e3\u7b97"),Ja=v("\u7279\u5b9a\u5176\u7269"),K=v("\u7701\u7565\u4e00\u7269"),Ka=v("\u6620\u8868"),La=v("\u5982\u82e5"),L=v("\u4e00\u985e\u4f55\u7269"),Ma=v("\u662f\u975e"),Na=v("\u5176\u5b50"),Oa=v("\u723b\u967d"),Pa=v("\u723b\u9670"),Qa=v("\u5f15\u7528"),Ra=v("\u61c9\u7528"),Sa=v("\u9593\u7a7a"),Ta=v("\u9023\u9838"),Ua=v("\u69cb\u7269"),Va=v("\u8b2c\u8aa4"),Wa=v("\u8a5e\u7d20"),
Xa=v("\u5217\u5e8f"),Ya=v("\u9996\u59cb"),Za=v("\u5c3e\u672b"),$a=v("\u4e4b\u7269"),ab=v("\u5b87\u5b99\u4ea1\u77e3"),bb=v("\u6548\u61c9"),cb=v("\u8a3b\u758f"),db=[4,E,N(ab,K)];function O(a){return[3,Da,[1,E,[1,a,y]]]}function eb(a){return O(N(L,N(G,K,a),Ja))}function fb(a,b){return O(N(L,N(G,N(a),K),b))}function gb(a){return O(N(L,G,N(Ma,N(L,a,K))))}
var jb=eb(Ua),kb=fb(Ua,Da),lb=fb(Ua,Xa),mb=gb(Ua),nb=eb(Va),ob=fb(Va,Da),pb=fb(Va,Xa),qb=gb(Va),rb=eb(Ta),sb=gb(Ta),tb=fb(Ta,Ya),ub=fb(Ta,Za),vb=gb(Wa),wb=gb(Sa),xb=O(N(L,G,N(Ma,Ea))),yb=O(N(L,N(G,[1,G,K],K),Ra)),zb=O(N(L,G,Fa)),Ab=fb(Xa,N(L,$a,K)),Bb=O(N(L,G,La)),Cb=O(N(L,J,Qa)),Db=O(N(L,N(J,N(G,K,G)),Ja)),Eb=O(N(J,N(E,G))),Fb=O(N(J,N(E,J))),Gb=O(N(J,J)),Hb=O(N(L,G,cb)),Ib=O(N(L,J,cb)),Jb=[3,Pa,N()],Kb=[3,Oa,N()];function Lb(a,b){return a===b?!0:a[1]===b[1]?(Ca(a,b),!0):!1}
function P(a){for(var b=y,c=a.length-1;0<=c;c--)b=[1,a[c],b];return b}exports.jsArray_to_list=P;function Mb(a,b,c){for(var d=[];w(a);)d.push(a[1]),a=a[2];return z(a)?b(d):c(d,a)}function Q(a){return Mb(a,function(b){return b},function(){return!1})}exports.maybe_list_to_jsArray=Q;function N(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return P(a)}exports.new_list=N;function Nb(a){if(!va(a))return a;for(var b=[];va(a);)b.push(a),a=a[1];for(var c=0;c<b.length;c++)Ca(b[c],a);return a}
exports.un_just_all=Nb;exports.un_just_comment_all=function(a){for(;va(a)||r(a);)a=Nb(ea(a));return a};function Ob(a){return 6===a[0]||8===a[0]||7===a[0]||9===a[0]}exports.delay_p=Ob;function R(a){return va(a)||Ob(a)}exports.delay_just_p=R;function Pb(a){if(6===a[0])return a;if(8===a[0])throw"WIP";if(7===a[0])throw"WIP";if(9===a[0])throw"WIP";return n()}exports.delay_env=function(a){return Pb(a)[1]};exports.delay_x=function(a){return Pb(a)[2]};
function D(a,b,c,d){function f(F){Ca(m,F);for(var H=0;H<d.length;H++)Ca(d[H],F);return F}function h(){c[1]=!0;return g(db)}function g(F){f(F);return R(F)?(d.push(m),D(F,b,[!1,!1],d)):F}function l(){var F={},H;for(H in k)F[H]=!0;for(H in b)F[H]=!0;return F}void 0===b&&(b={});void 0===c&&(c=[!1,!1]);void 0===d&&(d=[]);var k={},m=a;for(a=0;R(m)&&32>a;a++)d.push(m),m=U(m);for(;R(m);){a=V(m);if(!0===b[a])return h();if(!0===k[a]){c[0]=!0;if(6===m[0])return h();if(7===m[0]){a=m[1];for(var q=m[2],x=!1,W=
0,aa=[kb,lb,mb,ob,pb,qb,sb,tb,ub,vb,wb];W<aa.length;W++)if(X(aa[W],a)){x=!0;break}if(x)return 1===q.length||n(),!1===c[1]||n(),q=D(q[0],l(),c),c[1]?g(C(a,[q])):n();if(X(a,xb)||X(a,yb)||X(a,zb))return h();if(X(a,Bb)&&(3===q.length||n(),!1===c[1]||n(),a=D(q[0],l(),c),c[1]))return g(C(Bb,[a,q[1],q[2]]))}else if(8===m[0]||9===m[0])return h();return n()}k[a]=!0;d.push(m);m=U(m)}return f(m)}
function U(a){var b=Nb(a);!va(b)||n();a=6===b[0]?Qb(b[1],b[2],a):8===b[0]?Rb(b[1],b[2],b[3]):7===b[0]?Sb(b[1],b[2],a):9===b[0]?Tb(b[1],b[2],a):b;a=Nb(a);Ca(b,a);return a}exports.force1=U;exports.force_all=function(a){return D(a)};function Aa(a){for(;R(a)||r(a);)a=D(ea(a));return a}exports.force_uncomment_all=Aa;exports.force_uncomment1=function(a){return r(a)?a[2]:U(a)};var Ub=[];exports.env_null_v=Ub;
function Vb(a,b,c){for(var d=[],f=0;f<a.length;f+=2){if(X(a[f],b)){d[f]=b;d[f+1]=c;for(f+=2;f<a.length;f+=2)d[f]=a[f],d[f+1]=a[f+1];return d}d[f]=a[f];d[f+1]=a[f+1]}d[a.length]=b;d[a.length+1]=c;return d}exports.env_set=Vb;function Wb(a,b,c){for(var d=0;d<a.length;d+=2)if(X(a[d],b))return a[d+1];return c}exports.env_get=Wb;function Xb(a,b){for(var c=0;c<a.length;c+=2)if(X(a[c],b))return a[c+1];return n()}function Yb(a){for(var b=y,c=0;c<a.length;c+=2)b=[1,N(a[c],a[c+1]),b];return[3,Ka,N(b)]}
exports.env2val=Yb;function Zb(a,b){for(var c=0;c<a.length;c+=2)b(a[c],a[c+1])}exports.env_foreach=Zb;function $b(a){a=D(a);if(!A(a))return!1;var b=D(a[1]);if(!u(b)||!Lb(b,Ka))return!1;b=D(a[2]);if(!w(b)||!z(D(b[2])))return!1;a=[];for(b=D(b[1]);!z(b);){if(!w(b))return!1;var c=D(b[1]);b=D(b[2]);if(!w(c))return!1;var d=c[1];c=D(c[2]);if(!w(c))return!1;var f=c[1];if(!z(D(c[2])))return!1;c=!0;for(var h=0;h<a.length;h+=2)if(X(a[h],d)){a[h+1]=f;c=!1;break}c&&(a.push(d),a.push(f))}return a}
exports.val2env=$b;function ac(a,b,c,d){var f=[],h=[];a=Nb(a);for(var g=!0;;){if(z(a))return d(h,f);if(r(a))h.push(a[1]),a=a[2];else if(w(a))f.push(a[1]),a=a[2];else if(R(a))if(g)g=!1,a=U(a);else return c();else return b()}}
function Qb(a,b,c){function d(){return[4,E,N(Eb,N(zb,N(Yb(a),f)))]}var f=U(b);return R(f)?c:w(f)?ac(f,d,function(){return c},function(h,g){if(0!==h.length)throw"WIP";if(X(g[0],Fb)){if(1===g.length)return d();for(var l=g[1],k=[],m=2;m<g.length;m++)k.push(g[m]);return[8,a,l,k]}if(X(g[0],Gb)){if(1===g.length)return d();l=D([6,a,g[1]]);if(!A(l))return d();k=U(l[1]);if(R(k))return c;if(!u(k)||!Lb(k,J))return d();k=U(l[2]);if(R(k))return c;if(!w(k))return d();l=k[1];k=U(k[2]);if(R(k))return c;if(!z(k))return d();
k=[Yb(a)];for(m=2;m<g.length;m++)k.push(g[m]);return[9,l,k]}if(X(g[0],Eb)){if(1===g.length)return d();l=g[1];k=[];for(m=2;m<g.length;m++)k.push([6,a,g[m]]);return[7,l,k]}l=[6,a,g[0]];k=[];for(m=1;m<g.length;m++)k.push([6,a,g[m]]);return[9,l,k]}):z(f)?f:u(f)||A(f)?Wb(a,f,d()):B(f)?d():n()}function bc(a,b){return[a,1,function(c){c=U(c);return R(c)?C(a,[c]):b(c)?Kb:Jb}]}function cc(a,b,c){return[a,1,function(d,f){d=U(d);return R(d)?C(a,[d]):b(d)?c(d):f()}]}
var dc=[bc(mb,A),[jb,2,na],cc(kb,A,oa),cc(lb,A,pa),bc(qb,B),[nb,2,sa],cc(ob,B,ta),cc(pb,B,ua),bc(wb,z),[rb,2,ia],bc(sb,w),cc(tb,w,ja),cc(ub,w,ka),[xb,2,function(a,b){function c(d,f,h,g){h=C(xb,[h(d),h(f)]);d=C(xb,[g(d),g(f)]);return C(Bb,[h,d,Jb])}if(a===b)return Kb;a=U(a);b=U(b);if(R(a)||R(b))return C(xb,[a,b]);if(a===b)return Kb;!R(a)||n();return z(a)?z(a)?Kb:Jb:u(a)?u(b)?Lb(a,b)?Kb:Jb:Jb:A(a)?A(b)?c(a,b,oa,pa):Jb:w(a)?w(b)?c(a,b,ja,ka):Jb:B(a)?B(b)?c(a,b,ta,ua):Jb:n()}],[yb,2,function(a,b,c){var d=
[];for(b=D(b);w(b);)d.push(b[1]),b=D(b[2]);return z(b)?[9,a,d]:c()}],[zb,2,function(a,b,c){a=$b(a);return!1===a?c():[6,a,b]}],bc(vb,u),[Ab,1,function(a,b){a=U(a);return R(a)?C(Ab,[a]):w(a)?a[1]:b()}],[Bb,3,function(a,b,c,d){a=U(a);if(R(a))return C(Bb,[a,b,c]);if(!A(a))return d();a=D(a[1]);return u(a)?Lb(a,Oa)?b:Lb(a,Pa)?c:d():d()}],[Hb,2,da]];
function Tb(a,b,c){function d(){return[4,E,N(Eb,N(yb,N(a,P(b))))]}a=U(a);if(R(a))return c;if(!A(a))return d();c=D(a[1]);if(!u(c)||!Lb(c,G))return d();var f=D(a[2]);if(!w(f))return d();c=ya(f[1]);f=D(f[2]);if(!w(f)||!z(D(f[2])))return d();f=f[1];for(var h=Ub,g=0;!z(c);)if(u(c)||A(c)){for(var l=y,k=b.length-1;k>=g;k--)l=[1,b[k],l];h=Vb(h,c,l);g=b.length;c=y}else if(w(c))if(g<b.length)l=b[g],g++,h=Vb(h,c[1],l),c=c[2];else return d();else return d();return b.length!==g?d():[6,h,f]}
function Sb(a,b,c){function d(){return[4,E,N(Eb,N(a,P(b)))]}for(var f=0;f<dc.length;f++){var h=dc[f];if(X(a,h[0])){if(b.length!==h[1])break;return 1===h[1]?h[2](b[0],d,c):2===h[1]?h[2](b[0],b[1],d,c):3===h[1]?h[2](b[0],b[1],b[2],d,c):n()}}return d()}function Rb(a,b,c){function d(){return[4,E,N(Fb,N(Yb(a),b,P(c)))]}return X(b,Cb)?1!==c.length?d():c[0]:X(b,Db)?2!==c.length?d():ec(a,c[0],c[1],d):X(b,Ib)?2!==c.length?d():[11,c[0],[6,a,c[1]]]:d()}
function ec(a,b,c,d){b=ya(b);for(var f=[],h=!1,g=b;!z(g);)if(u(g)||A(g))f.push(g),h=!0,g=y;else if(w(g))f.push(g[1]),g=g[2];else return d();g=h?P(f):b;var l=[];Zb(a,function(k){for(var m=0;m<f.length;m++)if(X(f[m],k))return;l.push(k)});d=g;for(h=l.length-1;0<=h;h--)d=[1,l[h],d];for(h=l.length-1;0<=h;h--)g=ia(N(Fb,Cb,Xb(a,l[h])),g);return[3,G,N(b,[1,N(Fb,Cb,[3,G,N(d,c)]),g])]}
function X(a,b){function c(d,f,h,g){return X(h(d),h(f))&&X(g(d),g(f))?(Ca(d,f),!0):!1}if(a===b)return!0;a=D(a);b=D(b);if(a===b)return!0;if(z(a)){if(!z(b))return!1;Ca(a,y);Ca(b,y);return!0}return u(a)?u(b)?Lb(a,b):!1:w(a)?w(b)?c(a,b,ja,ka):!1:B(a)?B(b)?c(a,b,ta,ua):!1:A(a)?A(b)?c(a,b,oa,pa):!1:n()}exports.equal_p=X;
function Y(a,b){function c(){if(d.length!==f.length)return{value:!1};for(var g=[],l=[],k=[],m=[],q=0;q<d.length;q++)d[q]!==f[q]&&(fc(d[q],function(x){return g.push(x)},function(x){return k.push(x)}),fc(f[q],function(x){return l.push(x)},function(x){return m.push(x)}));if(g.length!==l.length)return{value:!1};for(q=0;q<g.length;q++)if(g[q]!==l[q])return{value:!1};d=k;f=m}if(a===b)return!0;for(var d=[a],f=[b];0!==d.length;){var h=c();if("object"===typeof h)return h.value}return 0===f.length}
function V(a){a=Nb(a);var b;if(z(a))return"()";if(w(a)){var c="(";for(b="";w(a);)c+=b+V(a[1]),b=" ",a=Nb(a[2]);return c=z(a)?c+")":c+(" . "+V(a)+")")}return A(a)?"#"+V([1,a[1],a[2]]):B(a)?"!"+V([1,a[1],a[2]]):u(a)?ha(a):r(a)?";("+V(a[1])+" "+V(a[2])+")":6===a[0]?"$("+V(Yb(a[1]))+" "+V(a[2])+")":7===a[0]?"%("+V(a[1])+" "+V(P(a[2]))+")":8===a[0]?"@("+V(Yb(a[1]))+" "+V(a[2])+" "+V(P(a[3]))+")":9===a[0]?"^("+V(a[1])+" "+V(P(a[2]))+")":n()}exports.simple_print=V;
function gc(a){function b(){return la.length===S}function c(){!b()||n();var e=la[S];S++;return e}function d(e){la[S-1]===e||n();S--}function f(e){void 0===e&&(e="");throw"TheLanguage parse ERROR!"+e;}function h(e){return" "===e||"\n"===e||"\t"===e||"\r"===e}function g(){if(b())return!1;var e=c();if(!h(e))return d(e),!1;for(;h(e)&&!b();)e=c();h(e)||d(e);return!0}function l(){if(b())return!1;var e=c(),p="";if(!W(e))return d(e),!1;for(;W(e)&&!b();)p+=e,e=c();W(e)?p+=e:d(e);return fa(p)?v(p):f("Not Symbol"+
p)}function k(){if(b())return!1;var e=c();if("("!==e)return d(e),!1;for(var p=[10],t=p;;){g();if(b())return f();e=c();if(")"===e)return Ba(p,y),t;if("."===e){g();e=aa();Ba(p,e);g();if(b())return f();e=c();return")"!==e?f():t}d(e);e=aa();var I=[10];Ba(p,[1,e,I]);p=I}}function m(){if(b())return!1;var e=c();if("#"!==e)return d(e),!1;e=k();return!1!==e&&w(e)?[3,e[1],e[2]]:f()}function q(){if(b())return!1;var e=c();if("!"!==e)return d(e),!1;e=k();return!1!==e&&w(e)?[4,e[1],e[2]]:f()}function x(e,p){return function(){if(b())return!1;
var t=c();if(t!==e)return d(t),!1;t=k();if(!1===t||!w(t))return f();var I=t[2];return w(I)&&z(I[2])?p(t[1],I[1]):f()}}function W(e){if(h(e))return!1;for(var p=0,t="()!#.$%^@~/->_:?[]&;".split("");p<t.length;p++)if(t[p]===e)return!1;return!0}function aa(){g();for(var e=0,p=[k,Ga,m,q,qa,ra,ma,hb,ib];e<p.length;e++){var t=(0,p[e])();if(!1!==t)return t}return f()}function F(e){return!1===e?f():e}function H(e){F(!b());F(c()===e)}function M(e){function p(){H("[");var Ha=M();H("]");return Ha}void 0===e&&
(e=!1);var t=0;for(e=e?[k,l,p,m,q,qa,ra,ma,hb,ib]:[k,Ia,m,q,qa,ra,ma,hb,ib];t<e.length;t++){var I=(0,e[t])();if(!1!==I)return I}return f()}function T(e){if(b())return e;var p=c();if("."===p)return p=M(),N(L,N(G,N(e),K),p);if(":"===p)return p=M(),N(L,p,e);if("~"===p)return N(Ma,e);if("@"===p)return p=M(),N(L,N(G,[1,e,K],K),p);if("?"===p)return N(L,G,N(Ma,e));if("/"===p){for(e=[e];;){p=M(!0);e.push(p);if(b())break;p=c();if("/"!==p){d(p);break}}return N(Na,P(e))}d(p);return e}function Ia(){if(b())return!1;
var e=c();if("&"===e){F(!b());e=c();if("+"===e)return e=M(),N(J,N(E,e));d(e);e=M();return N(J,e)}if(":"===e){F(!b());e=c();if("&"===e)return H(">"),e=M(),N(L,N(J,N(G,K,e)),Ja);if(">"===e)return e=M(),N(L,N(G,K,e),Ja);d(e);e=M();return N(L,e,Ja)}if("+"===e)return e=M(),N(E,e);if("["===e)return e=M(),H("]"),T(e);if("_"===e)return H(":"),e=M(),N(L,e,K);d(e);e=l();return!1===e?!1:T(e)}function Ga(){var e=Ia();return!1===e?!1:u(e)?e:O(e)}var la=a,S=0,qa=x("$",function(e,p){var t=$b(e);return!1===t?f():
[6,t,p]}),ra=x("%",function(e,p){var t=Mb(p,function(I){return I},function(){return f()});return[7,e,t]}),ma=function(e,p){return function(){if(b())return!1;var t=c();if(t!==e)return d(t),!1;t=k();if(!1===t||!w(t))return f();var I=t[2];if(!w(I))return f();var Ha=I[2];return w(Ha)&&z(Ha[2])?p(t[1],I[1],Ha[1]):f()}}("@",function(e,p,t){t=Mb(t,function(I){return I},function(){return f()});e=$b(e);return!1===e?f():[8,e,p,t]}),hb=x("^",function(e,p){var t=Mb(p,function(I){return I},function(){return f()});
return[9,e,t]}),ib=x(";",function(e,p){return[11,e,p]});return aa()}exports.complex_parse=gc;
function Z(a){function b(f,h){function g(x){return h?"["+x+"]":x}if(u(f))return ha(f);var l=Q(f);if(!1!==l&&3===l.length&&Y(l[0],L)){var k=Q(l[1]);if(!1!==k&&3===k.length&&Y(k[0],G)){var m=k[1],q=Q(m);if(!1!==q&&1===q.length&&Y(k[2],K))return g(b(q[0],!0)+"."+b(l[2],!0));if(w(m)&&Y(m[2],K)&&Y(k[2],K))return g(b(m[1],!0)+"@"+b(l[2],!0));if(Y(m,K)&&Y(l[2],Ja))return g(":>"+b(k[2],!0))}m=Q(l[2]);if(Y(l[1],G)&&!1!==m&&2===m.length&&Y(m[0],Ma))return g(b(m[1],!0)+"?");if(!1!==k&&2===k.length&&Y(l[2],Ja)&&
Y(k[0],J)&&(k=Q(k[1]),!1!==k&&3===k.length&&Y(k[0],G)&&Y(k[1],K)))return g(":&>"+b(k[2],!0));k=void 0;k=Y(l[2],K)?"_":Y(l[2],Ja)?"":b(l[2],!0);return g(k+":"+b(l[1],!0))}if(!1!==l&&2===l.length){if(Y(l[0],J))return k=Q(l[1]),!1!==k&&2===k.length&&Y(k[0],E)?g("&+"+b(k[1],!0)):g("&"+b(l[1],!0));if(Y(l[0],Ma))return g(b(l[1],!0)+"~");if(Y(l[0],E))return g("+"+b(l[1],!0));if(Y(l[0],Na)&&(l=Q(l[1]),!1!==l&&1<l.length)){k=b(l[0],!0);for(m=1;m<l.length;m++)k+="/"+b(l[m],!0);return g(k)}}return h?V(f):V(O(f))}
a=gc(V(a));var c="",d="";if(z(a))return"()";if(w(a)){c="(";for(d="";w(a);)c+=d+Z(a[1]),d=" ",a=a[2];return c=z(a)?c+")":c+(" . "+Z(a)+")")}return A(a)?(c=a[1],a=a[2],d=Q(a),!1!==d&&2===d.length&&Y(c,Da)&&Y(d[0],E)?b(d[1],!1):"#"+Z([1,c,a])):B(a)?"!"+Z([1,a[1],a[2]]):u(a)?ha(a):r(a)?";("+Z(a[1])+" "+Z(a[2])+")":6===a[0]?"$("+Z(Yb(a[1]))+" "+Z(a[2])+")":7===a[0]?"%("+Z(a[1])+" "+Z(P(a[2]))+")":8===a[0]?"@("+Z(Yb(a[1]))+" "+Z(a[2])+" "+Z(P(a[3]))+")":9===a[0]?"^("+Z(a[1])+" "+Z(P(a[2]))+")":n()}
exports.complex_print=Z;
exports.machinetext_parse=function(a){function b(){function q(H){function M(S){var qa=[10],ra=[10];x.push(function(ma){return Ba(qa,ma)});x.push(function(ma){return Ba(ra,ma)});H(S(qa,ra))}var T=f();if("^"===T){for(T="";;){var Ia=f();if("^"===Ia)break;T+=Ia}if(T in ca())H([0,T]);else return{value:c('can_new_symbol_unicodechar_p("'+T+'") == false')}}else if("."===T)M(ia);else if("#"===T)M(na);else if("!"===T)M(sa);else if("$"===T){var Ga=!1,la=!1;x.push(function(S){Ga=S});x.push(function(S){la=S});
k.push(function(){if(!1===Ga||!1===la)return n();var S=$b(Ga);if(!1===S)return c();H([6,S,la])})}else if("_"===T)H(y);else return{value:c()}}for(var x=[],W=0,aa=g;W<aa.length;W++){var F=q(aa[W]);if("object"===typeof F)return F}g=x}function c(q){void 0===q&&(q="");throw"MT parse ERROR "+q;}function d(q){if(!q)return c()}function f(){d(a.length>l);var q=a[l];l++;return q}for(var h=[10],g=[function(q){return Ba(h,q)}],l=0,k=[];0!==g.length;){var m=b();if("object"===typeof m)return m.value}d(l===a.length);
for(m=k.length-1;0<=m;m--)k[m]();return h};function fc(a,b,c){function d(f,h,g,l){b(h);c(g(f));return c(l(f))}a=Nb(a);u(a)?(b("^"),b(a[1]),b("^")):w(a)?d(a,".",ja,ka):z(a)?b("_"):A(a)?d(a,"#",oa,pa):B(a)?d(a,"!",ta,ua):Ob(a)?(a=Pb(a),d(a,"$",function(f){return Yb(f[1])},wa)):n()}function hc(a){for(var b=[],c=[],d=0;d<a.length;d++)fc(a[d],function(f){return b.push(f)},function(f){return c.push(f)});return[b,c]}
exports.machinetext_print=function(a){var b=[a];for(a="";0!==b.length;){var c=hc(b);b=c[1];var d=0;for(c=c[0];d<c.length;d++)a+=c[d]}return a};exports.Trampoline=function(){};function ic(a){return function(){return[!1,a]}}exports.trampoline_return=ic;function jc(a){return function(){return[!0,a()]}}exports.trampoline_delay=jc;function kc(a){for(a=a();a[0];)a=a[1]();return a[1]}exports.run_trampoline=kc;var lc=O([1,Na,[1,[1,bb,[1,[1,L,[1,$a,[1,K,y]]],y]],y]]);exports.return_effect_systemName=lc;
var mc=O([1,Na,[1,[1,bb,[1,Ta,y]],y]]);exports.bind_effect_systemName=mc;exports.new_effect_bind=function(a,b){return[3,mc,N(a,b)]};exports.new_effect_return=function(a){return[3,lc,a]};
function nc(a,b,c,d,f){void 0===f&&(f=!1);c=D(c);if(A(c)){var h=c[1],g=c[2];if(X(h,lc)){if(g=D(g),w(g)&&(h=g[1],g=D(g[2]),z(g))){if(!1===f){var l=h;h=function(){return a(l,d)}}else{var k=h;h=function(){return nc(a,b,[9,f,k],d)}}return jc(h)}}else if(X(h,mc)&&(g=D(g),w(g)&&(h=g[1],g=D(g[2]),w(g)))){var m=g[1];g=D(g[2]);if(z(g)){if(!1===f){var q=h;h=function(){return nc(a,b,q,d,m)}}else v("\u5e8f\u7532"),h=function(){throw"WIP";};return jc(h)}}}return!1===f?jc(function(){return b(c,d,a)}):jc(function(){return b(c,
d,function(x,W){return jc(function(){return nc(a,b,xa(f,[x]),W)})})})}exports.run_monad_trampoline=function(a,b,c,d){return nc(a,b,c,d)};exports.run_monad_stackoverflow=function(a,b,c,d){return kc(nc(function(f,h){return ic(a(f,h))},function(f,h,g){return ic(b(f,h,function(l,k){return kc(g(l,k))}))},c,d))};
