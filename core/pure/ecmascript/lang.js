function aa(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}function ba(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):{next:aa(a)}}function g(){throw"TheLanguage PANIC";}function ca(a,b){return[11,a,b]}exports.new_comment=ca;exports.comment_p=function(a){return 11===a[0]};exports.comment_comment=function(a){return a[1]};exports.comment_x=function(a){return a[2]};
var da={0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",A:"A",B:"B",C:"C",D:"D",E:"E",F:"F",G:"G",H:"H",I:"I",J:"J",K:"K",L:"L",M:"M",N:"N",O:"O",P:"P",Q:"Q",R:"R",S:"S",T:"T",U:"U",V:"V",W:"W",X:"X",Y:"Y",Z:"Z",a:"a",b:"b",c:"c",d:"d",e:"e",f:"f",g:"g",h:"h",i:"i",j:"j",k:"k",l:"l",m:"m",n:"n",o:"o",p:"p",q:"q",r:"r",s:"s",t:"t",u:"u",v:"v",w:"w",x:"x",y:"y",z:"z","\u4e00\u985e\u4f55\u7269":"\u3749","\u4e4b\u7269":"\ud86d\ude66","\u5176\u5b50":"\ud85a\udfaa","\u51fa\u5165\u6539\u6ec5":"\ud849\udc9f",
"\u5217\u5e8f":"\ud841\udf3a","\u5316\u6ec5":"\ud840\udfc1","\u53c3\u5f62":"\ud842\udef0","\u543e\u81ea":"\ud85a\udcf9","\u592a\u59cb\u521d\u6838":"\ud84d\udf57","\u5982\u82e5":"\ud85b\udc61","\u5b87\u5b99\u4ea1\u77e3":"\ud863\ude79","\u5c3e\u672b":"\ud847\udcb5","\u5e8f\u4e01":"\ud840\udda4","\u5e8f\u4e19":"\ud840\uddee","\u5e8f\u4e59":"\u3408","\u5e8f\u7532":"\ud840\uddda","\u5f0f\u5f62":"\u4f71","\u5f15\u7528":"\u39c8","\u61c9\u7528":"\ud853\udc06","\u6548\u61c9":"\u52b9","\u6620\u8868":"\ud850\udd54",
"\u662f\u975e":"\u6b24","\u69cb\u7269":"\ud845\udcab","\u70ba\u7b26\u540d\u9023":"\u2010","\u7279\u5b9a\u5176\u7269":"\u4e93","\u7701\u7565\u4e00\u7269":"\u7567","\u7b26\u540d":"\u8b3c","\u7b49\u540c":"\u5f0c","\u89e3\u7b97":"\u7b6d","\u8a3b\u758f":"\u758e","\u8a5e\u7d20":"\ud85e\udd5d","\u8b2c\u8aa4":"\u4958","\u9023\u9838":"\u4e29","\u9593\u7a7a":"\ud84e\udcd3","\u9670":"\u4f8c","\u967d":"\ud84c\udd84","\u9996\u59cb":"\ud866\udc10"},ea={0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",
A:"A",B:"B",C:"C",D:"D",E:"E",F:"F",G:"G",H:"H",I:"I",J:"J",K:"K",L:"L",M:"M",N:"N",O:"O",P:"P",Q:"Q",R:"R",S:"S",T:"T",U:"U",V:"V",W:"W",X:"X",Y:"Y",Z:"Z",a:"a",b:"b",c:"c",d:"d",e:"e",f:"f",g:"g",h:"h",i:"i",j:"j",k:"k",l:"l",m:"m",n:"n",o:"o",p:"p",q:"q",r:"r",s:"s",t:"t",u:"u",v:"v",w:"w",x:"x",y:"y",z:"z","\u3749":"\u4e00\u985e\u4f55\u7269","\ud86d\ude66":"\u4e4b\u7269","\ud85a\udfaa":"\u5176\u5b50","\ud849\udc9f":"\u51fa\u5165\u6539\u6ec5","\ud841\udf3a":"\u5217\u5e8f","\ud840\udfc1":"\u5316\u6ec5",
"\ud842\udef0":"\u53c3\u5f62","\ud85a\udcf9":"\u543e\u81ea","\ud84d\udf57":"\u592a\u59cb\u521d\u6838","\ud85b\udc61":"\u5982\u82e5","\ud863\ude79":"\u5b87\u5b99\u4ea1\u77e3","\ud847\udcb5":"\u5c3e\u672b","\ud840\udda4":"\u5e8f\u4e01","\ud840\uddee":"\u5e8f\u4e19","\u3408":"\u5e8f\u4e59","\ud840\uddda":"\u5e8f\u7532","\u4f71":"\u5f0f\u5f62","\u39c8":"\u5f15\u7528","\ud853\udc06":"\u61c9\u7528","\u52b9":"\u6548\u61c9","\ud850\udd54":"\u6620\u8868","\u6b24":"\u662f\u975e","\ud845\udcab":"\u69cb\u7269",
"\u2010":"\u70ba\u7b26\u540d\u9023","\u4e93":"\u7279\u5b9a\u5176\u7269","\u7567":"\u7701\u7565\u4e00\u7269","\u8b3c":"\u7b26\u540d","\u5f0c":"\u7b49\u540c","\u7b6d":"\u89e3\u7b97","\u758e":"\u8a3b\u758f","\ud85e\udd5d":"\u8a5e\u7d20","\u4958":"\u8b2c\u8aa4","\u4e29":"\u9023\u9838","\ud84e\udcd3":"\u9593\u7a7a","\u4f8c":"\u9670","\ud84c\udd84":"\u967d","\ud866\udc10":"\u9996\u59cb"};function q(a){return 0===a[0]}exports.symbol_p=q;function fa(a){return a in da}exports.can_new_symbol_p=fa;
function u(a){return[0,da[a]]}exports.new_symbol=u;function ha(a){return ea[a[1]]}exports.un_symbol=ha;function ia(a,b){return[1,a,b]}exports.new_construction=ia;function v(a){return 1===a[0]}exports.construction_p=v;function ja(a){return a[1]}exports.construction_head=ja;function ka(a){return a[2]}exports.construction_tail=ka;var w=[2];exports.null_v=w;function y(a){return 2===a[0]}exports.null_p=y;function la(a,b){return[3,a,b]}exports.new_data=la;function A(a){return 3===a[0]}exports.data_p=A;
function ma(a){return a[1]}exports.data_name=ma;function na(a){return a[2]}exports.data_list=na;function oa(a,b){return[4,a,b]}exports.new_error=oa;function B(a){return 4===a[0]}exports.error_p=B;function pa(a){return a[1]}exports.error_name=pa;function qa(a){return a[2]}exports.error_list=qa;function ra(a){return 5===a[0]}exports.just_p=ra;exports.evaluate=function(a,b){return[6,a,b]};function sa(a){return a[2]}function C(a,b){return[7,a,b]}exports.apply=function(a,b){return[9,a,b]};
function ta(a){a=D(a);if(A(a)||B(a)||v(a)){var b=ba(a);b.next();var c=b.next().value;b=b.next().value;a[1]=ta(c);a[2]=ta(b)}return a}exports.force_all_rec=ta;function E(a,b){a!==b&&(a[0]=5,a[1]=b,a[2]=!1,a[3]=!1)}function ua(a,b){10===a[0]||g();a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3]}
var F=u("\u592a\u59cb\u521d\u6838"),va=u("\u7b26\u540d"),H=u("\u5316\u6ec5"),I=u("\u5f0f\u5f62"),wa=u("\u7279\u5b9a\u5176\u7269"),K=u("\u7701\u7565\u4e00\u7269"),xa=u("\u6620\u8868"),L=u("\u4e00\u985e\u4f55\u7269"),ya=u("\u662f\u975e"),Aa=u("\u5176\u5b50"),Ba=u("\u967d"),Ca=u("\u9670"),Da=u("\u9023\u9838"),Ea=u("\u69cb\u7269"),Fa=u("\u8b2c\u8aa4"),Ga=u("\u5217\u5e8f"),Ha=u("\u8a3b\u758f"),Ia=[4,F,M(u("\u5b87\u5b99\u4ea1\u77e3"),K)];function O(a){return[3,va,[1,F,[1,a,w]]]}
function Ja(a){return O(M(L,M(H,K,a),wa))}function La(a,b){return O(M(L,M(H,M(a),K),b))}function Ma(a){return O(M(L,H,M(ya,M(L,a,K))))}
var Na=Ja(Ea),Oa=La(Ea,va),Pa=La(Ea,Ga),Qa=Ma(Ea),Ra=Ja(Fa),Sa=La(Fa,va),Ta=La(Fa,Ga),Ua=Ma(Fa),Va=Ja(Da),bb=Ma(Da),cb=La(Da,u("\u9996\u59cb")),db=La(Da,u("\u5c3e\u672b")),eb=Ma(u("\u8a5e\u7d20")),fb=Ma(u("\u9593\u7a7a")),gb=O(M(L,H,M(ya,u("\u7b49\u540c")))),hb=O(M(L,M(H,[1,H,K],K),u("\u61c9\u7528"))),ib=O(M(L,H,u("\u89e3\u7b97"))),jb=La(Ga,M(L,u("\u4e4b\u7269"),K)),kb=O(M(L,H,u("\u5982\u82e5"))),lb=O(M(L,I,u("\u5f15\u7528"))),mb=O(M(L,M(I,M(H,K,H)),wa)),nb=O(M(I,M(F,H))),ob=O(M(I,M(F,I))),pb=O(M(I,
I)),qb=O(M(L,H,Ha)),rb=O(M(L,I,Ha)),sb=[3,Ca,M()],tb=[3,Ba,M()];function ub(a,b){return a===b?!0:a[1]===b[1]?(E(a,b),!0):!1}function P(a){for(var b=w,c=a.length-1;0<=c;c--)b=[1,a[c],b];return b}exports.jsArray_to_list=P;function vb(a,b,c){for(var d=[];v(a);)d.push(a[1]),a=a[2];return y(a)?b(d):c(d,a)}function Q(a){return vb(a,function(b){return b},function(){return!1})}exports.maybe_list_to_jsArray=Q;function M(a){for(var b=[],c=0;c<arguments.length;++c)b[c]=arguments[c];return P(b)}
exports.new_list=M;function wb(a){for(var b=[];ra(a);)b.push(a),a=a[1];b=ba(b);for(var c=b.next();!c.done;c=b.next())E(c.value,a);return a}exports.un_just=wb;function xb(a){return 6===a[0]||8===a[0]||7===a[0]||9===a[0]}exports.delay_p=xb;function R(a){return ra(a)||xb(a)}exports.delay_just_p=R;function yb(a){if(6===a[0])return a;if(8===a[0])throw"WIP";if(7===a[0])throw"WIP";if(9===a[0])throw"WIP";return g()}exports.delay_env=function(a){return yb(a)[1]};exports.delay_x=function(a){return yb(a)[2]};
function D(a,b,c,d){function e(G){E(m,G);for(var N=0;N<d.length;N++)E(d[N],G);return G}function k(){c[1]=!0;return l(Ia)}function l(G){e(G);return R(G)?(d.push(m),D(G,b,[!1,!1],d)):G}function n(){var G={},N;for(N in p)G[N]=!0;for(var Ka in b)G[Ka]=!0;return G}b=void 0===b?{}:b;c=void 0===c?[!1,!1]:c;d=void 0===d?[]:d;var p={},m=a;for(a=0;R(m)&&32>a;a++)d.push(m),m=S(m);for(;R(m);){a=T(m);if(!0===b[a])return k();if(!0===p[a]){c[0]=!0;if(6===m[0])return k();if(7===m[0]){a=m[1];for(var x=m[2],J=!1,W=
ba([Oa,Pa,Qa,Sa,Ta,Ua,bb,cb,db,eb,fb]),Z=W.next();!Z.done;Z=W.next())if(U(Z.value,a)){J=!0;break}if(J)return 1===x.length||g(),!1===c[1]||g(),x=D(x[0],n(),c),c[1]?l(C(a,[x])):g();if(U(a,gb)||U(a,hb)||U(a,ib))return k();if(U(a,kb)&&(3===x.length||g(),!1===c[1]||g(),a=D(x[0],n(),c),c[1]))return l(C(kb,[a,x[1],x[2]]))}else if(8===m[0]||9===m[0])return k();return g()}p[a]=!0;d.push(m);m=S(m)}return e(m)}
function S(a){var b=wb(a);!ra(b)||g();if(6===b[0])a=Ab(b[1],b[2],a);else if(8===b[0]){a=b[1];var c=b[2],d=b[3],e=[4,F,M(ob,M(V(a),c,P(d)))];a=U(c,lb)?1!==d.length?e:d[0]:U(c,mb)?2!==d.length?e:Bb(a,d[0],d[1],e):U(c,rb)?2!==d.length?e:[11,d[0],[6,a,d[1]]]:e}else if(7===b[0])a:{e=b[1];a=b[2];c=[4,F,M(nb,M(e,P(a)))];for(d=0;d<Cb.length;d++)if(U(e,Cb[d][0])){e=Cb[d][1];if(a.length!==e)break;d=Cb[d][2];a=1===e?d(a[0],c):2===e?d(a[0],a[1],c):3===e?d(a[0],a[1],a[2],c):g();break a}a=c}else a=9===b[0]?Db(b[1],
b[2],a):b;a=wb(a);E(b,a);return a}exports.force1=S;exports.force_all=function(a){return D(a)};var Eb=[];exports.env_null_v=Eb;function Fb(a,b,c){for(var d=[],e=0;e<a.length;e+=2){if(U(a[e],b)){d[e]=b;d[e+1]=c;for(e+=2;e<a.length;e+=2)d[e]=a[e],d[e+1]=a[e+1];return d}d[e]=a[e];d[e+1]=a[e+1]}d[a.length]=b;d[a.length+1]=c;return d}exports.env_set=Fb;function Gb(a,b,c){for(var d=0;d<a.length;d+=2)if(U(a[d],b))return a[d+1];return c}exports.env_get=Gb;
function Hb(a,b){for(var c=0;c<a.length;c+=2)if(U(a[c],b))return a[c+1];return g()}function V(a){for(var b=w,c=0;c<a.length;c+=2)b=[1,M(a[c],a[c+1]),b];return[3,xa,M(b)]}exports.env2val=V;function Ib(a,b){for(var c=0;c<a.length;c+=2)b(a[c],a[c+1])}exports.env_foreach=Ib;
function Jb(a){a=D(a);if(!A(a))return!1;var b=D(a[1]);if(!q(b)||!ub(b,xa))return!1;b=D(a[2]);if(!v(b)||!y(D(b[2])))return!1;a=[];for(b=D(b[1]);!y(b);){if(!v(b))return!1;var c=D(b[1]);b=D(b[2]);if(!v(c))return!1;var d=c[1];c=D(c[2]);if(!v(c))return!1;var e=c[1];if(!y(D(c[2])))return!1;c=!0;for(var k=0;k<a.length;k+=2)if(U(a[k],d)){a[k+1]=e;c=!1;break}c&&(a.push(d),a.push(e))}return a}exports.val2env=Jb;
function Ab(a,b,c){var d=S(b);if(R(d))return c;var e=[4,F,M(nb,M(ib,M(V(a),d)))];if(v(d)){for(b=[];!y(d);){if(R(d))return c;if(v(d))b.push(d[1]),d=S(d[2]);else return e}if(U(b[0],ob)){if(1===b.length)return e;c=b[1];e=[];for(d=2;d<b.length;d++)e.push(b[d]);return[8,a,c,e]}if(U(b[0],pb)){if(1===b.length)return e;d=D([6,a,b[1]]);if(!A(d))return e;var k=S(d[1]);if(R(k))return c;if(!q(k)||!ub(k,I))return e;k=S(d[2]);if(R(k))return c;if(!v(k))return e;d=k[1];k=S(k[2]);if(R(k))return c;if(!y(k))return e;
a=[V(a)];for(c=2;c<b.length;c++)a.push(b[c]);return[9,d,a]}if(U(b[0],nb)){if(1===b.length)return e;c=b[1];e=[];for(d=2;d<b.length;d++)e.push([6,a,b[d]]);return[7,c,e]}c=[6,a,b[0]];e=[];for(d=1;d<b.length;d++)e.push([6,a,b[d]]);return[9,c,e]}return y(d)?d:q(d)||A(d)?Gb(a,d,e):B(d)?e:g()}function Kb(a,b){return[a,1,function(c){c=S(c);return R(c)?C(a,[c]):b(c)?tb:sb}]}function Lb(a,b,c){return[a,1,function(d,e){d=S(d);return R(d)?C(a,[d]):b(d)?c(d):e}]}
var Cb=[Kb(Qa,A),[Na,2,la],Lb(Oa,A,ma),Lb(Pa,A,na),Kb(Ua,B),[Ra,2,oa],Lb(Sa,B,pa),Lb(Ta,B,qa),Kb(fb,y),[Va,2,ia],Kb(bb,v),Lb(cb,v,ja),Lb(db,v,ka),[gb,2,function(a,b){function c(d,e,k,l){k=C(gb,[k(d),k(e)]);d=C(gb,[l(d),l(e)]);return C(kb,[k,d,sb])}if(a===b)return tb;a=S(a);b=S(b);if(R(a)||R(b))return C(gb,[a,b]);if(a===b)return tb;!R(a)||g();return y(a)?y(a)?tb:sb:q(a)?q(b)?ub(a,b)?tb:sb:sb:A(a)?A(b)?c(a,b,ma,na):sb:v(a)?v(b)?c(a,b,ja,ka):sb:B(a)?B(b)?c(a,b,pa,qa):sb:g()}],[hb,2,function(a,b,c){var d=
[];for(b=D(b);v(b);)d.push(b[1]),b=D(b[2]);return y(b)?[9,a,d]:c}],[ib,2,function(a,b,c){a=Jb(a);return!1===a?c:[6,a,b]}],Kb(eb,q),[jb,1,function(a,b){a=S(a);return R(a)?C(jb,[a]):v(a)?a[1]:b}],[kb,3,function(a,b,c,d){a=S(a);if(R(a))return C(kb,[a,b,c]);if(!A(a))return d;a=D(a[1]);return q(a)?ub(a,Ba)?b:ub(a,Ca)?c:d:d}],[qb,2,ca]];
function Db(a,b,c){function d(){return[4,F,M(nb,M(hb,M(a,P(b))))]}a=S(a);if(R(a))return c;if(!A(a))return d();c=D(a[1]);if(!q(c)||!ub(c,H))return d();var e=D(a[2]);if(!v(e))return d();c=ta(e[1]);e=D(e[2]);if(!v(e)||!y(D(e[2])))return d();e=e[1];for(var k=Eb,l=0;!y(c);)if(q(c)||A(c)){for(var n=w,p=b.length-1;p>=l;p--)n=[1,b[p],n];k=Fb(k,c,n);l=b.length;c=w}else if(v(c))if(l<b.length)n=b[l],l++,k=Fb(k,c[1],n),c=c[2];else return d();else return d();return b.length!==l?d():[6,k,e]}
function Bb(a,b,c,d){d=void 0===d?!1:d;b=ta(b);for(var e=[],k=!1,l=b;!y(l);)if(q(l)||A(l))e.push(l),k=!0,l=w;else if(v(l))e.push(l[1]),l=l[2];else return!1===d?oa(F,M(ob,M(V(a),mb,P([b,c])))):d;d=b;k&&(d=P(e));var n=[];Ib(a,function(p){for(var m=0;m<e.length;m++)if(U(e[m],p))return;n.push(p)});k=d;for(l=n.length-1;0<=l;l--)k=[1,n[l],k];for(l=n.length-1;0<=l;l--)d=ia(M(ob,lb,Hb(a,n[l])),d);return[3,H,M(b,[1,M(ob,lb,[3,H,M(k,c)]),d])]}
function U(a,b){function c(d,e,k,l){return U(k(d),k(e))&&U(l(d),l(e))?(E(d,e),!0):!1}if(a===b)return!0;a=D(a);b=D(b);if(a===b)return!0;if(y(a)){if(!y(b))return!1;E(a,w);E(b,w);return!0}return q(a)?q(b)?ub(a,b):!1:v(a)?v(b)?c(a,b,ja,ka):!1:B(a)?B(b)?c(a,b,pa,qa):!1:A(a)?A(b)?c(a,b,ma,na):!1:g()}exports.equal_p=U;
function X(a,b){function c(d,e,k,l){return X(k(d),k(e))&&X(l(d),l(e))?(E(d,e),!0):!1}if(a===b)return!0;a=wb(a);b=wb(b);if(a===b)return!0;if(y(a)){if(!y(b))return!1;E(a,w);E(b,w);return!0}if(q(a))return q(b)?ub(a,b):!1;if(v(a))return v(b)?c(a,b,ja,ka):!1;if(B(a))return B(b)?c(a,b,pa,qa):!1;if(A(a))return A(b)?c(a,b,ma,na):!1;if(6===a[0])throw"WIP";if(7===a[0])throw"WIP";if(8===a[0])throw"WIP";if(9===a[0])throw"WIP";return g()}
function T(a){a=wb(a);var b;if(y(a))return"()";if(v(a)){var c="(";for(b="";v(a);)c+=b+T(a[1]),b=" ",a=wb(a[2]);return c=y(a)?c+")":c+(" . "+T(a)+")")}return A(a)?"#"+T([1,a[1],a[2]]):B(a)?"!"+T([1,a[1],a[2]]):q(a)?ha(a):6===a[0]?"$("+T(V(a[1]))+" "+T(a[2])+")":7===a[0]?"%("+T(a[1])+" "+T(P(a[2]))+")":8===a[0]?"@("+T(V(a[1]))+" "+T(a[2])+" "+T(P(a[3]))+")":9===a[0]?"^("+T(a[1])+" "+T(P(a[2]))+")":g()}exports.simple_print=T;exports.simple_print_force_all_rec=function(a){return T(ta(a))};
function Mb(a){function b(){return Wa.length===za}function c(){!b()||g();var f=Wa[za];za++;return f}function d(f){Wa[za-1]===f||g();za--}function e(f){throw"TheLanguage parse ERROR!"+(void 0===f?"":f);}function k(f){return" "===f||"\n"===f||"\t"===f||"\r"===f}function l(){if(b())return!1;var f=c();if(!k(f))return d(f),!1;for(;k(f)&&!b();)f=c();k(f)||d(f);return!0}function n(){if(b())return!1;var f=c(),t="";if(!W(f))return d(f),!1;for(;W(f)&&!b();)t+=f,f=c();W(f)?t+=f:d(f);return fa(t)?u(t):e("Not Symbol"+
t)}function p(){if(b())return!1;var f=c();if("("!==f)return d(f),!1;for(var t=[10],h=t;;){l();if(b())return e();f=c();if(")"===f)return ua(t,w),h;if("."===f){l();f=Z();ua(t,f);l();if(b())return e();f=c();return")"!==f?e():h}d(f);f=Z();var r=[10];ua(t,[1,f,r]);t=r}}function m(){if(b())return!1;var f=c();if("#"!==f)return d(f),!1;f=p();return!1!==f&&v(f)?[3,f[1],f[2]]:e()}function x(){if(b())return!1;var f=c();if("!"!==f)return d(f),!1;f=p();return!1!==f&&v(f)?[4,f[1],f[2]]:e()}function J(f,t){return function(){if(b())return!1;
var h=c();if(h!==f)return d(h),!1;h=p();if(!1===h||!v(h))return e();var r=h[2];return v(r)&&y(r[2])?t(h[1],r[1]):e()}}function W(f){if(k(f))return!1;for(var t="()!#.$%^@~/->_:?[]&".split(""),h=0;h<t.length;h++)if(f===t[h])return!1;return!0}function Z(){l();for(var f=[p,Nb,m,x,Xa,Ya,Za,$a],t=0;t<f.length;t++){var h=f[t]();if(!1!==h)return h}return e()}function G(f){return!1===f?e():f}function N(f){G(!b());G(c()===f)}function Ka(){function f(r){function z(){N("[");var Ob=f();N("]");return Ob}r=(void 0===
r?0:r)?[p,n,z,m,x,Xa,Ya,Za,$a]:[p,Ka,m,x,Xa,Ya,Za,$a];for(var ab=0;ab<r.length;ab++){var zb=r[ab]();if(!1!==zb)return zb}return e()}function t(r){if(b())return r;var z=c();if("."===z)return z=f(),M(L,M(H,M(r),K),z);if(":"===z)return z=f(),M(L,z,r);if("~"===z)return M(ya,r);if("@"===z)return z=f(),M(L,M(H,[1,r,K],K),z);if("?"===z)return M(L,H,M(ya,r));if("/"===z){for(r=[r];;){z=f(!0);r.push(z);if(b())break;z=c();if("/"!==z){d(z);break}}return M(Aa,P(r))}d(z);return r}if(b())return!1;var h=c();if("&"===
h){G(!b());h=c();if("+"===h)return h=f(),M(I,M(F,h));d(h);h=f();return M(I,h)}if(":"===h){G(!b());h=c();if("&"===h)return N(">"),h=f(),M(L,M(I,M(H,K,h)),wa);if(">"===h)return h=f(),M(L,M(H,K,h),wa);d(h);h=f();return M(L,h,wa)}if("+"===h)return h=f(),M(F,h);if("["===h)return h=f(),N("]"),t(h);if("_"===h)return N(":"),h=f(),M(L,h,K);d(h);h=n();return!1===h?!1:t(h)}function Nb(){var f=Ka();return!1===f?!1:q(f)?f:O(f)}var Wa=a,za=0,Xa=J("$",function(f,t){var h=Jb(f);return!1===h?e():[6,h,t]}),Ya=J("%",
function(f,t){var h=vb(t,function(r){return r},function(){return e()});return[7,f,h]}),Za=function(f,t){return function(){if(b())return!1;var h=c();if(h!==f)return d(h),!1;h=p();if(!1===h||!v(h))return e();var r=h[2];if(!v(r))return e();var z=r[2];return v(z)&&y(z[2])?t(h[1],r[1],z[1]):e()}}("@",function(f,t,h){h=vb(h,function(r){return r},function(){return e()});f=Jb(f);return!1===f?e():[8,f,t,h]}),$a=J("^",function(f,t){var h=vb(t,function(r){return r},function(){return e()});return[9,f,h]});return Z()}
exports.complex_parse=Mb;
function Y(a){function b(e,k){function l(J){return"inner"===k?"["+J+"]":"top"===k?J:g()}if(q(e))return ha(e);var n=Q(e);if(!1!==n&&3===n.length&&X(n[0],L)){var p=Q(n[1]);if(!1!==p&&3===p.length&&X(p[0],H)){var m=p[1],x=Q(m);if(!1!==x&&1===x.length&&X(p[2],K))return l(b(x[0],"inner")+"."+b(n[2],"inner"));if(v(m)&&X(m[2],K)&&X(p[2],K))return l(b(m[1],"inner")+"@"+b(n[2],"inner"));if(X(m,K)&&X(n[2],wa))return l(":>"+b(p[2],"inner"))}m=Q(n[2]);if(X(n[1],H)&&!1!==m&&2===m.length&&X(m[0],ya))return l(b(m[1],
"inner")+"?");if(!1!==p&&2===p.length&&X(n[2],wa)&&X(p[0],I)&&(p=Q(p[1]),!1!==p&&3===p.length&&X(p[0],H)&&X(p[1],K)))return l(":&>"+b(p[2],"inner"));p=X(n[2],K)?"_":X(n[2],wa)?"":b(n[2],"inner");return l(p+":"+b(n[1],"inner"))}if(!1!==n&&2===n.length){if(X(n[0],I))return p=Q(n[1]),!1!==p&&2===p.length&&X(p[0],F)?l("&+"+b(p[1],"inner")):l("&"+b(n[1],"inner"));if(X(n[0],ya))return l(b(n[1],"inner")+"~");if(X(n[0],F))return l("+"+b(n[1],"inner"));if(X(n[0],Aa)&&(n=Q(n[1]),!1!==n&&1<n.length)){p=b(n[0],
"inner");for(m=1;m<n.length;m++)p+="/"+b(n[m],"inner");return l(p)}}return"inner"===k?T(e):"top"===k?T(O(e)):g()}a=Mb(T(a));var c="",d="";if(y(a))return"()";if(v(a)){c="(";for(d="";v(a);)c+=d+Y(a[1]),d=" ",a=a[2];return c=y(a)?c+")":c+(" . "+Y(a)+")")}return A(a)?(c=a[1],a=a[2],d=Q(a),!1!==d&&2===d.length&&X(c,va)&&X(d[0],F)?b(d[1],"top"):"#"+Y([1,c,a])):B(a)?"!"+Y([1,a[1],a[2]]):q(a)?ha(a):6===a[0]?"$("+Y(V(a[1]))+" "+Y(a[2])+")":7===a[0]?"%("+Y(a[1])+" "+Y(P(a[2]))+")":8===a[0]?"@("+Y(V(a[1]))+
" "+Y(a[2])+" "+Y(P(a[3]))+")":9===a[0]?"^("+Y(a[1])+" "+Y(P(a[2]))+")":g()}exports.complex_print=Y;
exports.machinetext_parse=function(a){function b(){throw"MT parse ERROR";}function c(J){if(!J)return b()}function d(){c(a.length>l);var J=a[l];l++;return J}for(var e=[10],k=[e],l=0,n={};0!==k.length;){n.aa=[];var p={};k=ba(k);for(var m=k.next();!m.done;p={$:p.$},m=k.next()){p.$=m.value;m=d();var x=function(J,W){return function(Z){var G=[10],N=[10];J.aa.push(G);J.aa.push(N);ua(W.$,Z(G,N))}}(n,p);if("^"===m){for(m="";;){x=d();if("^"===x)break;m+=x}if(m in ea)ua(p.$,[0,m]);else return b()}else if("."===
m)x(ia);else if("#"===m)x(la);else if("!"===m)x(oa);else if("$"===m)x(function(J,W){return[6,Eb,M(nb,ib,M(ob,lb,J),M(ob,lb,W))]});else if("_"===m)ua(p.$,w);else return b()}k=n.aa;n={aa:n.aa}}c(l==a.length);return e};
exports.machinetext_print=function(a){var b=[a],c="";for(a={};0!==b.length;){a.ba=[];b=ba(b);for(var d=b.next();!d.done;d=b.next()){var e=d.value;e=wb(e);d=function(k){return function(l,n,p,m){c+=n;k.ba.push(p(l));k.ba.push(m(l))}}(a);if(q(e))c+="^",c+=e[1],c+="^";else if(v(e))d(e,".",ja,ka);else if(y(e))c+="_";else if(A(e))d(e,"#",ma,na);else if(B(e))d(e,"!",pa,qa);else if(xb(e))e=yb(e),d(e,"$",function(k){return V(k[1])},sa);else return g()}b=a.ba;a={ba:a.ba}}return c};var Pb=Mb("\u6548\u61c9/[:\u4e4b\u7269]");
exports.return_effect_systemName=Pb;var Qb=Mb("\u6548\u61c9/\u9023\u9838");exports.bind_effect_systemName=Qb;exports.run_effect_helper=function(){throw"WIP";};
