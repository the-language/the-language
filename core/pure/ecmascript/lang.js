function l(){throw"TheLanguage PANIC";}
function aa(){var a={0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",A:"A",B:"B",C:"C",D:"D",E:"E",F:"F",G:"G",H:"H",I:"I",J:"J",K:"K",L:"L",M:"M",N:"N",O:"O",P:"P",Q:"Q",R:"R",S:"S",T:"T",U:"U",V:"V",W:"W",X:"X",Y:"Y",Z:"Z",a:"a",b:"b",c:"c",d:"d",e:"e",f:"f",g:"g",h:"h",i:"i",j:"j",k:"k",l:"l",m:"m",n:"n",o:"o",p:"p",q:"q",r:"r",s:"s",t:"t",u:"u",v:"v",w:"w",x:"x",y:"y",z:"z","\u4e00\u985e\u4f55\u7269":"\u3749","\u4e4b\u7269":"\ud86d\ude66","\u5176\u5b50":"\ud85a\udfaa","\u51fa\u5165\u6539\u6ec5":"\ud849\udc9f",
"\u5217\u5e8f":"\ud841\udf3a","\u5316\u6ec5":"\ud840\udfc1","\u53c3\u5f62":"\ud842\udef0","\u543e\u81ea":"\ud85a\udcf9","\u592a\u59cb\u521d\u6838":"\ud84d\udf57","\u5982\u82e5":"\ud85b\udc61","\u5b87\u5b99\u4ea1\u77e3":"\ud863\ude79","\u5c3e\u672b":"\ud847\udcb5","\u5e8f\u4e01":"\ud840\udda4","\u5e8f\u4e19":"\ud840\uddee","\u5e8f\u4e59":"\u3408","\u5e8f\u7532":"\ud840\uddda","\u5f0f\u5f62":"\u4f71","\u5f15\u7528":"\u39c8","\u61c9\u7528":"\ud853\udc06","\u6548\u61c9":"\u52b9","\u6620\u8868":"\ud850\udd54",
"\u662f\u975e":"\u6b24","\u69cb\u7269":"\ud845\udcab","\u70ba\u7b26\u540d\u9023":"\u2010","\u723b\u9670":"\u4f8c","\u723b\u967d":"\ud84c\udd84","\u7279\u5b9a\u5176\u7269":"\u4e93","\u7701\u7565\u4e00\u7269":"\u7567","\u7b26\u540d":"\u8b3c","\u7b49\u540c":"\u5f0c","\u89e3\u7b97":"\u7b6d","\u8a3b\u758f":"\u758e","\u8a5e\u7d20":"\ud85e\udd5d","\u8b2c\u8aa4":"\u4958","\u9023\u9838":"\u4e29","\u9593\u7a7a":"\ud84e\udcd3","\u9996\u59cb":"\ud866\udc10"};aa=function(){return a};return a}
function da(){var a={0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",A:"A",B:"B",C:"C",D:"D",E:"E",F:"F",G:"G",H:"H",I:"I",J:"J",K:"K",L:"L",M:"M",N:"N",O:"O",P:"P",Q:"Q",R:"R",S:"S",T:"T",U:"U",V:"V",W:"W",X:"X",Y:"Y",Z:"Z",a:"a",b:"b",c:"c",d:"d",e:"e",f:"f",g:"g",h:"h",i:"i",j:"j",k:"k",l:"l",m:"m",n:"n",o:"o",p:"p",q:"q",r:"r",s:"s",t:"t",u:"u",v:"v",w:"w",x:"x",y:"y",z:"z","\u3749":"\u4e00\u985e\u4f55\u7269","\ud86d\ude66":"\u4e4b\u7269","\ud85a\udfaa":"\u5176\u5b50","\ud849\udc9f":"\u51fa\u5165\u6539\u6ec5",
"\ud841\udf3a":"\u5217\u5e8f","\ud840\udfc1":"\u5316\u6ec5","\ud842\udef0":"\u53c3\u5f62","\ud85a\udcf9":"\u543e\u81ea","\ud84d\udf57":"\u592a\u59cb\u521d\u6838","\ud85b\udc61":"\u5982\u82e5","\ud863\ude79":"\u5b87\u5b99\u4ea1\u77e3","\ud847\udcb5":"\u5c3e\u672b","\ud840\udda4":"\u5e8f\u4e01","\ud840\uddee":"\u5e8f\u4e19","\u3408":"\u5e8f\u4e59","\ud840\uddda":"\u5e8f\u7532","\u4f71":"\u5f0f\u5f62","\u39c8":"\u5f15\u7528","\ud853\udc06":"\u61c9\u7528","\u52b9":"\u6548\u61c9","\ud850\udd54":"\u6620\u8868",
"\u6b24":"\u662f\u975e","\ud845\udcab":"\u69cb\u7269","\u2010":"\u70ba\u7b26\u540d\u9023","\u4f8c":"\u723b\u9670","\ud84c\udd84":"\u723b\u967d","\u4e93":"\u7279\u5b9a\u5176\u7269","\u7567":"\u7701\u7565\u4e00\u7269","\u8b3c":"\u7b26\u540d","\u5f0c":"\u7b49\u540c","\u7b6d":"\u89e3\u7b97","\u758e":"\u8a3b\u758f","\ud85e\udd5d":"\u8a5e\u7d20","\u4958":"\u8b2c\u8aa4","\u4e29":"\u9023\u9838","\ud84e\udcd3":"\u9593\u7a7a","\ud866\udc10":"\u9996\u59cb"};da=function(){return a};return a}
function ea(a,b){return[11,a,b]}exports.new_comment=ea;function q(a){return 11===a[0]}exports.comment_p=q;exports.comment_comment=function(a){return a[1]};exports.comment_x=function(a){return a[2]};function fa(a){for(;q(a);)a=a[2];return a}exports.un_comment_all=fa;function t(a){return 0===a[0]}exports.symbol_p=t;function ha(a){return a in aa()}exports.can_new_symbol_p=ha;function u(a){return[0,aa()[a]]}exports.new_symbol=u;function ia(a){return da()[a[1]]}exports.un_symbol=ia;
function ka(a,b){return[1,a,b]}exports.new_construction=ka;function v(a){return 1===a[0]}exports.construction_p=v;function ma(a){return a[1]}exports.construction_head=ma;function na(a){return a[2]}exports.construction_tail=na;var x=[2];exports.null_v=x;function z(a){return 2===a[0]}exports.null_p=z;function oa(a,b){return[3,a,b]}exports.new_data=oa;function A(a){return 3===a[0]}exports.data_p=A;function pa(a){return a[1]}exports.data_name=pa;function qa(a){return a[2]}exports.data_list=qa;
function ra(a,b){return[4,a,b]}exports.new_error=ra;function B(a){return 4===a[0]}exports.error_p=B;function sa(a){return a[1]}exports.error_name=sa;function ta(a){return a[2]}exports.error_list=ta;function ua(a){return 5===a[0]}exports.just_p=ua;exports.evaluate=function(a,b){return[6,a,b]};function wa(a){return a[2]}function D(a,b){return[7,a,b]}function xa(a,b){return[9,a,b]}exports.apply=xa;function ya(a){a=E(a);if(A(a)||B(a)||v(a)||q(a))a[1]=ya(a[1]),a[2]=ya(a[2]);return a}
exports.force_all_rec=ya;function za(a){var b=Aa(a);if(A(b)||B(b)||v(b))if(b[1]=ya(b[1]),b[2]=ya(b[2]),q(b[1])||q(b[2])){a=[10];Ba(a,b);var c=b[2];b=za(b[1]);c=za(c);a[1]=b;a[2]=c}else a=b;else a=b;return a}exports.force_uncomment_all_rec=za;function F(a,b){a!==b&&(a[0]=5,a[1]=b,a[2]=!1,a[3]=!1)}function Ba(a,b){10===a[0]||l();a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3]}
var G=u("\u592a\u59cb\u521d\u6838"),Ca=u("\u7b26\u540d"),H=u("\u5316\u6ec5"),J=u("\u5f0f\u5f62"),Da=u("\u7b49\u540c"),Ea=u("\u89e3\u7b97"),Ja=u("\u7279\u5b9a\u5176\u7269"),K=u("\u7701\u7565\u4e00\u7269"),Ka=u("\u6620\u8868"),La=u("\u5982\u82e5"),L=u("\u4e00\u985e\u4f55\u7269"),Ma=u("\u662f\u975e"),Na=u("\u5176\u5b50"),Oa=u("\u723b\u967d"),Pa=u("\u723b\u9670"),Qa=u("\u5f15\u7528"),Ra=u("\u61c9\u7528"),Sa=u("\u9593\u7a7a"),Ta=u("\u9023\u9838"),Ua=u("\u69cb\u7269"),Va=u("\u8b2c\u8aa4"),Wa=u("\u8a5e\u7d20"),
Xa=u("\u5217\u5e8f"),Ya=u("\u9996\u59cb"),Za=u("\u5c3e\u672b"),$a=u("\u4e4b\u7269"),ab=u("\u5b87\u5b99\u4ea1\u77e3"),bb=u("\u6548\u61c9"),cb=u("\u8a3b\u758f"),db=[4,G,O(ab,K)];function P(a){return[3,Ca,[1,G,[1,a,x]]]}function eb(a){return P(O(L,O(H,K,a),Ja))}function ib(a,b){return P(O(L,O(H,O(a),K),b))}function jb(a){return P(O(L,H,O(Ma,O(L,a,K))))}
var kb=eb(Ua),lb=ib(Ua,Ca),mb=ib(Ua,Xa),nb=jb(Ua),ob=eb(Va),pb=ib(Va,Ca),qb=ib(Va,Xa),rb=jb(Va),sb=eb(Ta),tb=jb(Ta),ub=ib(Ta,Ya),vb=ib(Ta,Za),wb=jb(Wa),xb=jb(Sa),yb=P(O(L,H,O(Ma,Da))),zb=P(O(L,O(H,[1,H,K],K),Ra)),Ab=P(O(L,H,Ea)),Bb=ib(Xa,O(L,$a,K)),Cb=P(O(L,H,La)),Db=P(O(L,J,Qa)),Eb=P(O(L,O(J,O(H,K,H)),Ja)),Fb=P(O(J,O(G,H))),Gb=P(O(J,O(G,J))),Hb=P(O(J,J)),Ib=P(O(L,H,cb)),Jb=P(O(L,J,cb)),Kb=[3,Pa,O()],Lb=[3,Oa,O()];function Mb(a,b){return a===b?!0:a[1]===b[1]?(F(a,b),!0):!1}
function Q(a){for(var b=x,c=a.length-1;0<=c;c--)b=[1,a[c],b];return b}exports.jsArray_to_list=Q;function Nb(a,b,c){for(var d=[];v(a);)d.push(a[1]),a=a[2];return z(a)?b(d):c(d,a)}function R(a){return Nb(a,function(b){return b},function(){return!1})}exports.maybe_list_to_jsArray=R;function O(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return Q(a)}exports.new_list=O;function Ob(a){if(!ua(a))return a;for(var b=[];ua(a);)b.push(a),a=a[1];for(var c=0;c<b.length;c++)F(b[c],a);return a}
exports.un_just=Ob;exports.un_just_comment_all=function(a){for(;ua(a)||q(a);)a=Ob(fa(a));return a};function Pb(a){return 6===a[0]||8===a[0]||7===a[0]||9===a[0]}exports.delay_p=Pb;function S(a){return ua(a)||Pb(a)}exports.delay_just_p=S;function Qb(a){if(6===a[0])return a;if(8===a[0])throw"WIP";if(7===a[0])throw"WIP";if(9===a[0])throw"WIP";return l()}exports.delay_env=function(a){return Qb(a)[1]};exports.delay_x=function(a){return Qb(a)[2]};
function E(a,b,c,d){function f(C){F(n,C);for(var M=0;M<d.length;M++)F(d[M],C);return C}function h(){c[1]=!0;return g(db)}function g(C){f(C);return S(C)?(d.push(n),E(C,b,[!1,!1],d)):C}function k(){var C={},M;for(M in m)C[M]=!0;for(M in b)C[M]=!0;return C}void 0===b&&(b={});void 0===c&&(c=[!1,!1]);void 0===d&&(d=[]);var m={},n=a;for(a=0;S(n)&&32>a;a++)d.push(n),n=T(n);for(;S(n);){a=V(n);if(!0===b[a])return h();if(!0===m[a]){c[0]=!0;if(6===n[0])return h();if(7===n[0]){a=n[1];for(var w=n[2],N=!1,U=0,
ba=[lb,mb,nb,pb,qb,rb,tb,ub,vb,wb,xb];U<ba.length;U++)if(W(ba[U],a)){N=!0;break}if(N)return 1===w.length||l(),!1===c[1]||l(),w=E(w[0],k(),c),c[1]?g(D(a,[w])):l();if(W(a,yb)||W(a,zb)||W(a,Ab))return h();if(W(a,Cb)&&(3===w.length||l(),!1===c[1]||l(),a=E(w[0],k(),c),c[1]))return g(D(Cb,[a,w[1],w[2]]))}else if(8===n[0]||9===n[0])return h();return l()}m[a]=!0;d.push(n);n=T(n)}return f(n)}
function T(a){var b=Ob(a);!ua(b)||l();a=6===b[0]?Rb(b[1],b[2],a):8===b[0]?Sb(b[1],b[2],b[3]):7===b[0]?Tb(b[1],b[2],a):9===b[0]?Ub(b[1],b[2],a):b;a=Ob(a);F(b,a);return a}exports.force1=T;exports.force_all=function(a){return E(a)};function Aa(a){for(;S(a)||q(a);)a=E(fa(a));return a}exports.force_uncomment_all=Aa;exports.force_uncomment1=function(a){return q(a)?a[2]:T(a)};var Vb=[];exports.env_null_v=Vb;
function Wb(a,b,c){for(var d=[],f=0;f<a.length;f+=2){if(W(a[f],b)){d[f]=b;d[f+1]=c;for(f+=2;f<a.length;f+=2)d[f]=a[f],d[f+1]=a[f+1];return d}d[f]=a[f];d[f+1]=a[f+1]}d[a.length]=b;d[a.length+1]=c;return d}exports.env_set=Wb;function Xb(a,b,c){for(var d=0;d<a.length;d+=2)if(W(a[d],b))return a[d+1];return c}exports.env_get=Xb;function Yb(a,b){for(var c=0;c<a.length;c+=2)if(W(a[c],b))return a[c+1];return l()}function X(a){for(var b=x,c=0;c<a.length;c+=2)b=[1,O(a[c],a[c+1]),b];return[3,Ka,O(b)]}
exports.env2val=X;function Zb(a,b){for(var c=0;c<a.length;c+=2)b(a[c],a[c+1])}exports.env_foreach=Zb;function $b(a){a=E(a);if(!A(a))return!1;var b=E(a[1]);if(!t(b)||!Mb(b,Ka))return!1;b=E(a[2]);if(!v(b)||!z(E(b[2])))return!1;a=[];for(b=E(b[1]);!z(b);){if(!v(b))return!1;var c=E(b[1]);b=E(b[2]);if(!v(c))return!1;var d=c[1];c=E(c[2]);if(!v(c))return!1;var f=c[1];if(!z(E(c[2])))return!1;c=!0;for(var h=0;h<a.length;h+=2)if(W(a[h],d)){a[h+1]=f;c=!1;break}c&&(a.push(d),a.push(f))}return a}
exports.val2env=$b;
function Rb(a,b,c){function d(){return[4,G,O(Fb,O(Ab,O(X(a),f)))]}var f=T(b);if(S(f))return c;if(v(f)){b=[];for(var h=f;!z(h);){if(S(h))return c;if(v(h))b.push(h[1]),h=T(h[2]);else return d()}if(W(b[0],Gb)){if(1===b.length)return d();h=b[1];c=[];for(var g=2;g<b.length;g++)c.push(b[g]);return[8,a,h,c]}if(W(b[0],Hb)){if(1===b.length)return d();h=E([6,a,b[1]]);if(!A(h))return d();g=T(h[1]);if(S(g))return c;if(!t(g)||!Mb(g,J))return d();g=T(h[2]);if(S(g))return c;if(!v(g))return d();h=g[1];g=T(g[2]);
if(S(g))return c;if(!z(g))return d();c=[X(a)];for(g=2;g<b.length;g++)c.push(b[g]);return[9,h,c]}if(W(b[0],Fb)){if(1===b.length)return d();h=b[1];c=[];for(g=2;g<b.length;g++)c.push([6,a,b[g]]);return[7,h,c]}h=[6,a,b[0]];c=[];for(g=1;g<b.length;g++)c.push([6,a,b[g]]);return[9,h,c]}return z(f)?f:t(f)||A(f)?Xb(a,f,d()):B(f)?d():l()}function ac(a,b){return[a,1,function(c){c=T(c);return S(c)?D(a,[c]):b(c)?Lb:Kb}]}function bc(a,b,c){return[a,1,function(d,f){d=T(d);return S(d)?D(a,[d]):b(d)?c(d):f()}]}
var cc=[ac(nb,A),[kb,2,oa],bc(lb,A,pa),bc(mb,A,qa),ac(rb,B),[ob,2,ra],bc(pb,B,sa),bc(qb,B,ta),ac(xb,z),[sb,2,ka],ac(tb,v),bc(ub,v,ma),bc(vb,v,na),[yb,2,function(a,b){function c(d,f,h,g){h=D(yb,[h(d),h(f)]);d=D(yb,[g(d),g(f)]);return D(Cb,[h,d,Kb])}if(a===b)return Lb;a=T(a);b=T(b);if(S(a)||S(b))return D(yb,[a,b]);if(a===b)return Lb;!S(a)||l();return z(a)?z(a)?Lb:Kb:t(a)?t(b)?Mb(a,b)?Lb:Kb:Kb:A(a)?A(b)?c(a,b,pa,qa):Kb:v(a)?v(b)?c(a,b,ma,na):Kb:B(a)?B(b)?c(a,b,sa,ta):Kb:l()}],[zb,2,function(a,b,c){var d=
[];for(b=E(b);v(b);)d.push(b[1]),b=E(b[2]);return z(b)?[9,a,d]:c()}],[Ab,2,function(a,b,c){a=$b(a);return!1===a?c():[6,a,b]}],ac(wb,t),[Bb,1,function(a,b){a=T(a);return S(a)?D(Bb,[a]):v(a)?a[1]:b()}],[Cb,3,function(a,b,c,d){a=T(a);if(S(a))return D(Cb,[a,b,c]);if(!A(a))return d();a=E(a[1]);return t(a)?Mb(a,Oa)?b:Mb(a,Pa)?c:d():d()}],[Ib,2,ea]];
function Ub(a,b,c){function d(){return[4,G,O(Fb,O(zb,O(a,Q(b))))]}a=T(a);if(S(a))return c;if(!A(a))return d();c=E(a[1]);if(!t(c)||!Mb(c,H))return d();var f=E(a[2]);if(!v(f))return d();c=ya(f[1]);f=E(f[2]);if(!v(f)||!z(E(f[2])))return d();f=f[1];for(var h=Vb,g=0;!z(c);)if(t(c)||A(c)){for(var k=x,m=b.length-1;m>=g;m--)k=[1,b[m],k];h=Wb(h,c,k);g=b.length;c=x}else if(v(c))if(g<b.length)k=b[g],g++,h=Wb(h,c[1],k),c=c[2];else return d();else return d();return b.length!==g?d():[6,h,f]}
function Tb(a,b,c){function d(){return[4,G,O(Fb,O(a,Q(b)))]}for(var f=0;f<cc.length;f++){var h=cc[f];if(W(a,h[0])){if(b.length!==h[1])break;return 1===h[1]?h[2](b[0],d,c):2===h[1]?h[2](b[0],b[1],d,c):3===h[1]?h[2](b[0],b[1],b[2],d,c):l()}}return d()}function Sb(a,b,c){function d(){return[4,G,O(Gb,O(X(a),b,Q(c)))]}return W(b,Db)?1!==c.length?d():c[0]:W(b,Eb)?2!==c.length?d():dc(a,c[0],c[1],d):W(b,Jb)?2!==c.length?d():[11,c[0],[6,a,c[1]]]:d()}
function dc(a,b,c,d){void 0===d&&(d=!1);b=ya(b);for(var f=[],h=!1,g=b;!z(g);)if(t(g)||A(g))f.push(g),h=!0,g=x;else if(v(g))f.push(g[1]),g=g[2];else return!1===d?ra(G,O(Gb,O(X(a),Eb,Q([b,c])))):d();d=b;h&&(d=Q(f));var k=[];Zb(a,function(m){for(var n=0;n<f.length;n++)if(W(f[n],m))return;k.push(m)});h=d;for(g=k.length-1;0<=g;g--)h=[1,k[g],h];for(g=k.length-1;0<=g;g--)d=ka(O(Gb,Db,Yb(a,k[g])),d);return[3,H,O(b,[1,O(Gb,Db,[3,H,O(h,c)]),d])]}
function W(a,b){function c(d,f,h,g){return W(h(d),h(f))&&W(g(d),g(f))?(F(d,f),!0):!1}if(a===b)return!0;a=E(a);b=E(b);if(a===b)return!0;if(z(a)){if(!z(b))return!1;F(a,x);F(b,x);return!0}return t(a)?t(b)?Mb(a,b):!1:v(a)?v(b)?c(a,b,ma,na):!1:B(a)?B(b)?c(a,b,sa,ta):!1:A(a)?A(b)?c(a,b,pa,qa):!1:l()}exports.equal_p=W;
function Y(a,b){function c(d,f,h,g){return Y(h(d),h(f))&&Y(g(d),g(f))?(F(d,f),!0):!1}if(a===b)return!0;a=Ob(a);b=Ob(b);if(a===b)return!0;if(z(a)){if(!z(b))return!1;F(a,x);F(b,x);return!0}if(t(a))return t(b)?Mb(a,b):!1;if(v(a))return v(b)?c(a,b,ma,na):!1;if(B(a))return B(b)?c(a,b,sa,ta):!1;if(A(a))return A(b)?c(a,b,pa,qa):!1;if(6===a[0])throw"WIP";if(7===a[0])throw"WIP";if(8===a[0])throw"WIP";if(9===a[0])throw"WIP";return l()}
function V(a){a=Ob(a);var b;if(z(a))return"()";if(v(a)){var c="(";for(b="";v(a);)c+=b+V(a[1]),b=" ",a=Ob(a[2]);return c=z(a)?c+")":c+(" . "+V(a)+")")}return A(a)?"#"+V([1,a[1],a[2]]):B(a)?"!"+V([1,a[1],a[2]]):t(a)?ia(a):q(a)?";("+V(a[1])+" "+V(a[2])+")":6===a[0]?"$("+V(X(a[1]))+" "+V(a[2])+")":7===a[0]?"%("+V(a[1])+" "+V(Q(a[2]))+")":8===a[0]?"@("+V(X(a[1]))+" "+V(a[2])+" "+V(Q(a[3]))+")":9===a[0]?"^("+V(a[1])+" "+V(Q(a[2]))+")":l()}exports.simple_print=V;exports.simple_print_force_all_rec=function(a){return V(ya(a))};
function ec(a){function b(){return ca.length===ja}function c(){!b()||l();var e=ca[ja];ja++;return e}function d(e){ca[ja-1]===e||l();ja--}function f(e){void 0===e&&(e="");throw"TheLanguage parse ERROR!"+e;}function h(e){return" "===e||"\n"===e||"\t"===e||"\r"===e}function g(){if(b())return!1;var e=c();if(!h(e))return d(e),!1;for(;h(e)&&!b();)e=c();h(e)||d(e);return!0}function k(){if(b())return!1;var e=c(),p="";if(!U(e))return d(e),!1;for(;U(e)&&!b();)p+=e,e=c();U(e)?p+=e:d(e);return ha(p)?u(p):f("Not Symbol"+
p)}function m(){if(b())return!1;var e=c();if("("!==e)return d(e),!1;for(var p=[10],r=p;;){g();if(b())return f();e=c();if(")"===e)return Ba(p,x),r;if("."===e){g();e=ba();Ba(p,e);g();if(b())return f();e=c();return")"!==e?f():r}d(e);e=ba();var I=[10];Ba(p,[1,e,I]);p=I}}function n(){if(b())return!1;var e=c();if("#"!==e)return d(e),!1;e=m();return!1!==e&&v(e)?[3,e[1],e[2]]:f()}function w(){if(b())return!1;var e=c();if("!"!==e)return d(e),!1;e=m();return!1!==e&&v(e)?[4,e[1],e[2]]:f()}function N(e,p){return function(){if(b())return!1;
var r=c();if(r!==e)return d(r),!1;r=m();if(!1===r||!v(r))return f();var I=r[2];return v(I)&&z(I[2])?p(r[1],I[1]):f()}}function U(e){if(h(e))return!1;for(var p=0,r="()!#.$%^@~/->_:?[]&;".split("");p<r.length;p++)if(r[p]===e)return!1;return!0}function ba(){g();for(var e=0,p=[m,Fa,n,w,va,la,fb,gb,hb];e<p.length;e++){var r=(0,p[e])();if(!1!==r)return r}return f()}function C(e){return!1===e?f():e}function M(e){C(!b());C(c()===e)}function y(e){function p(){M("[");var Ga=y();M("]");return Ga}void 0===e&&
(e=!1);var r=0;for(e=e?[m,k,p,n,w,va,la,fb,gb,hb]:[m,Ha,n,w,va,la,fb,gb,hb];r<e.length;r++){var I=(0,e[r])();if(!1!==I)return I}return f()}function Ia(e){if(b())return e;var p=c();if("."===p)return p=y(),O(L,O(H,O(e),K),p);if(":"===p)return p=y(),O(L,p,e);if("~"===p)return O(Ma,e);if("@"===p)return p=y(),O(L,O(H,[1,e,K],K),p);if("?"===p)return O(L,H,O(Ma,e));if("/"===p){for(e=[e];;){p=y(!0);e.push(p);if(b())break;p=c();if("/"!==p){d(p);break}}return O(Na,Q(e))}d(p);return e}function Ha(){if(b())return!1;
var e=c();if("&"===e){C(!b());e=c();if("+"===e)return e=y(),O(J,O(G,e));d(e);e=y();return O(J,e)}if(":"===e){C(!b());e=c();if("&"===e)return M(">"),e=y(),O(L,O(J,O(H,K,e)),Ja);if(">"===e)return e=y(),O(L,O(H,K,e),Ja);d(e);e=y();return O(L,e,Ja)}if("+"===e)return e=y(),O(G,e);if("["===e)return e=y(),M("]"),Ia(e);if("_"===e)return M(":"),e=y(),O(L,e,K);d(e);e=k();return!1===e?!1:Ia(e)}function Fa(){var e=Ha();return!1===e?!1:t(e)?e:P(e)}var ca=a,ja=0,va=N("$",function(e,p){var r=$b(e);return!1===r?
f():[6,r,p]}),la=N("%",function(e,p){var r=Nb(p,function(I){return I},function(){return f()});return[7,e,r]}),fb=function(e,p){return function(){if(b())return!1;var r=c();if(r!==e)return d(r),!1;r=m();if(!1===r||!v(r))return f();var I=r[2];if(!v(I))return f();var Ga=I[2];return v(Ga)&&z(Ga[2])?p(r[1],I[1],Ga[1]):f()}}("@",function(e,p,r){r=Nb(r,function(I){return I},function(){return f()});e=$b(e);return!1===e?f():[8,e,p,r]}),gb=N("^",function(e,p){var r=Nb(p,function(I){return I},function(){return f()});
return[9,e,r]}),hb=N(";",function(e,p){return[11,e,p]});return ba()}exports.complex_parse=ec;
function Z(a){function b(f,h){function g(N){return h?"["+N+"]":N}if(t(f))return ia(f);var k=R(f);if(!1!==k&&3===k.length&&Y(k[0],L)){var m=R(k[1]);if(!1!==m&&3===m.length&&Y(m[0],H)){var n=m[1],w=R(n);if(!1!==w&&1===w.length&&Y(m[2],K))return g(b(w[0],!0)+"."+b(k[2],!0));if(v(n)&&Y(n[2],K)&&Y(m[2],K))return g(b(n[1],!0)+"@"+b(k[2],!0));if(Y(n,K)&&Y(k[2],Ja))return g(":>"+b(m[2],!0))}n=R(k[2]);if(Y(k[1],H)&&!1!==n&&2===n.length&&Y(n[0],Ma))return g(b(n[1],!0)+"?");if(!1!==m&&2===m.length&&Y(k[2],Ja)&&
Y(m[0],J)&&(m=R(m[1]),!1!==m&&3===m.length&&Y(m[0],H)&&Y(m[1],K)))return g(":&>"+b(m[2],!0));m=Y(k[2],K)?"_":Y(k[2],Ja)?"":b(k[2],!0);return g(m+":"+b(k[1],!0))}if(!1!==k&&2===k.length){if(Y(k[0],J))return m=R(k[1]),!1!==m&&2===m.length&&Y(m[0],G)?g("&+"+b(m[1],!0)):g("&"+b(k[1],!0));if(Y(k[0],Ma))return g(b(k[1],!0)+"~");if(Y(k[0],G))return g("+"+b(k[1],!0));if(Y(k[0],Na)&&(k=R(k[1]),!1!==k&&1<k.length)){m=b(k[0],!0);for(n=1;n<k.length;n++)m+="/"+b(k[n],!0);return g(m)}}return h?V(f):V(P(f))}a=ec(V(a));
var c="",d="";if(z(a))return"()";if(v(a)){c="(";for(d="";v(a);)c+=d+Z(a[1]),d=" ",a=a[2];return c=z(a)?c+")":c+(" . "+Z(a)+")")}return A(a)?(c=a[1],a=a[2],d=R(a),!1!==d&&2===d.length&&Y(c,Ca)&&Y(d[0],G)?b(d[1],!1):"#"+Z([1,c,a])):B(a)?"!"+Z([1,a[1],a[2]]):t(a)?ia(a):q(a)?";("+Z(a[1])+" "+Z(a[2])+")":6===a[0]?"$("+Z(X(a[1]))+" "+Z(a[2])+")":7===a[0]?"%("+Z(a[1])+" "+Z(Q(a[2]))+")":8===a[0]?"@("+Z(X(a[1]))+" "+Z(a[2])+" "+Z(Q(a[3]))+")":9===a[0]?"^("+Z(a[1])+" "+Z(Q(a[2]))+")":l()}
exports.complex_print=Z;
exports.machinetext_parse=function(a){function b(){function n(C){function M(ca){var ja=[10],va=[10];w.push(function(la){return Ba(ja,la)});w.push(function(la){return Ba(va,la)});C(ca(ja,va))}var y=f();if("^"===y){for(y="";;){var Ia=f();if("^"===Ia)break;y+=Ia}if(y in da())C([0,y]);else return{value:c()}}else if("."===y)M(ka);else if("#"===y)M(oa);else if("!"===y)M(ra);else if("$"===y){var Ha=[10],Fa=!1;w.push(function(ca){Fa=$b(ca)});w.push(function(ca){return!1===Fa?c():Ba(Ha,[6,Fa,ca])});C(Ha)}else if("_"===
y)C(x);else return{value:c()}}for(var w=[],N=0,U=g;N<U.length;N++){var ba=n(U[N]);if("object"===typeof ba)return ba}g=w}function c(){throw"MT parse ERROR";}function d(n){if(!n)return c()}function f(){d(a.length>k);var n=a[k];k++;return n}for(var h=[10],g=[function(n){return Ba(h,n)}],k=0;0!==g.length;){var m=b();if("object"===typeof m)return m.value}d(k==a.length);return h};
exports.machinetext_print=function(a){function b(){for(var f=[],h=0,g=c;h<g.length;h++){var k=g[h];k=Ob(k);var m=function(n,w,N,U){d+=w;f.push(N(n));f.push(U(n))};if(t(k))d+="^",d+=k[1],d+="^";else if(v(k))m(k,".",ma,na);else if(z(k))d+="_";else if(A(k))m(k,"#",pa,qa);else if(B(k))m(k,"!",sa,ta);else if(Pb(k))k=Qb(k),m(k,"$",function(n){return X(n[1])},wa);else return{value:l()}}c=f}for(var c=[a],d="";0!==c.length;)if(a=b(),"object"===typeof a)return a.value;return d};exports.Trampoline=function(){};
function fc(a){return function(){return[!1,a]}}exports.trampoline_return=fc;function gc(a){return function(){return[!0,a()]}}exports.trampoline_delay=gc;function hc(a){for(a=a();a[0];)a=a[1]();return a[1]}exports.run_trampoline=hc;var ic=P([1,Na,[1,[1,bb,[1,[1,L,[1,$a,[1,K,x]]],x]],x]]);exports.return_effect_systemName=ic;var jc=P([1,Na,[1,[1,bb,[1,Ta,x]],x]]);exports.bind_effect_systemName=jc;exports.new_effect_bind=function(a,b){return[3,jc,O(a,b)]};
exports.new_effect_return=function(a){return[3,ic,a]};
function kc(a,b,c,d,f){void 0===f&&(f=!1);c=E(c);if(A(c)){var h=c[1],g=c[2];if(W(h,ic)){if(g=E(g),v(g)&&(h=g[1],g=E(g[2]),z(g))){if(!1===f){var k=h;h=function(){return a(k,d)}}else{var m=h;h=function(){return kc(a,b,[9,f,m],d)}}return gc(h)}}else if(W(h,jc)&&(g=E(g),v(g)&&(h=g[1],g=E(g[2]),v(g)))){var n=g[1];g=E(g[2]);if(z(g)){if(!1===f){var w=h;h=function(){return kc(a,b,w,d,n)}}else u("\u5e8f\u7532"),h=function(){throw"WIP";};return gc(h)}}}return!1===f?gc(function(){return b(c,d,a)}):gc(function(){return b(c,
d,function(N,U){return gc(function(){return kc(a,b,xa(f,[N]),U)})})})}exports.run_monad_trampoline=function(a,b,c,d){return kc(a,b,c,d)};exports.run_monad_stackoverflow=function(a,b,c,d){return hc(kc(function(f,h){return fc(a(f,h))},function(f,h,g){return fc(b(f,h,function(k,m){return hc(g(k,m))}))},c,d))};
