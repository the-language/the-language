function n(){throw"TheLanguage PANIC";}
function aa(){var a={0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",A:"A",B:"B",C:"C",D:"D",E:"E",F:"F",G:"G",H:"H",I:"I",J:"J",K:"K",L:"L",M:"M",N:"N",O:"O",P:"P",Q:"Q",R:"R",S:"S",T:"T",U:"U",V:"V",W:"W",X:"X",Y:"Y",Z:"Z",a:"a",b:"b",c:"c",d:"d",e:"e",f:"f",g:"g",h:"h",i:"i",j:"j",k:"k",l:"l",m:"m",n:"n",o:"o",p:"p",q:"q",r:"r",s:"s",t:"t",u:"u",v:"v",w:"w",x:"x",y:"y",z:"z","\u4e00\u985e\u4f55\u7269":"\u3749","\u4e4b\u7269":"\ud86d\ude66","\u5176\u5b50":"\ud85a\udfaa","\u51fa\u5165\u6539\u6ec5":"\ud849\udc9f",
"\u5217\u5e8f":"\ud841\udf3a","\u5316\u6ec5":"\ud840\udfc1","\u53c3\u5f62":"\ud842\udef0","\u543e\u81ea":"\ud85a\udcf9","\u592a\u59cb\u521d\u6838":"\ud84d\udf57","\u5982\u82e5":"\ud85b\udc61","\u5b87\u5b99\u4ea1\u77e3":"\ud863\ude79","\u5c3e\u672b":"\ud847\udcb5","\u5e8f\u4e01":"\ud840\udda4","\u5e8f\u4e19":"\ud840\uddee","\u5e8f\u4e59":"\u3408","\u5e8f\u7532":"\ud840\uddda","\u5f0f\u5f62":"\u4f71","\u5f15\u7528":"\u39c8","\u61c9\u7528":"\ud853\udc06","\u6548\u61c9":"\u52b9","\u6620\u8868":"\ud850\udd54",
"\u662f\u975e":"\u6b24","\u69cb\u7269":"\ud845\udcab","\u70ba\u7b26\u540d\u9023":"\u2010","\u723b\u9670":"\u4f8c","\u723b\u967d":"\ud84c\udd84","\u7279\u5b9a\u5176\u7269":"\u4e93","\u7701\u7565\u4e00\u7269":"\u7567","\u7b26\u540d":"\u8b3c","\u7b49\u540c":"\u5f0c","\u89e3\u7b97":"\u7b6d","\u8a3b\u758f":"\u758e","\u8a5e\u7d20":"\ud85e\udd5d","\u8b2c\u8aa4":"\u4958","\u9023\u9838":"\u4e29","\u9593\u7a7a":"\ud84e\udcd3","\u9996\u59cb":"\ud866\udc10"};aa=function(){return a};return a}
function ba(){var a={0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",A:"A",B:"B",C:"C",D:"D",E:"E",F:"F",G:"G",H:"H",I:"I",J:"J",K:"K",L:"L",M:"M",N:"N",O:"O",P:"P",Q:"Q",R:"R",S:"S",T:"T",U:"U",V:"V",W:"W",X:"X",Y:"Y",Z:"Z",a:"a",b:"b",c:"c",d:"d",e:"e",f:"f",g:"g",h:"h",i:"i",j:"j",k:"k",l:"l",m:"m",n:"n",o:"o",p:"p",q:"q",r:"r",s:"s",t:"t",u:"u",v:"v",w:"w",x:"x",y:"y",z:"z","\u3749":"\u4e00\u985e\u4f55\u7269","\ud86d\ude66":"\u4e4b\u7269","\ud85a\udfaa":"\u5176\u5b50","\ud849\udc9f":"\u51fa\u5165\u6539\u6ec5",
"\ud841\udf3a":"\u5217\u5e8f","\ud840\udfc1":"\u5316\u6ec5","\ud842\udef0":"\u53c3\u5f62","\ud85a\udcf9":"\u543e\u81ea","\ud84d\udf57":"\u592a\u59cb\u521d\u6838","\ud85b\udc61":"\u5982\u82e5","\ud863\ude79":"\u5b87\u5b99\u4ea1\u77e3","\ud847\udcb5":"\u5c3e\u672b","\ud840\udda4":"\u5e8f\u4e01","\ud840\uddee":"\u5e8f\u4e19","\u3408":"\u5e8f\u4e59","\ud840\uddda":"\u5e8f\u7532","\u4f71":"\u5f0f\u5f62","\u39c8":"\u5f15\u7528","\ud853\udc06":"\u61c9\u7528","\u52b9":"\u6548\u61c9","\ud850\udd54":"\u6620\u8868",
"\u6b24":"\u662f\u975e","\ud845\udcab":"\u69cb\u7269","\u2010":"\u70ba\u7b26\u540d\u9023","\u4f8c":"\u723b\u9670","\ud84c\udd84":"\u723b\u967d","\u4e93":"\u7279\u5b9a\u5176\u7269","\u7567":"\u7701\u7565\u4e00\u7269","\u8b3c":"\u7b26\u540d","\u5f0c":"\u7b49\u540c","\u7b6d":"\u89e3\u7b97","\u758e":"\u8a3b\u758f","\ud85e\udd5d":"\u8a5e\u7d20","\u4958":"\u8b2c\u8aa4","\u4e29":"\u9023\u9838","\ud84e\udcd3":"\u9593\u7a7a","\ud866\udc10":"\u9996\u59cb"};ba=function(){return a};return a}
function ca(a,b){return[11,a,b]}exports.new_comment=ca;function q(a){return 11===a[0]}exports.comment_p=q;exports.comment_comment=function(a){return a[1]};exports.comment_x=function(a){return a[2]};function da(a){for(;q(a);)a=a[2];return a}exports.un_comment_all=da;function t(a){return 0===a[0]}exports.symbol_p=t;function ea(a){return a in aa()}exports.can_new_symbol_p=ea;function u(a){return[0,aa()[a]]}exports.new_symbol=u;function fa(a){return ba()[a[1]]}exports.un_symbol=fa;
function v(a,b){return a===b?!0:a[1]===b[1]?(x(a,b),!0):!1}exports.symbol_equal_p=v;function ha(a,b){return[1,a,b]}exports.new_construction=ha;function y(a){return 1===a[0]}exports.construction_p=y;function ia(a){return a[1]}exports.construction_head=ia;function ja(a){return a[2]}exports.construction_tail=ja;var z=[2];exports.null_v=z;function A(a){return 2===a[0]}exports.null_p=A;function ka(a,b){return[3,a,b]}exports.new_data=ka;function B(a){return 3===a[0]}exports.data_p=B;
function la(a){return a[1]}exports.data_name=la;function ma(a){return a[2]}exports.data_list=ma;function na(a,b){return[4,a,b]}exports.new_error=na;function C(a){return 4===a[0]}exports.error_p=C;function oa(a){return a[1]}exports.error_name=oa;function qa(a){return a[2]}exports.error_list=qa;function ra(a){return 5===a[0]}exports.just_p=ra;exports.evaluate=function(a,b){return[6,a,b]};function sa(a){return a[2]}function D(a,b){return[7,a,b]}function ta(a,b){return[9,a,b]}exports.apply=ta;
function ua(a){a=E(a);if(B(a)||C(a)||y(a)||q(a))a[1]=ua(a[1]),a[2]=ua(a[2]);return a}exports.force_all_rec=ua;function va(a){var b=wa(a);if(B(b)||C(b)||y(b))if(b[1]=ua(b[1]),b[2]=ua(b[2]),q(b[1])||q(b[2])){a=[10];xa(a,b);var c=b[2];b=va(b[1]);c=va(c);a[1]=b;a[2]=c}else a=b;else a=b;return a}exports.force_uncomment_all_rec=va;function x(a,b){a!==b&&(a[0]=5,a[1]=b,a[2]=!1,a[3]=!1)}function xa(a,b){10===a[0]||n();10!==b[0]||n();a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3]}
var F=u("\u592a\u59cb\u521d\u6838"),ya=u("\u7b26\u540d"),I=u("\u5316\u6ec5"),J=u("\u5f0f\u5f62"),Ba=u("\u7b49\u540c"),Ca=u("\u89e3\u7b97"),Da=u("\u7279\u5b9a\u5176\u7269"),K=u("\u7701\u7565\u4e00\u7269"),Ea=u("\u6620\u8868"),Fa=u("\u5982\u82e5"),M=u("\u4e00\u985e\u4f55\u7269"),Ga=u("\u662f\u975e"),Ha=u("\u5176\u5b50"),Ia=u("\u723b\u967d"),Ja=u("\u723b\u9670"),Ka=u("\u5f15\u7528"),La=u("\u61c9\u7528"),Ma=u("\u9593\u7a7a"),Na=u("\u9023\u9838"),Oa=u("\u69cb\u7269"),Pa=u("\u8b2c\u8aa4"),Qa=u("\u8a5e\u7d20"),
Ra=u("\u5217\u5e8f"),Sa=u("\u9996\u59cb"),Ta=u("\u5c3e\u672b"),Ua=u("\u4e4b\u7269"),Va=u("\u5b87\u5b99\u4ea1\u77e3"),Wa=u("\u6548\u61c9"),Xa=u("\u8a3b\u758f"),Ya=[4,F,N(Va,K)];function O(a){return[3,ya,[1,F,[1,a,z]]]}function Za(a){return O(N(M,N(I,K,a),Da))}function fb(a,b){return O(N(M,N(I,N(a),K),b))}function gb(a){return O(N(M,I,N(Ga,N(M,a,K))))}
var hb=Za(Oa),ib=fb(Oa,ya),jb=fb(Oa,Ra),kb=gb(Oa),lb=Za(Pa),mb=fb(Pa,ya),nb=fb(Pa,Ra),ob=gb(Pa),pb=Za(Na),qb=gb(Na),rb=fb(Na,Sa),sb=fb(Na,Ta),tb=gb(Qa),ub=gb(Ma),vb=O(N(M,I,N(Ga,Ba))),wb=O(N(M,N(I,[1,I,K],K),La)),xb=O(N(M,I,Ca)),yb=fb(Ra,N(M,Ua,K)),zb=O(N(M,I,Fa)),Ab=O(N(M,J,Ka)),Bb=O(N(M,N(J,N(I,K,I)),Da)),Cb=O(N(J,N(F,I))),Db=O(N(J,N(F,J))),Eb=O(N(J,J)),Fb=O(N(M,I,Xa)),Gb=O(N(M,J,Xa)),Hb=[3,Ja,N()],Ib=[3,Ia,N()];function P(a){for(var b=z,c=a.length-1;0<=c;c--)b=[1,a[c],b];return b}
exports.jsArray_to_list=P;function Jb(a,b,c){for(var e=[];y(a);)e.push(a[1]),a=a[2];return A(a)?b(e):c(e,a)}function Mb(a){return Jb(a,function(b){return b},function(){return!1})}exports.maybe_list_to_jsArray=Mb;function N(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return P(a)}exports.new_list=N;function R(a){if(!ra(a))return a;for(var b=[];ra(a);)b.push(a),a=a[1];for(var c=0;c<b.length;c++)x(b[c],a);return a}exports.un_just_all=R;
exports.un_just_comment_all=function(a){for(;ra(a)||q(a);)a=R(da(a));return a};function Nb(a){return 6===a[0]||8===a[0]||7===a[0]||9===a[0]}exports.delay_p=Nb;function S(a){return ra(a)||Nb(a)}exports.delay_just_p=S;function Ob(a){if(6===a[0])return a;if(8===a[0])throw"WIP";if(7===a[0])throw"WIP";if(9===a[0])throw"WIP";return n()}exports.delay_env=function(a){return Ob(a)[1]};exports.delay_x=function(a){return Ob(a)[2]};
function E(a,b,c,e){function f(L){x(m,L);for(var Q=0;Q<e.length;Q++)x(e[Q],L);return L}function k(){c[1]=!0;return g(Ya)}function g(L){f(L);return S(L)?(e.push(m),E(L,b,[!1,!1],e)):L}function h(){var L={},Q;for(Q in l)L[Q]=!0;for(Q in b)L[Q]=!0;return L}void 0===b&&(b={});void 0===c&&(c=[!1,!1]);void 0===e&&(e=[]);var l={},m=a;for(a=0;S(m)&&32>a;a++)e.push(m),m=U(m);for(;S(m);){a=V(m);if(!0===b[a])return k();if(!0===l[a]){c[0]=!0;if(6===m[0])return k();if(7===m[0]){a=m[1];for(var w=m[2],G=!1,W=0,
pa=[ib,jb,kb,mb,nb,ob,qb,rb,sb,tb,ub];W<pa.length;W++)if(X(pa[W],a)){G=!0;break}if(G)return 1===w.length||n(),!1===c[1]||n(),w=E(w[0],h(),c),c[1]?g(D(a,[w])):n();if(X(a,vb)||X(a,wb)||X(a,xb))return k();if(X(a,zb)&&(3===w.length||n(),!1===c[1]||n(),a=E(w[0],h(),c),c[1]))return g(D(zb,[a,w[1],w[2]]))}else if(8===m[0]||9===m[0])return k();return n()}l[a]=!0;e.push(m);m=U(m)}return f(m)}
function U(a){var b=R(a);!ra(b)||n();a=6===b[0]?Pb(b[1],b[2],a):8===b[0]?Qb(b[1],b[2],b[3]):7===b[0]?Rb(b[1],b[2],a):9===b[0]?Sb(b[1],b[2],a):b;a=R(a);x(b,a);return a}exports.force1=U;exports.force_all=function(a){return E(a)};function wa(a){for(;S(a)||q(a);)a=E(da(a));return a}exports.force_uncomment_all=wa;exports.force_uncomment1=function(a){return q(a)?a[2]:U(a)};var Tb=[];exports.env_null_v=Tb;
function Ub(a,b,c){for(var e=[],f=0;f<a.length;f+=2){if(X(a[f],b)){e[f]=b;e[f+1]=c;for(f+=2;f<a.length;f+=2)e[f]=a[f],e[f+1]=a[f+1];return e}e[f]=a[f];e[f+1]=a[f+1]}e[a.length]=b;e[a.length+1]=c;return e}exports.env_set=Ub;function Vb(a,b,c){for(var e=0;e<a.length;e+=2)if(X(a[e],b))return a[e+1];return c}exports.env_get=Vb;function Wb(a,b){for(var c=0;c<a.length;c+=2)if(X(a[c],b))return a[c+1];return n()}function Xb(a){for(var b=z,c=0;c<a.length;c+=2)b=[1,N(a[c],a[c+1]),b];return[3,Ea,N(b)]}
exports.env2val=Xb;function Yb(a,b){for(var c=0;c<a.length;c+=2)b(a[c],a[c+1])}exports.env_foreach=Yb;function Zb(a){a=E(a);if(!B(a))return!1;var b=E(a[1]);if(!t(b)||!v(b,Ea))return!1;b=E(a[2]);if(!y(b)||!A(E(b[2])))return!1;a=[];for(b=E(b[1]);!A(b);){if(!y(b))return!1;var c=E(b[1]);b=E(b[2]);if(!y(c))return!1;var e=c[1];c=E(c[2]);if(!y(c))return!1;var f=c[1];if(!A(E(c[2])))return!1;c=!0;for(var k=0;k<a.length;k+=2)if(X(a[k],e)){a[k+1]=f;c=!1;break}c&&(a.push(e),a.push(f))}return a}
exports.val2env=Zb;function $b(a,b,c,e){var f=[],k=[];a=R(a);for(var g=!0;;){if(A(a))return e(k,f);if(q(a))k.push(a[1]),a=a[2];else if(y(a))f.push(a[1]),a=a[2];else if(S(a))if(g)g=!1,a=U(a);else return c();else return b()}}
function Pb(a,b,c){function e(){return[4,F,N(Cb,N(xb,N(Xb(a),f)))]}var f=U(b);return S(f)?c:y(f)?$b(f,e,function(){return c},function(k,g){if(0!==k.length)throw"WIP";if(X(g[0],Db)){if(1===g.length)return e();for(var h=g[1],l=[],m=2;m<g.length;m++)l.push(g[m]);return[8,a,h,l]}if(X(g[0],Eb)){if(1===g.length)return e();h=E([6,a,g[1]]);if(!B(h))return e();l=U(h[1]);if(S(l))return c;if(!t(l)||!v(l,J))return e();l=U(h[2]);if(S(l))return c;if(!y(l))return e();h=l[1];l=U(l[2]);if(S(l))return c;if(!A(l))return e();
l=[Xb(a)];for(m=2;m<g.length;m++)l.push(g[m]);return[9,h,l]}if(X(g[0],Cb)){if(1===g.length)return e();h=g[1];l=[];for(m=2;m<g.length;m++)l.push([6,a,g[m]]);return[7,h,l]}h=[6,a,g[0]];l=[];for(m=1;m<g.length;m++)l.push([6,a,g[m]]);return[9,h,l]}):A(f)?f:t(f)||B(f)?Vb(a,f,e()):C(f)?e():n()}function ac(a,b){return[a,1,function(c){c=U(c);return S(c)?D(a,[c]):b(c)?Ib:Hb}]}function bc(a,b,c){return[a,1,function(e,f){e=U(e);return S(e)?D(a,[e]):b(e)?c(e):f()}]}
var cc=[ac(kb,B),[hb,2,ka],bc(ib,B,la),bc(jb,B,ma),ac(ob,C),[lb,2,na],bc(mb,C,oa),bc(nb,C,qa),ac(ub,A),[pb,2,ha],ac(qb,y),bc(rb,y,ia),bc(sb,y,ja),[vb,2,function(a,b){function c(e,f,k,g){k=D(vb,[k(e),k(f)]);e=D(vb,[g(e),g(f)]);return D(zb,[k,e,Hb])}if(a===b)return Ib;a=U(a);b=U(b);if(S(a)||S(b))return D(vb,[a,b]);if(a===b)return Ib;!S(a)||n();return A(a)?A(a)?Ib:Hb:t(a)?t(b)?v(a,b)?Ib:Hb:Hb:B(a)?B(b)?c(a,b,la,ma):Hb:y(a)?y(b)?c(a,b,ia,ja):Hb:C(a)?C(b)?c(a,b,oa,qa):Hb:n()}],[wb,2,function(a,b,c){var e=
[];for(b=E(b);y(b);)e.push(b[1]),b=E(b[2]);return A(b)?[9,a,e]:c()}],[xb,2,function(a,b,c){a=Zb(a);return!1===a?c():[6,a,b]}],ac(tb,t),[yb,1,function(a,b){a=U(a);return S(a)?D(yb,[a]):y(a)?a[1]:b()}],[zb,3,function(a,b,c,e){a=U(a);if(S(a))return D(zb,[a,b,c]);if(!B(a))return e();a=E(a[1]);return t(a)?v(a,Ia)?b:v(a,Ja)?c:e():e()}],[Fb,2,ca]];
function Sb(a,b,c){function e(){return[4,F,N(Cb,N(wb,N(a,P(b))))]}a=U(a);if(S(a))return c;if(!B(a))return e();c=E(a[1]);if(!t(c)||!v(c,I))return e();var f=E(a[2]);if(!y(f))return e();c=ua(f[1]);f=E(f[2]);if(!y(f)||!A(E(f[2])))return e();f=f[1];for(var k=Tb,g=0;!A(c);)if(t(c)||B(c)){for(var h=z,l=b.length-1;l>=g;l--)h=[1,b[l],h];k=Ub(k,c,h);g=b.length;c=z}else if(y(c))if(g<b.length)h=b[g],g++,k=Ub(k,c[1],h),c=c[2];else return e();else return e();return b.length!==g?e():[6,k,f]}
function Rb(a,b,c){function e(){return[4,F,N(Cb,N(a,P(b)))]}for(var f=0;f<cc.length;f++){var k=cc[f];if(X(a,k[0])){if(b.length!==k[1])break;return 1===k[1]?k[2](b[0],e,c):2===k[1]?k[2](b[0],b[1],e,c):3===k[1]?k[2](b[0],b[1],b[2],e,c):n()}}return e()}function Qb(a,b,c){function e(){return[4,F,N(Db,N(Xb(a),b,P(c)))]}return X(b,Ab)?1!==c.length?e():c[0]:X(b,Bb)?2!==c.length?e():dc(a,c[0],c[1],e):X(b,Gb)?2!==c.length?e():[11,c[0],[6,a,c[1]]]:e()}
function dc(a,b,c,e){b=ua(b);for(var f=[],k=!1,g=b;!A(g);)if(t(g)||B(g))f.push(g),k=!0,g=z;else if(y(g))f.push(g[1]),g=g[2];else return e();g=k?P(f):b;var h=[];Yb(a,function(l){for(var m=0;m<f.length;m++)if(X(f[m],l))return;h.push(l)});e=g;for(k=h.length-1;0<=k;k--)e=[1,h[k],e];for(k=h.length-1;0<=k;k--)g=ha(N(Db,Ab,Wb(a,h[k])),g);return[3,I,N(b,[1,N(Db,Ab,[3,I,N(e,c)]),g])]}
function X(a,b){function c(e,f,k,g){return X(k(e),k(f))&&X(g(e),g(f))?(x(e,f),!0):!1}if(a===b)return!0;a=E(a);b=E(b);if(a===b)return!0;if(A(a)){if(!A(b))return!1;x(a,z);x(b,z);return!0}return t(a)?t(b)?v(a,b):!1:y(a)?y(b)?c(a,b,ia,ja):!1:C(a)?C(b)?c(a,b,oa,qa):!1:B(a)?B(b)?c(a,b,la,ma):!1:n()}exports.equal_p=X;
function Y(a,b){function c(e,f,k,g){return Y(k(e),k(f))&&Y(g(e),g(f))?(x(e,f),!0):!1}if(a===b)return!0;a=R(a);b=R(b);if(a===b)return!0;if(A(a)){if(!A(b))return!1;x(a,z);x(b,z);return!0}return t(a)?t(b)?v(a,b):!1:y(a)?y(b)?c(a,b,ia,ja):!1:C(a)?C(b)?c(a,b,oa,qa):!1:B(a)?B(b)?c(a,b,la,ma):!1:Nb(a)?!1:n()}
function V(a){a=R(a);var b;if(A(a))return"()";if(y(a)){var c="(";for(b="";y(a);)c+=b+V(a[1]),b=" ",a=R(a[2]);return c=A(a)?c+")":c+(" . "+V(a)+")")}return B(a)?"#"+V([1,a[1],a[2]]):C(a)?"!"+V([1,a[1],a[2]]):t(a)?fa(a):q(a)?";("+V(a[1])+" "+V(a[2])+")":6===a[0]?"$("+V(Xb(a[1]))+" "+V(a[2])+")":7===a[0]?"%("+V(a[1])+" "+V(P(a[2]))+")":8===a[0]?"@("+V(Xb(a[1]))+" "+V(a[2])+" "+V(P(a[3]))+")":9===a[0]?"^("+V(a[1])+" "+V(P(a[2]))+")":n()}exports.simple_print=V;
function ec(a){function b(){return $a.length===za}function c(){!b()||n();var d=$a[za];za++;return d}function e(d){$a[za-1]===d||n();za--}function f(d){void 0===d&&(d="");throw"TheLanguage parse ERROR!"+d;}function k(d){return" "===d||"\n"===d||"\t"===d||"\r"===d}function g(){if(b())return!1;var d=c();if(!k(d))return e(d),!1;for(;k(d)&&!b();)d=c();k(d)||e(d);return!0}function h(){if(b())return!1;var d=c(),p="";if(!W(d))return e(d),!1;for(;W(d)&&!b();)p+=d,d=c();W(d)?p+=d:e(d);return ea(p)?u(p):f("Not Symbol"+
p)}function l(){if(b())return!1;var d=c();if("("!==d)return e(d),!1;for(var p=[10],r=p;;){g();if(b())return f();d=c();if(")"===d)return xa(p,z),r;if("."===d){g();d=pa();xa(p,d);g();if(b())return f();d=c();return")"!==d?f():r}e(d);d=pa();var H=[10];xa(p,[1,d,H]);p=H}}function m(){if(b())return!1;var d=c();if("#"!==d)return e(d),!1;d=l();return!1!==d&&y(d)?[3,d[1],d[2]]:f()}function w(){if(b())return!1;var d=c();if("!"!==d)return e(d),!1;d=l();return!1!==d&&y(d)?[4,d[1],d[2]]:f()}function G(d,p){return function(){if(b())return!1;
var r=c();if(r!==d)return e(r),!1;r=l();if(!1===r||!y(r))return f();var H=r[2];return y(H)&&A(H[2])?p(r[1],H[1]):f()}}function W(d){if(k(d))return!1;for(var p=0,r="()!#.$%^@~/->_:?[]&;".split("");p<r.length;p++)if(r[p]===d)return!1;return!0}function pa(){g();for(var d=0,p=[l,lc,m,w,ab,bb,cb,db,eb];d<p.length;d++){var r=(0,p[d])();if(!1!==r)return r}return f()}function L(d){return!1===d?f():d}function Q(d){L(!b());L(c()===d)}function T(d){function p(){Q("[");var Aa=T();Q("]");return Aa}void 0===d&&
(d=!1);var r=0;for(d=d?[l,h,p,m,w,ab,bb,cb,db,eb]:[l,Kb,m,w,ab,bb,cb,db,eb];r<d.length;r++){var H=(0,d[r])();if(!1!==H)return H}return f()}function Lb(d){if(b())return d;var p=c();if("."===p)return p=T(),N(M,N(I,N(d),K),p);if(":"===p)return p=T(),N(M,p,d);if("~"===p)return N(Ga,d);if("@"===p)return p=T(),N(M,N(I,[1,d,K],K),p);if("?"===p)return N(M,I,N(Ga,d));if("/"===p){for(d=[d];;){p=T(!0);d.push(p);if(b())break;p=c();if("/"!==p){e(p);break}}return N(Ha,P(d))}e(p);return d}function Kb(){if(b())return!1;
var d=c();if("&"===d){L(!b());d=c();if("+"===d)return d=T(),N(J,N(F,d));e(d);d=T();return N(J,d)}if(":"===d){L(!b());d=c();if("&"===d)return Q(">"),d=T(),N(M,N(J,N(I,K,d)),Da);if(">"===d)return d=T(),N(M,N(I,K,d),Da);e(d);d=T();return N(M,d,Da)}if("+"===d)return d=T(),N(F,d);if("["===d)return d=T(),Q("]"),Lb(d);if("_"===d)return Q(":"),d=T(),N(M,d,K);e(d);d=h();return!1===d?!1:Lb(d)}function lc(){var d=Kb();return!1===d?!1:t(d)?d:O(d)}var $a=a,za=0,ab=G("$",function(d,p){var r=Zb(d);return!1===r?
f():[6,r,p]}),bb=G("%",function(d,p){var r=Jb(p,function(H){return H},function(){return f()});return[7,d,r]}),cb=function(d,p){return function(){if(b())return!1;var r=c();if(r!==d)return e(r),!1;r=l();if(!1===r||!y(r))return f();var H=r[2];if(!y(H))return f();var Aa=H[2];return y(Aa)&&A(Aa[2])?p(r[1],H[1],Aa[1]):f()}}("@",function(d,p,r){r=Jb(r,function(H){return H},function(){return f()});d=Zb(d);return!1===d?f():[8,d,p,r]}),db=G("^",function(d,p){var r=Jb(p,function(H){return H},function(){return f()});
return[9,d,r]}),eb=G(";",function(d,p){return[11,d,p]});return pa()}exports.complex_parse=ec;
function Z(a){function b(f,k){function g(G){return k?"["+G+"]":G}if(t(f))return fa(f);var h=Mb(f);if(!1!==h&&3===h.length&&Y(h[0],M)){var l=Mb(h[1]);if(!1!==l&&3===l.length&&Y(l[0],I)){var m=l[1],w=Mb(m);if(!1!==w&&1===w.length&&Y(l[2],K))return g(b(w[0],!0)+"."+b(h[2],!0));if(y(m)&&Y(m[2],K)&&Y(l[2],K))return g(b(m[1],!0)+"@"+b(h[2],!0));if(Y(m,K)&&Y(h[2],Da))return g(":>"+b(l[2],!0))}m=Mb(h[2]);if(Y(h[1],I)&&!1!==m&&2===m.length&&Y(m[0],Ga))return g(b(m[1],!0)+"?");if(!1!==l&&2===l.length&&Y(h[2],
Da)&&Y(l[0],J)&&(l=Mb(l[1]),!1!==l&&3===l.length&&Y(l[0],I)&&Y(l[1],K)))return g(":&>"+b(l[2],!0));l=void 0;l=Y(h[2],K)?"_":Y(h[2],Da)?"":b(h[2],!0);return g(l+":"+b(h[1],!0))}if(!1!==h&&2===h.length){if(Y(h[0],J))return l=Mb(h[1]),!1!==l&&2===l.length&&Y(l[0],F)?g("&+"+b(l[1],!0)):g("&"+b(h[1],!0));if(Y(h[0],Ga))return g(b(h[1],!0)+"~");if(Y(h[0],F))return g("+"+b(h[1],!0));if(Y(h[0],Ha)&&(h=Mb(h[1]),!1!==h&&1<h.length)){l=b(h[0],!0);for(m=1;m<h.length;m++)l+="/"+b(h[m],!0);return g(l)}}return k?
V(f):V(O(f))}a=ec(V(a));var c="",e="";if(A(a))return"()";if(y(a)){c="(";for(e="";y(a);)c+=e+Z(a[1]),e=" ",a=a[2];return c=A(a)?c+")":c+(" . "+Z(a)+")")}return B(a)?(c=a[1],a=a[2],e=Mb(a),!1!==e&&2===e.length&&Y(c,ya)&&Y(e[0],F)?b(e[1],!1):"#"+Z([1,c,a])):C(a)?"!"+Z([1,a[1],a[2]]):t(a)?fa(a):q(a)?";("+Z(a[1])+" "+Z(a[2])+")":6===a[0]?"$("+Z(Xb(a[1]))+" "+Z(a[2])+")":7===a[0]?"%("+Z(a[1])+" "+Z(P(a[2]))+")":8===a[0]?"@("+Z(Xb(a[1]))+" "+Z(a[2])+" "+Z(P(a[3]))+")":9===a[0]?"^("+Z(a[1])+" "+Z(P(a[2]))+
")":n()}exports.complex_print=Z;
exports.machinetext_parse=function(a){function b(m){void 0===m&&(m="");throw"MT parse ERROR "+m;}function c(m){if(!m)return b()}function e(){c(0!==k);k--;return a[k]}function f(m){var w=g.pop(),G=g.pop();return void 0===G||void 0===w?b():g.unshift(m(G,w))}for(var k=a.length,g=[];0!==k;){var h=e();if("^"===h){for(h="";;){var l=e();if("^"===l)break;h=l+h}if(h in ba())g.unshift([0,h]);else return b('can_new_symbol_unicodechar_p("'+h+'") == false')}else if("."===h)f(ha);else if("#"===h)f(ka);else if("!"===
h)f(na);else if("$"===h)f(function(m,w){var G=Zb(m);return!1===G?b():[6,G,w]});else if("_"===h)g.unshift(z);else return b()}c(0===k);c(1===g.length);return g[0]};
exports.machinetext_print=function(a){function b(){for(var f=[],k=0,g=c;k<g.length;k++){var h=g[k];h=R(h);var l=function(m,w,G,W){e+=w;return f.push(G(m),W(m))};if(t(h))e+="^"+h[1]+"^";else if(y(h))l(h,".",ia,ja);else if(A(h))e+="_";else if(B(h))l(h,"#",la,ma);else if(C(h))l(h,"!",oa,qa);else if(Nb(h))h=Ob(h),l(h,"$",function(m){return Xb(m[1])},sa);else return{value:n()}}c=f}for(var c=[a],e="";0!==c.length;)if(a=b(),"object"===typeof a)return a.value;return e};exports.Trampoline=function(){};
function fc(a){return function(){return[!1,a]}}exports.trampoline_return=fc;function gc(a){return function(){return[!0,a()]}}exports.trampoline_delay=gc;function hc(a){for(a=a();a[0];)a=a[1]();return a[1]}exports.run_trampoline=hc;var ic=O([1,Ha,[1,[1,Wa,[1,[1,M,[1,Ua,[1,K,z]]],z]],z]]);exports.return_effect_systemName=ic;var jc=O([1,Ha,[1,[1,Wa,[1,Na,z]],z]]);exports.bind_effect_systemName=jc;exports.new_effect_bind=function(a,b){return[3,jc,N(a,b)]};
exports.new_effect_return=function(a){return[3,ic,a]};
function kc(a,b,c,e,f){void 0===f&&(f=!1);c=E(c);if(B(c)){var k=c[1],g=c[2];if(X(k,ic)){if(g=E(g),y(g)&&(k=g[1],g=E(g[2]),A(g))){if(!1===f){var h=k;k=function(){return a(h,e)}}else{var l=k;k=function(){return kc(a,b,[9,f,l],e)}}return gc(k)}}else if(X(k,jc)&&(g=E(g),y(g)&&(k=g[1],g=E(g[2]),y(g)))){var m=g[1];g=E(g[2]);if(A(g)){if(!1===f){var w=k;k=function(){return kc(a,b,w,e,m)}}else u("\u5e8f\u7532"),k=function(){throw"WIP";};return gc(k)}}}return!1===f?gc(function(){return b(c,e,a)}):gc(function(){return b(c,
e,function(G,W){return gc(function(){return kc(a,b,ta(f,[G]),W)})})})}exports.run_monad_trampoline=function(a,b,c,e){return kc(a,b,c,e)};exports.run_monad_stackoverflow=function(a,b,c,e){return hc(kc(function(f,k){return fc(a(f,k))},function(f,k,g){return fc(b(f,k,function(h,l){return hc(g(h,l))}))},c,e))};
