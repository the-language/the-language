function h(){throw"TheLanguage PANIC";}exports.new_symbol=function(a){return[0,a]};function q(a){return 0===a[0]}exports.symbol_p=q;exports.un_symbol=function(a){return a[1]};function aa(a,b){return[1,a,b]}exports.new_construction=aa;function v(a){return 1===a[0]}exports.construction_p=v;function ba(a){return a[1]}exports.construction_head=ba;function ca(a){return a[2]}exports.construction_tail=ca;var w=[2];exports.null_v=w;function x(a){return 2===a[0]}exports.null_p=x;
function ea(a,b){return[3,a,b]}exports.new_data=ea;function y(a){return 3===a[0]}exports.data_p=y;function fa(a){return a[1]}exports.data_name=fa;function ia(a){return a[2]}exports.data_list=ia;function ja(a,b){return[4,a,b]}exports.new_error=ja;function z(a){return 4===a[0]}exports.error_p=z;function ka(a){return a[1]}exports.error_name=ka;function la(a){return a[2]}exports.error_list=la;function A(a,b){a!==b&&(a[0]=5,a[1]=b,a[2]=!1,a[3]=!1)}exports.evaluate=function(a,b){return[6,a,b]};
function B(a,b){return[7,a,b]}exports.apply=function(a,b){return[9,a,b]};function C(a){a=D(a);if(y(a)){var b=a[1],c=a[2];a[1]=C(b);a[2]=C(c)}else z(a)?(b=a[1],c=a[2],a[1]=C(b),a[2]=C(c)):v(a)&&(b=a[1],c=a[2],a[1]=C(b),a[2]=C(c));return a}exports.force_all_rec=C;
var E=[0,"\u592a\u59cb\u521d\u6838"],ma=[0,"\u7b26\u540d"],F=[0,"\u5316\u6ec5"],H=[0,"\u5f0f\u5f62"],J=[0,"\u7279\u5b9a\u5176\u7269"],K=[0,"\u7701\u7565\u4e00\u7269"],na=[0,"\u6620\u8868"],L=[0,"\u4e00\u985e\u4f55\u7269"],oa=[0,"\u662f\u975e"],pa=[0,"\u5176\u5b50"],qa=[0,"\u967d"],ra=[0,"\u9670"],sa=[0,"\u9023"],ta=[0,"\u69cb"],ua=[0,"\u8aa4"],wa=[0,"\u5217"],xa={"\u4e19":!0,"\u4e59":!0,"\u7701\u7565\u4e00\u7269":!0,"\u89e3\u7b97":!0,"\u82e5":!0,"\u662f\u975e":!0,"\u5f15\u7528":!0,"\u5316\u6ec5":!0,
"\u7b49\u540c":!0,"\u7532":!0,"\u61c9\u7528":!0,A:!0,l:!0,"\u6620\u8868":!0,v:!0,6:!0,E:!0,N:!0,U:!0,Q:!0,x:!0,5:!0,D:!0,1:!0,a:!0,0:!0,"\u9670":!0,"\u7b26\u540d":!0,e:!0,t:!0,4:!0,"\u7269":!0,P:!0,y:!0,V:!0,F:!0,d:!0,"\u5217":!0,"\u8a5e\u7d20":!0,"\u7a7a":!0,"\u4e01":!0,"\u592a\u59cb\u521d\u6838":!0,"\u70ba\u7b26\u540d\u9023":!0,"\u7279\u5b9a\u5176\u7269":!0,"\u6548\u61c9":!0,"\u9996":!0,"\u9023":!0,"\u81ea":!0,"\u53c3\u5f62":!0,h:!0,g:!0,R:!0,r:!0,c:!0,J:!0,2:!0,"\u967d":!0,i:!0,X:!0,8:!0,"\u5176\u5b50":!0,
f:!0,O:!0,u:!0,T:!0,"\u4e00\u985e\u4f55\u7269":!0,q:!0,m:!0,b:!0,K:!0,p:!0,"\u51fa\u5165\u6539\u6ec5":!0,Y:!0,H:!0,n:!0,G:!0,W:!0,"\u8aa4":!0,L:!0,j:!0,9:!0,C:!0,o:!0,w:!0,7:!0,I:!0,M:!0,s:!0,3:!0,z:!0,Z:!0,S:!0,k:!0,B:!0,"\u5f0f\u5f62":!0,"\u69cb":!0,"\u5c3e":!0,"\u5b87\u5b99\u4ea1\u77e3":!0},ya=[4,E,M([0,"\u5b87\u5b99\u4ea1\u77e3"],K)];function O(a){return[3,ma,M(E,a)]}function za(a){return O(M(L,M(F,K,a),J))}function Aa(a,b){return O(M(L,M(F,M(a),K),b))}
function Ba(a){return O(M(L,F,M(oa,M(L,a,K))))}
var Ca=za(ta),Da=Aa(ta,ma),Ea=Aa(ta,wa),Fa=Ba(ta),Ga=za(ua),Ha=Aa(ua,ma),Ia=Aa(ua,wa),Ja=Ba(ua),Ka=za(sa),La=Ba(sa),Ra=Aa(sa,[0,"\u9996"]),Sa=Aa(sa,[0,"\u5c3e"]),Ta=Ba([0,"\u8a5e\u7d20"]),Ua=Ba([0,"\u7a7a"]),Va=O(M(L,F,M(oa,[0,"\u7b49\u540c"]))),Wa=O(M(L,M(F,[1,F,K],K),[0,"\u61c9\u7528"])),Xa=O(M(L,F,[0,"\u89e3\u7b97"])),Ya=Aa(wa,M(L,[0,"\u7269"],K)),Za=O(M(L,F,[0,"\u82e5"])),$a=O(M(L,H,[0,"\u5f15\u7528"])),ab=O(M(L,M(H,M(F,K,F)),J)),bb=O(M(H,M(E,F))),cb=O(M(H,M(E,H))),db=O(M(H,H)),eb=[3,ra,M()],
fb=[3,qa,M()];function gb(a,b){return a===b?!0:a[1]===b[1]?(A(a,b),!0):!1}function P(a){for(var b=w,c=a.length-1;0<=c;c--)b=[1,a[c],b];return b}exports.jsArray_to_list=P;function hb(a,b,c){for(var d=[];v(a);)d.push(a[1]),a=a[2];return x(a)?b(d):c(d,a)}function Q(a){return hb(a,function(b){return b},function(){return!1})}exports.maybe_list_to_jsArray=Q;function M(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return P(a)}exports.new_list=M;
function ib(a){for(var b=[];5===a[0];)b.push(a),a=a[1];for(var c=0;c<b.length;c++)A(b[c],a);return a}function R(a){return 5===a[0]||6===a[0]||8===a[0]||7===a[0]||9===a[0]}exports.delay_p=R;
function D(a,b,c,d){function e(G){A(t,G);for(var N=0;N<d.length;N++)A(d[N],G);return G}function k(){c[1]=!0;return l(ya)}function l(G){e(G);return R(G)?(d.push(t),D(G,b,[!1,!1],d)):G}function m(){var G={},N;for(N in n)G[N]=!0;for(N in b)G[N]=!0;return G}void 0===b&&(b={});void 0===c&&(c=[!1,!1]);void 0===d&&(d=[]);for(var n={},t=a;R(t);){a=S(t);if(!0===b[a])return k();if(!0===n[a]){c[0]=!0;if(6===t[0])return k();if(7===t[0]){a=t[1];for(var I=t[2],X=[Da,Ea,Fa,Ha,Ia,Ja,La,Ra,Sa,Ta,Ua],ha=!1,da=0;da<
X.length;da++)U(X[da],a)&&(ha=!0);if(ha)return 1===I.length||h(),!1===c[1]||h(),I=D(I[0],m(),c),c[1]?l(B(a,[I])):h();if(U(a,Va)||U(a,Wa)||U(a,Xa))return k();if(U(a,Za)&&(3===I.length||h(),!1===c[1]||h(),a=D(I[0],m(),c),c[1]))return l(B(Za,[a,I[1],I[2]]))}else if(8===t[0]||9===t[0])return k();return h()}n[a]=!0;d.push(t);t=V(t)}return e(t)}exports.force_all=D;
function V(a){var b=ib(a);5!==b[0]||h();if(6===b[0])a=jb(b[1],b[2],a);else if(8===b[0]){a=b[1];var c=b[2],d=b[3],e=[4,E,M(cb,M(W(a),c,P(d)))];a=U(c,$a)?1!==d.length?e:d[0]:U(c,ab)?2!==d.length?e:kb(a,d[0],d[1],e):e}else if(7===b[0])a:{e=b[1];a=b[2];c=[4,E,M(bb,M(e,P(a)))];for(d=0;d<lb.length;d++)if(U(e,lb[d][0])){e=lb[d][1];if(a.length!==e)break;d=lb[d][2];a=1===e?d(a[0],c):2===e?d(a[0],a[1],c):3===e?d(a[0],a[1],a[2],c):h();break a}a=c}else a=9===b[0]?ob(b[1],b[2],a):b;a=ib(a);A(b,a);return a}
exports.force1=V;var pb=[];exports.env_null_v=pb;function qb(a,b,c){for(var d=[],e=0;e<a.length;e+=2){if(U(a[e+0],b)){d[e+0]=b;d[e+1]=c;for(e+=2;e<a.length;e+=2)d[e+0]=a[e+0],d[e+1]=a[e+1];return d}d[e+0]=a[e+0];d[e+1]=a[e+1]}d[a.length+0]=b;d[a.length+1]=c;return d}exports.env_set=qb;function rb(a,b,c){for(var d=0;d<a.length;d+=2)if(U(a[d+0],b))return a[d+1];return c}exports.env_get=rb;function sb(a,b){for(var c=0;c<a.length;c+=2)if(U(a[c+0],b))return a[c+1];return h()}
function W(a){for(var b=w,c=0;c<a.length;c+=2)b=[1,M(a[c+0],a[c+1]),b];return[3,na,M(b)]}exports.env2val=W;function tb(a,b){for(var c=0;c<a.length;c+=2)b(a[c+0],a[c+1])}exports.env_foreach=tb;
function ub(a){a=D(a);if(!y(a))return!1;var b=D(a[1]);if(!q(b)||!gb(b,na))return!1;b=D(a[2]);if(!v(b)||!x(D(b[2])))return!1;a=[];for(b=D(b[1]);!x(b);){if(!v(b))return!1;var c=D(b[1]);b=D(b[2]);if(!v(c))return!1;var d=c[1];c=D(c[2]);if(!v(c))return!1;var e=c[1];if(!x(D(c[2])))return!1;c=!0;for(var k=0;k<a.length;k+=2)if(U(a[k+0],d)){a[k+1]=e;c=!1;break}c&&(a.push(d),a.push(e))}return a}exports.val2env=ub;
function jb(a,b,c){var d=V(b);if(R(d))return c;var e=[4,E,M(bb,M(Xa,M(W(a),d)))];if(v(d)){for(b=[];!x(d);){if(R(d))return c;if(v(d))b.push(d[1]),d=V(d[2]);else return e}if(U(b[0],cb)){if(1===b.length)return e;d=b[1];c=[];for(e=2;e<b.length;e++)c[e-2]=b[e];return[8,a,d,c]}if(U(b[0],db)){if(1===b.length)return e;d=D([6,a,b[1]]);if(!y(d))return e;var k=V(d[1]);if(R(k))return c;if(!q(k)||!gb(k,H))return e;k=V(d[2]);if(R(k))return c;if(!v(k))return e;d=k[1];k=V(k[2]);if(R(k))return c;if(!x(k))return e;
c=[W(a)];for(e=2;e<b.length;e++)c[e-1]=b[e];return[9,d,c]}if(U(b[0],bb)){if(1===b.length)return e;d=b[1];c=[];for(e=2;e<b.length;e++)c[e-2]=[6,a,b[e]];return[7,d,c]}d=[6,a,b[0]];c=[];for(e=1;e<b.length;e++)c[e-1]=[6,a,b[e]];return[9,d,c]}return x(d)?d:q(d)||y(d)?rb(a,d,e):z(d)?e:h()}function vb(a,b){return[a,1,function(c){c=V(c);return R(c)?B(a,[c]):b(c)?fb:eb}]}function wb(a,b,c){return[a,1,function(d,e){d=V(d);return R(d)?B(a,[d]):b(d)?c(d):e}]}
var lb=[vb(Fa,y),[Ca,2,ea],wb(Da,y,fa),wb(Ea,y,ia),vb(Ja,z),[Ga,2,ja],wb(Ha,z,ka),wb(Ia,z,la),vb(Ua,x),[Ka,2,aa],vb(La,v),wb(Ra,v,ba),wb(Sa,v,ca),[Va,2,function(a,b){function c(d,e,k,l){k=B(Va,[k(d),k(e)]);d=B(Va,[l(d),l(e)]);return B(Za,[k,d,eb])}if(a===b)return fb;a=V(a);b=V(b);if(R(a)||R(b))return B(Va,[a,b]);if(a===b)return fb;!R(a)||h();return x(a)?x(a)?fb:eb:q(a)?q(b)?gb(a,b)?fb:eb:eb:y(a)?y(b)?c(a,b,fa,ia):eb:v(a)?v(b)?c(a,b,ba,ca):eb:z(a)?z(b)?c(a,b,ka,la):eb:h()}],[Wa,2,function(a,b,c){var d=
[];for(b=D(b);v(b);)d.push(b[1]),b=D(b[2]);return x(b)?[9,a,d]:c}],[Xa,2,function(a,b,c){a=ub(a);return!1===a?c:[6,a,b]}],vb(Ta,q),[Ya,1,function(a,b){a=V(a);return R(a)?B(Ya,[a]):v(a)?a[1]:b}],[Za,3,function(a,b,c,d){a=V(a);if(R(a))return B(Za,[a,b,c]);if(!y(a))return d;a=D(a[1]);return q(a)?gb(a,qa)?b:gb(a,ra)?c:d:d}]];
function ob(a,b,c){function d(){return[4,E,M(bb,M(Wa,M(a,P(b))))]}a=V(a);if(R(a))return c;if(!y(a))return d();c=D(a[1]);if(!q(c)||!gb(c,F))return d();var e=D(a[2]);if(!v(e))return d();c=C(e[1]);e=D(e[2]);if(!v(e)||!x(D(e[2])))return d();e=e[1];for(var k=pb,l=0;!x(c);)if(q(c)||y(c)){for(var m=w,n=b.length-1;n>=l;n--)m=[1,b[n],m];k=qb(k,c,m);l=b.length;c=w}else if(v(c))if(l<b.length)m=b[l],l++,k=qb(k,c[1],m),c=c[2];else return d();else return d();return b.length!==l?d():[6,k,e]}
function kb(a,b,c,d){void 0===d&&(d=!1);b=C(b);for(var e=[],k=!1,l=b;!x(l);)if(q(l)||y(l))e.push(l),k=!0,l=w;else if(v(l))e.push(l[1]),l=l[2];else return!1===d?ja(E,M(cb,M(W(a),ab,P([b,c])))):d;d=b;k&&(d=P(e));var m=[];tb(a,function(n){for(var t=0;t<e.length;t++)if(U(e[t],n))return;m.push(n)});k=d;for(l=m.length-1;0<=l;l--)k=[1,m[l],k];for(l=m.length-1;0<=l;l--)d=aa(M(cb,$a,sb(a,m[l])),d);return[3,F,M(b,[1,M(cb,$a,[3,F,M(k,c)]),d])]}
function U(a,b){function c(d,e,k,l){return U(k(d),k(e))&&U(l(d),l(e))?(A(d,e),!0):!1}if(a===b)return!0;a=D(a);b=D(b);if(a===b)return!0;if(x(a)){if(!x(b))return!1;A(a,w);A(b,w);return!0}return q(a)?q(b)?gb(a,b):!1:v(a)?v(b)?c(a,b,ba,ca):!1:z(a)?z(b)?c(a,b,ka,la):!1:y(a)?y(b)?c(a,b,fa,ia):!1:h()}exports.equal_p=U;
function Y(a,b){function c(d,e,k,l){return Y(k(d),k(e))&&Y(l(d),l(e))?(A(d,e),!0):!1}if(a===b)return!0;a=ib(a);b=ib(b);if(a===b)return!0;if(x(a)){if(!x(b))return!1;A(a,w);A(b,w);return!0}return q(a)?q(b)?gb(a,b):!1:v(a)?v(b)?c(a,b,ba,ca):!1:z(a)?z(b)?c(a,b,ka,la):!1:y(a)?y(b)?c(a,b,fa,ia):!1:6===a[0]||7===a[0]||8===a[0]||9===a[0]?!1:h()}
function S(a){a=ib(a);var b;if(x(a))return"()";if(v(a)){var c="(";for(b="";v(a);)c+=b+S(a[1]),b=" ",a=ib(a[2]);return c=x(a)?c+")":c+(" . "+S(a)+")")}return y(a)?"#"+S([1,a[1],a[2]]):z(a)?"!"+S([1,a[1],a[2]]):q(a)?a[1]:6===a[0]?"$("+S(W(a[1]))+" "+S(a[2])+")":7===a[0]?"%("+S(a[1])+" "+S(P(a[2]))+")":8===a[0]?"@("+S(W(a[1]))+" "+S(a[2])+" "+S(P(a[3]))+")":9===a[0]?"^("+S(a[1])+" "+S(P(a[2]))+")":h()}exports.simple_print=S;exports.simple_print_force_all_rec=function(a){return S(C(a))};
function xb(a){function b(){return Ma.length===va}function c(){!b()||h();var f=Ma[va];va++;return f}function d(f){Ma[va-1]===f||h();va--}function e(f){void 0===f&&(f="");throw"TheLanguage parse ERROR!"+f;}function k(f){return" "===f||"\n"===f||"\t"===f||"\r"===f}function l(){if(b())return!1;var f=c();if(!k(f))return d(f),!1;for(;k(f)&&!b();)f=c();k(f)||d(f);return!0}function m(){if(b())return!1;var f=c(),p="";if(!ha(f))return d(f),!1;for(;ha(f)&&!b();)p+=f,f=c();ha(f)?p+=f:d(f);p in xa||e("Not Symbol"+
p);return[0,p]}function n(){function f(u){if(r===g)r=u;else{for(var T=r;;){if(!v(T))return h();if(T[2]===g)break;T=T[2]}if(!v(T)||T[2]!==g)return h();T[2]=u}}if(b())return!1;var p=c();if("("!==p)return d(p),!1;for(var g=[0,"!!@@READ||HOLE@@!!"],r=g;;){l();if(b())return e();p=c();if(")"===p)return f(w),r;if("."===p){l();p=da();f(p);l();if(b())return e();p=c();return")"!==p?e():r}d(p);p=da();f([1,p,g])}}function t(){if(b())return!1;var f=c();if("#"!==f)return d(f),!1;f=n();return!1!==f&&v(f)?[3,f[1],
f[2]]:e()}function I(){if(b())return!1;var f=c();if("!"!==f)return d(f),!1;f=n();return!1!==f&&v(f)?[4,f[1],f[2]]:e()}function X(f,p){return function(){if(b())return!1;var g=c();if(g!==f)return d(g),!1;g=n();if(!1===g||!v(g))return e();var r=g[2];return v(r)&&x(r[2])?p(g[1],r[1]):e()}}function ha(f){if(k(f))return!1;for(var p="()!#.$%^@~/->_:?[]&".split(""),g=0;g<p.length;g++)if(f===p[g])return!1;return!0}function da(){l();for(var f=[n,yb,t,I,Na,Oa,Pa,Qa],p=0;p<f.length;p++){var g=f[p]();if(!1!==
g)return g}return e()}function G(f){return!1===f?e():f}function N(f){G(!b());G(c()===f)}function mb(){function f(r){function u(){N("[");var zb=f();N("]");return zb}void 0===r&&(r=!1);r=r?[n,m,u,t,I,Na,Oa,Pa,Qa]:[n,mb,t,I,Na,Oa,Pa,Qa];for(var T=0;T<r.length;T++){var nb=r[T]();if(!1!==nb)return nb}return e()}function p(r){if(b())return r;var u=c();if("."===u)return u=f(),M(L,M(F,M(r),K),u);if(":"===u)return u=f(),M(L,u,r);if("~"===u)return M(oa,r);if("@"===u)return u=f(),M(L,M(F,[1,r,K],K),u);if("?"===
u)return M(L,F,M(oa,r));if("/"===u){for(r=[r];;){u=f(!0);r.push(u);if(b())break;u=c();if("/"!==u){d(u);break}}return M(pa,P(r))}d(u);return r}if(b())return!1;var g=c();if("&"===g){G(!b());g=c();if("+"===g)return g=f(),M(H,M(E,g));d(g);g=f();return M(H,g)}if(":"===g){G(!b());g=c();if("&"===g)return N(">"),g=f(),M(L,M(H,M(F,K,g)),J);if(">"===g)return g=f(),M(L,M(F,K,g),J);d(g);g=f();return M(L,g,J)}if("+"===g)return g=f(),M(E,g);if("["===g)return g=f(),N("]"),p(g);if("_"===g)return N(":"),g=f(),M(L,
g,K);d(g);g=m();return!1===g?!1:p(g)}function yb(){var f=mb();return!1===f?!1:q(f)?f:O(f)}var Ma=a,va=0,Na=X("$",function(f,p){var g=ub(f);return!1===g?e():[6,g,p]}),Oa=X("%",function(f,p){var g=hb(p,function(r){return r},function(){return e()});return[7,f,g]}),Pa=function(f,p){return function(){if(b())return!1;var g=c();if(g!==f)return d(g),!1;g=n();if(!1===g||!v(g))return e();var r=g[2];if(!v(r))return e();var u=r[2];return v(u)&&x(u[2])?p(g[1],r[1],u[1]):e()}}("@",function(f,p,g){g=hb(g,function(r){return r},
function(){return e()});f=ub(f);return!1===f?e():[8,f,p,g]}),Qa=X("^",function(f,p){var g=hb(p,function(r){return r},function(){return e()});return[9,f,g]});return da()}exports.complex_parse=xb;
function Z(a){function b(e,k){function l(X){return"inner"===k?"["+X+"]":"top"===k?X:h()}if(q(e))return e[1];var m=Q(e);if(!1!==m&&3===m.length&&Y(m[0],L)){var n=Q(m[1]);if(!1!==n&&3===n.length&&Y(n[0],F)){var t=n[1],I=Q(t);if(!1!==I&&1===I.length&&Y(n[2],K))return l(b(I[0],"inner")+"."+b(m[2],"inner"));if(v(t)&&Y(t[2],K)&&Y(n[2],K))return l(b(t[1],"inner")+"@"+b(m[2],"inner"));if(Y(t,K)&&Y(m[2],J))return l(":>"+b(n[2],"inner"))}t=Q(m[2]);if(Y(m[1],F)&&!1!==t&&2===t.length&&Y(t[0],oa))return l(b(t[1],
"inner")+"?");if(!1!==n&&2===n.length&&Y(m[2],J)&&Y(n[0],H)&&(n=Q(n[1]),!1!==n&&3===n.length&&Y(n[0],F)&&Y(n[1],K)))return l(":&>"+b(n[2],"inner"));n=Y(m[2],K)?"_":Y(m[2],J)?"":b(m[2],"inner");return l(n+":"+b(m[1],"inner"))}if(!1!==m&&2===m.length){if(Y(m[0],H))return n=Q(m[1]),!1!==n&&2===n.length&&Y(n[0],E)?l("&+"+b(n[1],"inner")):l("&"+b(m[1],"inner"));if(Y(m[0],oa))return l(b(m[1],"inner")+"~");if(Y(m[0],E))return l("+"+b(m[1],"inner"));if(Y(m[0],pa)&&(m=Q(m[1]),!1!==m&&1<m.length)){n=b(m[0],
"inner");for(t=1;t<m.length;t++)n+="/"+b(m[t],"inner");return l(n)}}return"inner"===k?S(e):"top"===k?S(O(e)):h()}a=xb(S(a));var c="",d="";if(x(a))return"()";if(v(a)){c="(";for(d="";v(a);)c+=d+Z(a[1]),d=" ",a=a[2];return c=x(a)?c+")":c+(" . "+Z(a)+")")}return y(a)?(c=a[1],a=a[2],d=Q(a),!1!==d&&2===d.length&&Y(c,ma)&&Y(d[0],E)?b(d[1],"top"):"#"+Z([1,c,a])):z(a)?"!"+Z([1,a[1],a[2]]):q(a)?a[1]:6===a[0]?"$("+Z(W(a[1]))+" "+Z(a[2])+")":7===a[0]?"%("+Z(a[1])+" "+Z(P(a[2]))+")":8===a[0]?"@("+Z(W(a[1]))+" "+
Z(a[2])+" "+Z(P(a[3]))+")":9===a[0]?"^("+Z(a[1])+" "+Z(P(a[2]))+")":h()}exports.complex_print=Z;
