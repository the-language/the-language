function l(){throw"TheLanguage PANIC";}
function aa(){var a={0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",A:"A",B:"B",C:"C",D:"D",E:"E",F:"F",G:"G",H:"H",I:"I",J:"J",K:"K",L:"L",M:"M",N:"N",O:"O",P:"P",Q:"Q",R:"R",S:"S",T:"T",U:"U",V:"V",W:"W",X:"X",Y:"Y",Z:"Z",a:"a",b:"b",c:"c",d:"d",e:"e",f:"f",g:"g",h:"h",i:"i",j:"j",k:"k",l:"l",m:"m",n:"n",o:"o",p:"p",q:"q",r:"r",s:"s",t:"t",u:"u",v:"v",w:"w",x:"x",y:"y",z:"z","\u4e00\u985e\u4f55\u7269":"\u3749","\u4e4b\u7269":"\ud86d\ude66","\u5176\u5b50":"\ud85a\udfaa","\u51fa\u5165\u6539\u6ec5":"\ud849\udc9f",
"\u5217\u5e8f":"\ud841\udf3a","\u5316\u6ec5":"\ud840\udfc1","\u53c3\u5f62":"\ud842\udef0","\u543e\u81ea":"\ud85a\udcf9","\u592a\u59cb\u521d\u6838":"\ud84d\udf57","\u5982\u82e5":"\ud85b\udc61","\u5b87\u5b99\u4ea1\u77e3":"\ud863\ude79","\u5c3e\u672b":"\ud847\udcb5","\u5e8f\u4e01":"\ud840\udda4","\u5e8f\u4e19":"\ud840\uddee","\u5e8f\u4e59":"\u3408","\u5e8f\u7532":"\ud840\uddda","\u5f0f\u5f62":"\u4f71","\u5f15\u7528":"\u39c8","\u61c9\u7528":"\ud853\udc06","\u6548\u61c9":"\u52b9","\u6620\u8868":"\ud850\udd54",
"\u662f\u975e":"\u6b24","\u69cb\u7269":"\ud845\udcab","\u70ba\u7b26\u540d\u9023":"\u2010","\u7279\u5b9a\u5176\u7269":"\u4e93","\u7701\u7565\u4e00\u7269":"\u7567","\u7b26\u540d":"\u8b3c","\u7b49\u540c":"\u5f0c","\u89e3\u7b97":"\u7b6d","\u8a3b\u758f":"\u758e","\u8a5e\u7d20":"\ud85e\udd5d","\u8b2c\u8aa4":"\u4958","\u9023\u9838":"\u4e29","\u9593\u7a7a":"\ud84e\udcd3","\u9670":"\u4f8c","\u967d":"\ud84c\udd84","\u9996\u59cb":"\ud866\udc10"};aa=function(){return a};return a}
function ba(){var a={0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",A:"A",B:"B",C:"C",D:"D",E:"E",F:"F",G:"G",H:"H",I:"I",J:"J",K:"K",L:"L",M:"M",N:"N",O:"O",P:"P",Q:"Q",R:"R",S:"S",T:"T",U:"U",V:"V",W:"W",X:"X",Y:"Y",Z:"Z",a:"a",b:"b",c:"c",d:"d",e:"e",f:"f",g:"g",h:"h",i:"i",j:"j",k:"k",l:"l",m:"m",n:"n",o:"o",p:"p",q:"q",r:"r",s:"s",t:"t",u:"u",v:"v",w:"w",x:"x",y:"y",z:"z","\u3749":"\u4e00\u985e\u4f55\u7269","\ud86d\ude66":"\u4e4b\u7269","\ud85a\udfaa":"\u5176\u5b50","\ud849\udc9f":"\u51fa\u5165\u6539\u6ec5",
"\ud841\udf3a":"\u5217\u5e8f","\ud840\udfc1":"\u5316\u6ec5","\ud842\udef0":"\u53c3\u5f62","\ud85a\udcf9":"\u543e\u81ea","\ud84d\udf57":"\u592a\u59cb\u521d\u6838","\ud85b\udc61":"\u5982\u82e5","\ud863\ude79":"\u5b87\u5b99\u4ea1\u77e3","\ud847\udcb5":"\u5c3e\u672b","\ud840\udda4":"\u5e8f\u4e01","\ud840\uddee":"\u5e8f\u4e19","\u3408":"\u5e8f\u4e59","\ud840\uddda":"\u5e8f\u7532","\u4f71":"\u5f0f\u5f62","\u39c8":"\u5f15\u7528","\ud853\udc06":"\u61c9\u7528","\u52b9":"\u6548\u61c9","\ud850\udd54":"\u6620\u8868",
"\u6b24":"\u662f\u975e","\ud845\udcab":"\u69cb\u7269","\u2010":"\u70ba\u7b26\u540d\u9023","\u4e93":"\u7279\u5b9a\u5176\u7269","\u7567":"\u7701\u7565\u4e00\u7269","\u8b3c":"\u7b26\u540d","\u5f0c":"\u7b49\u540c","\u7b6d":"\u89e3\u7b97","\u758e":"\u8a3b\u758f","\ud85e\udd5d":"\u8a5e\u7d20","\u4958":"\u8b2c\u8aa4","\u4e29":"\u9023\u9838","\ud84e\udcd3":"\u9593\u7a7a","\u4f8c":"\u9670","\ud84c\udd84":"\u967d","\ud866\udc10":"\u9996\u59cb"};ba=function(){return a};return a}
function ca(a,b){return[11,a,b]}exports.new_comment=ca;exports.comment_p=function(a){return 11===a[0]};exports.comment_comment=function(a){return a[1]};exports.comment_x=function(a){return a[2]};function q(a){return 0===a[0]}exports.symbol_p=q;function da(a){return a in aa()}exports.can_new_symbol_p=da;function t(a){return[0,aa()[a]]}exports.new_symbol=t;function ea(a){return ba()[a[1]]}exports.un_symbol=ea;function fa(a,b){return[1,a,b]}exports.new_construction=fa;function u(a){return 1===a[0]}
exports.construction_p=u;function ha(a){return a[1]}exports.construction_head=ha;function ia(a){return a[2]}exports.construction_tail=ia;var v=[2];exports.null_v=v;function x(a){return 2===a[0]}exports.null_p=x;function ja(a,b){return[3,a,b]}exports.new_data=ja;function z(a){return 3===a[0]}exports.data_p=z;function ka(a){return a[1]}exports.data_name=ka;function la(a){return a[2]}exports.data_list=la;function ma(a,b){return[4,a,b]}exports.new_error=ma;function A(a){return 4===a[0]}
exports.error_p=A;function na(a){return a[1]}exports.error_name=na;function oa(a){return a[2]}exports.error_list=oa;function pa(a){return 5===a[0]}exports.just_p=pa;exports.evaluate=function(a,b){return[6,a,b]};function qa(a){return a[2]}function B(a,b){return[7,a,b]}function ua(a,b){return[9,a,b]}exports.apply=ua;function va(a){a=C(a);if(z(a)||A(a)||u(a))a[1]=va(a[1]),a[2]=va(a[2]);return a}exports.force_all_rec=va;function D(a,b){a!==b&&(a[0]=5,a[1]=b,a[2]=!1,a[3]=!1)}
function wa(a,b){10===a[0]||l();a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3]}
var E=t("\u592a\u59cb\u521d\u6838"),xa=t("\u7b26\u540d"),G=t("\u5316\u6ec5"),I=t("\u5f0f\u5f62"),ya=t("\u7b49\u540c"),za=t("\u89e3\u7b97"),Aa=t("\u7279\u5b9a\u5176\u7269"),K=t("\u7701\u7565\u4e00\u7269"),Ba=t("\u6620\u8868"),Ca=t("\u5982\u82e5"),L=t("\u4e00\u985e\u4f55\u7269"),Ga=t("\u662f\u975e"),Ha=t("\u5176\u5b50"),Ia=t("\u967d"),Ja=t("\u9670"),Ka=t("\u5f15\u7528"),La=t("\u61c9\u7528"),Ma=t("\u9593\u7a7a"),Na=t("\u9023\u9838"),Oa=t("\u69cb\u7269"),Pa=t("\u8b2c\u8aa4"),Qa=t("\u8a5e\u7d20"),Ra=t("\u5217\u5e8f"),
Sa=t("\u9996\u59cb"),Ta=t("\u5c3e\u672b"),Ua=t("\u4e4b\u7269"),Va=t("\u5b87\u5b99\u4ea1\u77e3"),Wa=t("\u6548\u61c9"),Xa=t("\u8a3b\u758f"),Ya=[4,E,M(Va,K)];function O(a){return[3,xa,[1,E,[1,a,v]]]}function Za(a){return O(M(L,M(G,K,a),Aa))}function $a(a,b){return O(M(L,M(G,M(a),K),b))}function ab(a){return O(M(L,G,M(Ga,M(L,a,K))))}
var bb=Za(Oa),gb=$a(Oa,xa),hb=$a(Oa,Ra),ib=ab(Oa),jb=Za(Pa),kb=$a(Pa,xa),lb=$a(Pa,Ra),mb=ab(Pa),nb=Za(Na),ob=ab(Na),pb=$a(Na,Sa),qb=$a(Na,Ta),rb=ab(Qa),sb=ab(Ma),tb=O(M(L,G,M(Ga,ya))),ub=O(M(L,M(G,[1,G,K],K),La)),vb=O(M(L,G,za)),wb=$a(Ra,M(L,Ua,K)),xb=O(M(L,G,Ca)),yb=O(M(L,I,Ka)),zb=O(M(L,M(I,M(G,K,G)),Aa)),Ab=O(M(I,M(E,G))),Bb=O(M(I,M(E,I))),Cb=O(M(I,I)),Db=O(M(L,G,Xa)),Eb=O(M(L,I,Xa)),Fb=[3,Ja,M()],Gb=[3,Ia,M()];function Hb(a,b){return a===b?!0:a[1]===b[1]?(D(a,b),!0):!1}
function P(a){for(var b=v,c=a.length-1;0<=c;c--)b=[1,a[c],b];return b}exports.jsArray_to_list=P;function Ib(a,b,c){for(var d=[];u(a);)d.push(a[1]),a=a[2];return x(a)?b(d):c(d,a)}function Q(a){return Ib(a,function(b){return b},function(){return!1})}exports.maybe_list_to_jsArray=Q;function M(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return P(a)}exports.new_list=M;function Jb(a){for(var b=[];pa(a);)b.push(a),a=a[1];for(var c=0;c<b.length;c++)D(b[c],a);return a}exports.un_just=Jb;
function Kb(a){return 6===a[0]||8===a[0]||7===a[0]||9===a[0]}exports.delay_p=Kb;function R(a){return pa(a)||Kb(a)}exports.delay_just_p=R;function Lb(a){if(6===a[0])return a;if(8===a[0])throw"WIP";if(7===a[0])throw"WIP";if(9===a[0])throw"WIP";return l()}exports.delay_env=function(a){return Lb(a)[1]};exports.delay_x=function(a){return Lb(a)[2]};
function C(a,b,c,d){function f(F){D(n,F);for(var H=0;H<d.length;H++)D(d[H],F);return F}function h(){c[1]=!0;return g(Ya)}function g(F){f(F);return R(F)?(d.push(n),C(F,b,[!1,!1],d)):F}function k(){var F={},H;for(H in m)F[H]=!0;for(H in b)F[H]=!0;return F}void 0===b&&(b={});void 0===c&&(c=[!1,!1]);void 0===d&&(d=[]);var m={},n=a;for(a=0;R(n)&&32>a;a++)d.push(n),n=S(n);for(;R(n);){a=U(n);if(!0===b[a])return h();if(!0===m[a]){c[0]=!0;if(6===n[0])return h();if(7===n[0]){a=n[1];for(var w=n[2],N=!1,T=0,
Z=[gb,hb,ib,kb,lb,mb,ob,pb,qb,rb,sb];T<Z.length;T++)if(V(Z[T],a)){N=!0;break}if(N)return 1===w.length||l(),!1===c[1]||l(),w=C(w[0],k(),c),c[1]?g(B(a,[w])):l();if(V(a,tb)||V(a,ub)||V(a,vb))return h();if(V(a,xb)&&(3===w.length||l(),!1===c[1]||l(),a=C(w[0],k(),c),c[1]))return g(B(xb,[a,w[1],w[2]]))}else if(8===n[0]||9===n[0])return h();return l()}m[a]=!0;d.push(n);n=S(n)}return f(n)}
function S(a){var b=Jb(a);!pa(b)||l();if(6===b[0])a=Mb(b[1],b[2],a);else if(8===b[0]){a=b[1];var c=b[2],d=b[3],f=[4,E,M(Bb,M(W(a),c,P(d)))];a=V(c,yb)?1!==d.length?f:d[0]:V(c,zb)?2!==d.length?f:Nb(a,d[0],d[1],f):V(c,Eb)?2!==d.length?f:[11,d[0],[6,a,d[1]]]:f}else if(7===b[0])a:{f=b[1];a=b[2];c=[4,E,M(Ab,M(f,P(a)))];for(d=0;d<Ob.length;d++)if(V(f,Ob[d][0])){f=Ob[d][1];if(a.length!==f)break;d=Ob[d][2];a=1===f?d(a[0],c):2===f?d(a[0],a[1],c):3===f?d(a[0],a[1],a[2],c):l();break a}a=c}else a=9===b[0]?Pb(b[1],
b[2],a):b;a=Jb(a);D(b,a);return a}exports.force1=S;exports.force_all=function(a){return C(a)};var Qb=[];exports.env_null_v=Qb;function Rb(a,b,c){for(var d=[],f=0;f<a.length;f+=2){if(V(a[f],b)){d[f]=b;d[f+1]=c;for(f+=2;f<a.length;f+=2)d[f]=a[f],d[f+1]=a[f+1];return d}d[f]=a[f];d[f+1]=a[f+1]}d[a.length]=b;d[a.length+1]=c;return d}exports.env_set=Rb;function Sb(a,b,c){for(var d=0;d<a.length;d+=2)if(V(a[d],b))return a[d+1];return c}exports.env_get=Sb;
function Tb(a,b){for(var c=0;c<a.length;c+=2)if(V(a[c],b))return a[c+1];return l()}function W(a){for(var b=v,c=0;c<a.length;c+=2)b=[1,M(a[c],a[c+1]),b];return[3,Ba,M(b)]}exports.env2val=W;function Ub(a,b){for(var c=0;c<a.length;c+=2)b(a[c],a[c+1])}exports.env_foreach=Ub;
function Vb(a){a=C(a);if(!z(a))return!1;var b=C(a[1]);if(!q(b)||!Hb(b,Ba))return!1;b=C(a[2]);if(!u(b)||!x(C(b[2])))return!1;a=[];for(b=C(b[1]);!x(b);){if(!u(b))return!1;var c=C(b[1]);b=C(b[2]);if(!u(c))return!1;var d=c[1];c=C(c[2]);if(!u(c))return!1;var f=c[1];if(!x(C(c[2])))return!1;c=!0;for(var h=0;h<a.length;h+=2)if(V(a[h],d)){a[h+1]=f;c=!1;break}c&&(a.push(d),a.push(f))}return a}exports.val2env=Vb;
function Mb(a,b,c){var d=S(b);if(R(d))return c;var f=[4,E,M(Ab,M(vb,M(W(a),d)))];if(u(d)){for(b=[];!x(d);){if(R(d))return c;if(u(d))b.push(d[1]),d=S(d[2]);else return f}if(V(b[0],Bb)){if(1===b.length)return f;d=b[1];c=[];for(f=2;f<b.length;f++)c.push(b[f]);return[8,a,d,c]}if(V(b[0],Cb)){if(1===b.length)return f;d=C([6,a,b[1]]);if(!z(d))return f;var h=S(d[1]);if(R(h))return c;if(!q(h)||!Hb(h,I))return f;h=S(d[2]);if(R(h))return c;if(!u(h))return f;d=h[1];h=S(h[2]);if(R(h))return c;if(!x(h))return f;
c=[W(a)];for(f=2;f<b.length;f++)c.push(b[f]);return[9,d,c]}if(V(b[0],Ab)){if(1===b.length)return f;d=b[1];c=[];for(f=2;f<b.length;f++)c.push([6,a,b[f]]);return[7,d,c]}d=[6,a,b[0]];c=[];for(f=1;f<b.length;f++)c.push([6,a,b[f]]);return[9,d,c]}return x(d)?d:q(d)||z(d)?Sb(a,d,f):A(d)?f:l()}function Wb(a,b){return[a,1,function(c){c=S(c);return R(c)?B(a,[c]):b(c)?Gb:Fb}]}function Xb(a,b,c){return[a,1,function(d,f){d=S(d);return R(d)?B(a,[d]):b(d)?c(d):f}]}
var Ob=[Wb(ib,z),[bb,2,ja],Xb(gb,z,ka),Xb(hb,z,la),Wb(mb,A),[jb,2,ma],Xb(kb,A,na),Xb(lb,A,oa),Wb(sb,x),[nb,2,fa],Wb(ob,u),Xb(pb,u,ha),Xb(qb,u,ia),[tb,2,function(a,b){function c(d,f,h,g){h=B(tb,[h(d),h(f)]);d=B(tb,[g(d),g(f)]);return B(xb,[h,d,Fb])}if(a===b)return Gb;a=S(a);b=S(b);if(R(a)||R(b))return B(tb,[a,b]);if(a===b)return Gb;!R(a)||l();return x(a)?x(a)?Gb:Fb:q(a)?q(b)?Hb(a,b)?Gb:Fb:Fb:z(a)?z(b)?c(a,b,ka,la):Fb:u(a)?u(b)?c(a,b,ha,ia):Fb:A(a)?A(b)?c(a,b,na,oa):Fb:l()}],[ub,2,function(a,b,c){var d=
[];for(b=C(b);u(b);)d.push(b[1]),b=C(b[2]);return x(b)?[9,a,d]:c}],[vb,2,function(a,b,c){a=Vb(a);return!1===a?c:[6,a,b]}],Wb(rb,q),[wb,1,function(a,b){a=S(a);return R(a)?B(wb,[a]):u(a)?a[1]:b}],[xb,3,function(a,b,c,d){a=S(a);if(R(a))return B(xb,[a,b,c]);if(!z(a))return d;a=C(a[1]);return q(a)?Hb(a,Ia)?b:Hb(a,Ja)?c:d:d}],[Db,2,ca]];
function Pb(a,b,c){function d(){return[4,E,M(Ab,M(ub,M(a,P(b))))]}a=S(a);if(R(a))return c;if(!z(a))return d();c=C(a[1]);if(!q(c)||!Hb(c,G))return d();var f=C(a[2]);if(!u(f))return d();c=va(f[1]);f=C(f[2]);if(!u(f)||!x(C(f[2])))return d();f=f[1];for(var h=Qb,g=0;!x(c);)if(q(c)||z(c)){for(var k=v,m=b.length-1;m>=g;m--)k=[1,b[m],k];h=Rb(h,c,k);g=b.length;c=v}else if(u(c))if(g<b.length)k=b[g],g++,h=Rb(h,c[1],k),c=c[2];else return d();else return d();return b.length!==g?d():[6,h,f]}
function Nb(a,b,c,d){void 0===d&&(d=!1);b=va(b);for(var f=[],h=!1,g=b;!x(g);)if(q(g)||z(g))f.push(g),h=!0,g=v;else if(u(g))f.push(g[1]),g=g[2];else return!1===d?ma(E,M(Bb,M(W(a),zb,P([b,c])))):d;d=b;h&&(d=P(f));var k=[];Ub(a,function(m){for(var n=0;n<f.length;n++)if(V(f[n],m))return;k.push(m)});h=d;for(g=k.length-1;0<=g;g--)h=[1,k[g],h];for(g=k.length-1;0<=g;g--)d=fa(M(Bb,yb,Tb(a,k[g])),d);return[3,G,M(b,[1,M(Bb,yb,[3,G,M(h,c)]),d])]}
function V(a,b){function c(d,f,h,g){return V(h(d),h(f))&&V(g(d),g(f))?(D(d,f),!0):!1}if(a===b)return!0;a=C(a);b=C(b);if(a===b)return!0;if(x(a)){if(!x(b))return!1;D(a,v);D(b,v);return!0}return q(a)?q(b)?Hb(a,b):!1:u(a)?u(b)?c(a,b,ha,ia):!1:A(a)?A(b)?c(a,b,na,oa):!1:z(a)?z(b)?c(a,b,ka,la):!1:l()}exports.equal_p=V;
function X(a,b){function c(d,f,h,g){return X(h(d),h(f))&&X(g(d),g(f))?(D(d,f),!0):!1}if(a===b)return!0;a=Jb(a);b=Jb(b);if(a===b)return!0;if(x(a)){if(!x(b))return!1;D(a,v);D(b,v);return!0}if(q(a))return q(b)?Hb(a,b):!1;if(u(a))return u(b)?c(a,b,ha,ia):!1;if(A(a))return A(b)?c(a,b,na,oa):!1;if(z(a))return z(b)?c(a,b,ka,la):!1;if(6===a[0])throw"WIP";if(7===a[0])throw"WIP";if(8===a[0])throw"WIP";if(9===a[0])throw"WIP";return l()}
function U(a){a=Jb(a);var b;if(x(a))return"()";if(u(a)){var c="(";for(b="";u(a);)c+=b+U(a[1]),b=" ",a=Jb(a[2]);return c=x(a)?c+")":c+(" . "+U(a)+")")}return z(a)?"#"+U([1,a[1],a[2]]):A(a)?"!"+U([1,a[1],a[2]]):q(a)?ea(a):6===a[0]?"$("+U(W(a[1]))+" "+U(a[2])+")":7===a[0]?"%("+U(a[1])+" "+U(P(a[2]))+")":8===a[0]?"@("+U(W(a[1]))+" "+U(a[2])+" "+U(P(a[3]))+")":9===a[0]?"^("+U(a[1])+" "+U(P(a[2]))+")":l()}exports.simple_print=U;exports.simple_print_force_all_rec=function(a){return U(va(a))};
function Yb(a){function b(){return ra.length===Da}function c(){!b()||l();var e=ra[Da];Da++;return e}function d(e){ra[Da-1]===e||l();Da--}function f(e){void 0===e&&(e="");throw"TheLanguage parse ERROR!"+e;}function h(e){return" "===e||"\n"===e||"\t"===e||"\r"===e}function g(){if(b())return!1;var e=c();if(!h(e))return d(e),!1;for(;h(e)&&!b();)e=c();h(e)||d(e);return!0}function k(){if(b())return!1;var e=c(),p="";if(!T(e))return d(e),!1;for(;T(e)&&!b();)p+=e,e=c();T(e)?p+=e:d(e);return da(p)?t(p):f("Not Symbol"+
p)}function m(){if(b())return!1;var e=c();if("("!==e)return d(e),!1;for(var p=[10],r=p;;){g();if(b())return f();e=c();if(")"===e)return wa(p,v),r;if("."===e){g();e=Z();wa(p,e);g();if(b())return f();e=c();return")"!==e?f():r}d(e);e=Z();var J=[10];wa(p,[1,e,J]);p=J}}function n(){if(b())return!1;var e=c();if("#"!==e)return d(e),!1;e=m();return!1!==e&&u(e)?[3,e[1],e[2]]:f()}function w(){if(b())return!1;var e=c();if("!"!==e)return d(e),!1;e=m();return!1!==e&&u(e)?[4,e[1],e[2]]:f()}function N(e,p){return function(){if(b())return!1;
var r=c();if(r!==e)return d(r),!1;r=m();if(!1===r||!u(r))return f();var J=r[2];return u(J)&&x(J[2])?p(r[1],J[1]):f()}}function T(e){if(h(e))return!1;for(var p=0,r="()!#.$%^@~/->_:?[]&".split("");p<r.length;p++)if(r[p]===e)return!1;return!0}function Z(){g();for(var e=[m,sa,n,w,cb,db,eb,fb],p=0;p<e.length;p++){var r=e[p]();if(!1!==r)return r}return f()}function F(e){return!1===e?f():e}function H(e){F(!b());F(c()===e)}function y(e){function p(){H("[");var Ea=y();H("]");return Ea}void 0===e&&(e=!1);e=
e?[m,k,p,n,w,cb,db,eb,fb]:[m,ta,n,w,cb,db,eb,fb];for(var r=0;r<e.length;r++){var J=e[r]();if(!1!==J)return J}return f()}function Fa(e){if(b())return e;var p=c();if("."===p)return p=y(),M(L,M(G,M(e),K),p);if(":"===p)return p=y(),M(L,p,e);if("~"===p)return M(Ga,e);if("@"===p)return p=y(),M(L,M(G,[1,e,K],K),p);if("?"===p)return M(L,G,M(Ga,e));if("/"===p){for(e=[e];;){p=y(!0);e.push(p);if(b())break;p=c();if("/"!==p){d(p);break}}return M(Ha,P(e))}d(p);return e}function ta(){if(b())return!1;var e=c();if("&"===
e){F(!b());e=c();if("+"===e)return e=y(),M(I,M(E,e));d(e);e=y();return M(I,e)}if(":"===e){F(!b());e=c();if("&"===e)return H(">"),e=y(),M(L,M(I,M(G,K,e)),Aa);if(">"===e)return e=y(),M(L,M(G,K,e),Aa);d(e);e=y();return M(L,e,Aa)}if("+"===e)return e=y(),M(E,e);if("["===e)return e=y(),H("]"),Fa(e);if("_"===e)return H(":"),e=y(),M(L,e,K);d(e);e=k();return!1===e?!1:Fa(e)}function sa(){var e=ta();return!1===e?!1:q(e)?e:O(e)}var ra=a,Da=0,cb=N("$",function(e,p){var r=Vb(e);return!1===r?f():[6,r,p]}),db=N("%",
function(e,p){var r=Ib(p,function(J){return J},function(){return f()});return[7,e,r]}),eb=function(e,p){return function(){if(b())return!1;var r=c();if(r!==e)return d(r),!1;r=m();if(!1===r||!u(r))return f();var J=r[2];if(!u(J))return f();var Ea=J[2];return u(Ea)&&x(Ea[2])?p(r[1],J[1],Ea[1]):f()}}("@",function(e,p,r){r=Ib(r,function(J){return J},function(){return f()});e=Vb(e);return!1===e?f():[8,e,p,r]}),fb=N("^",function(e,p){var r=Ib(p,function(J){return J},function(){return f()});return[9,e,r]});
return Z()}exports.complex_parse=Yb;
function Y(a){function b(f,h){function g(N){return"inner"===h?"["+N+"]":N}if(q(f))return ea(f);var k=Q(f);if(!1!==k&&3===k.length&&X(k[0],L)){var m=Q(k[1]);if(!1!==m&&3===m.length&&X(m[0],G)){var n=m[1],w=Q(n);if(!1!==w&&1===w.length&&X(m[2],K))return g(b(w[0],"inner")+"."+b(k[2],"inner"));if(u(n)&&X(n[2],K)&&X(m[2],K))return g(b(n[1],"inner")+"@"+b(k[2],"inner"));if(X(n,K)&&X(k[2],Aa))return g(":>"+b(m[2],"inner"))}n=Q(k[2]);if(X(k[1],G)&&!1!==n&&2===n.length&&X(n[0],Ga))return g(b(n[1],"inner")+
"?");if(!1!==m&&2===m.length&&X(k[2],Aa)&&X(m[0],I)&&(m=Q(m[1]),!1!==m&&3===m.length&&X(m[0],G)&&X(m[1],K)))return g(":&>"+b(m[2],"inner"));m=X(k[2],K)?"_":X(k[2],Aa)?"":b(k[2],"inner");return g(m+":"+b(k[1],"inner"))}if(!1!==k&&2===k.length){if(X(k[0],I))return m=Q(k[1]),!1!==m&&2===m.length&&X(m[0],E)?g("&+"+b(m[1],"inner")):g("&"+b(k[1],"inner"));if(X(k[0],Ga))return g(b(k[1],"inner")+"~");if(X(k[0],E))return g("+"+b(k[1],"inner"));if(X(k[0],Ha)&&(k=Q(k[1]),!1!==k&&1<k.length)){m=b(k[0],"inner");
for(n=1;n<k.length;n++)m+="/"+b(k[n],"inner");return g(m)}}return"inner"===h?U(f):"top"===h?U(O(f)):l()}a=Yb(U(a));var c="",d="";if(x(a))return"()";if(u(a)){c="(";for(d="";u(a);)c+=d+Y(a[1]),d=" ",a=a[2];return c=x(a)?c+")":c+(" . "+Y(a)+")")}return z(a)?(c=a[1],a=a[2],d=Q(a),!1!==d&&2===d.length&&X(c,xa)&&X(d[0],E)?b(d[1],"top"):"#"+Y([1,c,a])):A(a)?"!"+Y([1,a[1],a[2]]):q(a)?ea(a):6===a[0]?"$("+Y(W(a[1]))+" "+Y(a[2])+")":7===a[0]?"%("+Y(a[1])+" "+Y(P(a[2]))+")":8===a[0]?"@("+Y(W(a[1]))+" "+Y(a[2])+
" "+Y(P(a[3]))+")":9===a[0]?"^("+Y(a[1])+" "+Y(P(a[2]))+")":l()}exports.complex_print=Y;
exports.machinetext_parse=function(a){function b(){function n(F){function H(ta){var sa=[10],ra=[10];w.push(sa);w.push(ra);wa(F,ta(sa,ra))}var y=f();if("^"===y){for(y="";;){var Fa=f();if("^"===Fa)break;y+=Fa}if(y in ba())wa(F,[0,y]);else return{value:c()}}else if("."===y)H(fa);else if("#"===y)H(ja);else if("!"===y)H(ma);else if("$"===y)H(function(ta,sa){return[6,Qb,M(Ab,vb,M(Bb,yb,ta),M(Bb,yb,sa))]});else if("_"===y)wa(F,v);else return{value:c()}}for(var w=[],N=0,T=g;N<T.length;N++){var Z=n(T[N]);
if("object"===typeof Z)return Z}g=w}function c(){throw"MT parse ERROR";}function d(n){if(!n)return c()}function f(){d(a.length>k);var n=a[k];k++;return n}for(var h=[10],g=[h],k=0;0!==g.length;){var m=b();if("object"===typeof m)return m.value}d(k==a.length);return h};
exports.machinetext_print=function(a){function b(){for(var f=[],h=0,g=c;h<g.length;h++){var k=g[h];k=Jb(k);var m=function(n,w,N,T){d+=w;f.push(N(n));f.push(T(n))};if(q(k))d+="^",d+=k[1],d+="^";else if(u(k))m(k,".",ha,ia);else if(x(k))d+="_";else if(z(k))m(k,"#",ka,la);else if(A(k))m(k,"!",na,oa);else if(Kb(k))k=Lb(k),m(k,"$",function(n){return W(n[1])},qa);else return{value:l()}}c=f}for(var c=[a],d="";0!==c.length;)if(a=b(),"object"===typeof a)return a.value;return d};exports.Trampoline=function(){};
function Zb(a){return function(){return[!1,a]}}exports.trampoline_return=Zb;function $b(a){return function(){return[!0,a()]}}exports.trampoline_delay=$b;function ac(a){for(a=a();a[0];)a=a[1]();return a[1]}exports.run_trampoline=ac;var bc=O([1,Ha,[1,[1,Wa,[1,[1,L,[1,Ua,[1,K,v]]],v]],v]]);exports.return_effect_systemName=bc;var cc=O([1,Ha,[1,[1,Wa,[1,Na,v]],v]]);exports.bind_effect_systemName=cc;exports.new_effect_bind=function(a,b){return[3,cc,M(a,b)]};
exports.new_effect_return=function(a){return[3,bc,a]};
function dc(a,b,c,d,f){void 0===f&&(f=!1);c=C(c);if(z(c)){var h=c[1],g=c[2];if(V(h,bc)){if(g=C(g),u(g)&&(h=g[1],g=C(g[2]),x(g))){if(!1===f){var k=h;h=function(){return a(k,d)}}else{var m=h;h=function(){return dc(a,b,[9,f,m],d)}}return $b(h)}}else if(V(h,cc)&&(g=C(g),u(g)&&(h=g[1],g=C(g[2]),u(g)))){var n=g[1];g=C(g[2]);if(x(g)){if(!1===f){var w=h;h=function(){return dc(a,b,w,d,n)}}else t("\u5e8f\u7532"),h=function(){throw"WIP";};return $b(h)}}}return!1===f?$b(function(){return b(c,d,a)}):$b(function(){return b(c,
d,function(N,T){return $b(function(){return dc(a,b,ua(f,[N]),T)})})})}exports.run_monad_trampoline=function(a,b,c,d){return dc(a,b,c,d)};exports.run_monad_stackoverflow=function(a,b,c,d){return ac(dc(function(f,h){return Zb(a(f,h))},function(f,h,g){return Zb(b(f,h,function(k,m){return ac(g(k,m))}))},c,d))};
