function m(){throw"TheLanguage PANIC";}
function aa(){var a={0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",A:"A",B:"B",C:"C",D:"D",E:"E",F:"F",G:"G",H:"H",I:"I",J:"J",K:"K",L:"L",M:"M",N:"N",O:"O",P:"P",Q:"Q",R:"R",S:"S",T:"T",U:"U",V:"V",W:"W",X:"X",Y:"Y",Z:"Z",a:"a",b:"b",c:"c",d:"d",e:"e",f:"f",g:"g",h:"h",i:"i",j:"j",k:"k",l:"l",m:"m",n:"n",o:"o",p:"p",q:"q",r:"r",s:"s",t:"t",u:"u",v:"v",w:"w",x:"x",y:"y",z:"z","\u4e00\u985e\u4f55\u7269":"\u3749","\u4e4b\u7269":"\ud86d\ude66","\u5176\u5b50":"\ud85a\udfaa","\u51fa\u5165\u6539\u6ec5":"\ud849\udc9f",
"\u5217\u5e8f":"\ud841\udf3a","\u5316\u6ec5":"\ud840\udfc1","\u53c3\u5f62":"\ud842\udef0","\u543e\u81ea":"\ud85a\udcf9","\u592a\u59cb\u521d\u6838":"\ud84d\udf57","\u5982\u82e5":"\ud85b\udc61","\u5b87\u5b99\u4ea1\u77e3":"\ud863\ude79","\u5c3e\u672b":"\ud847\udcb5","\u5e8f\u4e01":"\ud840\udda4","\u5e8f\u4e19":"\ud840\uddee","\u5e8f\u4e59":"\u3408","\u5e8f\u7532":"\ud840\uddda","\u5f0f\u5f62":"\u4f71","\u5f15\u7528":"\u39c8","\u61c9\u7528":"\ud853\udc06","\u6548\u61c9":"\u52b9","\u6620\u8868":"\ud850\udd54",
"\u662f\u975e":"\u6b24","\u69cb\u7269":"\ud845\udcab","\u70ba\u7b26\u540d\u9023":"\u2010","\u723b\u9670":"\u4f8c","\u723b\u967d":"\ud84c\udd84","\u7279\u5b9a\u5176\u7269":"\u4e93","\u7701\u7565\u4e00\u7269":"\u7567","\u7b26\u540d":"\u8b3c","\u7b49\u540c":"\u5f0c","\u89e3\u7b97":"\u7b6d","\u8a3b\u758f":"\u758e","\u8a5e\u7d20":"\ud85e\udd5d","\u8b2c\u8aa4":"\u4958","\u9023\u9838":"\u4e29","\u9593\u7a7a":"\ud84e\udcd3","\u9996\u59cb":"\ud866\udc10"};aa=function(){return a};return a}
function ba(){var a={0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",6:"6",7:"7",8:"8",9:"9",A:"A",B:"B",C:"C",D:"D",E:"E",F:"F",G:"G",H:"H",I:"I",J:"J",K:"K",L:"L",M:"M",N:"N",O:"O",P:"P",Q:"Q",R:"R",S:"S",T:"T",U:"U",V:"V",W:"W",X:"X",Y:"Y",Z:"Z",a:"a",b:"b",c:"c",d:"d",e:"e",f:"f",g:"g",h:"h",i:"i",j:"j",k:"k",l:"l",m:"m",n:"n",o:"o",p:"p",q:"q",r:"r",s:"s",t:"t",u:"u",v:"v",w:"w",x:"x",y:"y",z:"z","\u3749":"\u4e00\u985e\u4f55\u7269","\ud86d\ude66":"\u4e4b\u7269","\ud85a\udfaa":"\u5176\u5b50","\ud849\udc9f":"\u51fa\u5165\u6539\u6ec5",
"\ud841\udf3a":"\u5217\u5e8f","\ud840\udfc1":"\u5316\u6ec5","\ud842\udef0":"\u53c3\u5f62","\ud85a\udcf9":"\u543e\u81ea","\ud84d\udf57":"\u592a\u59cb\u521d\u6838","\ud85b\udc61":"\u5982\u82e5","\ud863\ude79":"\u5b87\u5b99\u4ea1\u77e3","\ud847\udcb5":"\u5c3e\u672b","\ud840\udda4":"\u5e8f\u4e01","\ud840\uddee":"\u5e8f\u4e19","\u3408":"\u5e8f\u4e59","\ud840\uddda":"\u5e8f\u7532","\u4f71":"\u5f0f\u5f62","\u39c8":"\u5f15\u7528","\ud853\udc06":"\u61c9\u7528","\u52b9":"\u6548\u61c9","\ud850\udd54":"\u6620\u8868",
"\u6b24":"\u662f\u975e","\ud845\udcab":"\u69cb\u7269","\u2010":"\u70ba\u7b26\u540d\u9023","\u4f8c":"\u723b\u9670","\ud84c\udd84":"\u723b\u967d","\u4e93":"\u7279\u5b9a\u5176\u7269","\u7567":"\u7701\u7565\u4e00\u7269","\u8b3c":"\u7b26\u540d","\u5f0c":"\u7b49\u540c","\u7b6d":"\u89e3\u7b97","\u758e":"\u8a3b\u758f","\ud85e\udd5d":"\u8a5e\u7d20","\u4958":"\u8b2c\u8aa4","\u4e29":"\u9023\u9838","\ud84e\udcd3":"\u9593\u7a7a","\ud866\udc10":"\u9996\u59cb"};ba=function(){return a};return a}
function da(a,b){return[11,a,b]}exports.new_comment=da;function q(a){return 11===a[0]}exports.comment_p=q;exports.comment_comment=function(a){return a[1]};exports.comment_x=function(a){return a[2]};function ea(a){for(;q(a);)a=a[2];return a}exports.un_comment_all=ea;function t(a){return 0===a[0]}exports.symbol_p=t;function fa(a){return a in aa()}exports.can_new_symbol_p=fa;function u(a){return[0,aa()[a]]}exports.new_symbol=u;function ha(a){return ba()[a[1]]}exports.un_symbol=ha;
function ia(a,b){return[1,a,b]}exports.new_construction=ia;function v(a){return 1===a[0]}exports.construction_p=v;function ja(a){return a[1]}exports.construction_head=ja;function ka(a){return a[2]}exports.construction_tail=ka;var x=[2];exports.null_v=x;function y(a){return 2===a[0]}exports.null_p=y;function na(a,b){return[3,a,b]}exports.new_data=na;function z(a){return 3===a[0]}exports.data_p=z;function oa(a){return a[1]}exports.data_name=oa;function pa(a){return a[2]}exports.data_list=pa;
function qa(a,b){return[4,a,b]}exports.new_error=qa;function A(a){return 4===a[0]}exports.error_p=A;function ra(a){return a[1]}exports.error_name=ra;function sa(a){return a[2]}exports.error_list=sa;function ta(a){return 5===a[0]}exports.just_p=ta;exports.evaluate=function(a,b){return[6,a,b]};function ua(a){return a[2]}function B(a,b){return[7,a,b]}function va(a,b){return[9,a,b]}exports.apply=va;function ya(a){a=C(a);if(z(a)||A(a)||v(a)||q(a))a[1]=ya(a[1]),a[2]=ya(a[2]);return a}
exports.force_all_rec=ya;function za(a){var b=Aa(a);if(z(b)||A(b)||v(b))if(b[1]=ya(b[1]),b[2]=ya(b[2]),q(b[1])||q(b[2])){a=[10];Ba(a,b);var c=b[2];b=za(b[1]);c=za(c);a[1]=b;a[2]=c}else a=b;else a=b;return a}exports.force_uncomment_all_rec=za;function D(a,b){a!==b&&(a[0]=5,a[1]=b,a[2]=!1,a[3]=!1)}function Ba(a,b){10===a[0]||m();10!==b[0]||m();a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3]}
var E=u("\u592a\u59cb\u521d\u6838"),Ca=u("\u7b26\u540d"),G=u("\u5316\u6ec5"),J=u("\u5f0f\u5f62"),Da=u("\u7b49\u540c"),Ea=u("\u89e3\u7b97"),Fa=u("\u7279\u5b9a\u5176\u7269"),K=u("\u7701\u7565\u4e00\u7269"),Ja=u("\u6620\u8868"),Ka=u("\u5982\u82e5"),L=u("\u4e00\u985e\u4f55\u7269"),La=u("\u662f\u975e"),Ma=u("\u5176\u5b50"),Na=u("\u723b\u967d"),Oa=u("\u723b\u9670"),Pa=u("\u5f15\u7528"),Qa=u("\u61c9\u7528"),Ra=u("\u9593\u7a7a"),Sa=u("\u9023\u9838"),Ta=u("\u69cb\u7269"),Ua=u("\u8b2c\u8aa4"),Va=u("\u8a5e\u7d20"),
Wa=u("\u5217\u5e8f"),Xa=u("\u9996\u59cb"),Ya=u("\u5c3e\u672b"),Za=u("\u4e4b\u7269"),$a=u("\u5b87\u5b99\u4ea1\u77e3"),ab=u("\u6548\u61c9"),bb=u("\u8a3b\u758f"),cb=[4,E,O($a,K)];function P(a){return[3,Ca,[1,E,[1,a,x]]]}function db(a){return P(O(L,O(G,K,a),Fa))}function eb(a,b){return P(O(L,O(G,O(a),K),b))}function fb(a){return P(O(L,G,O(La,O(L,a,K))))}
var ib=db(Ta),jb=eb(Ta,Ca),kb=eb(Ta,Wa),lb=fb(Ta),mb=db(Ua),nb=eb(Ua,Ca),ob=eb(Ua,Wa),pb=fb(Ua),qb=db(Sa),rb=fb(Sa),sb=eb(Sa,Xa),tb=eb(Sa,Ya),ub=fb(Va),vb=fb(Ra),wb=P(O(L,G,O(La,Da))),xb=P(O(L,O(G,[1,G,K],K),Qa)),yb=P(O(L,G,Ea)),zb=eb(Wa,O(L,Za,K)),Ab=P(O(L,G,Ka)),Bb=P(O(L,J,Pa)),Cb=P(O(L,O(J,O(G,K,G)),Fa)),Db=P(O(J,O(E,G))),Eb=P(O(J,O(E,J))),Fb=P(O(J,J)),Gb=P(O(L,G,bb)),Hb=P(O(L,J,bb)),Ib=[3,Oa,O()],Jb=[3,Na,O()];function Kb(a,b){return a===b?!0:a[1]===b[1]?(D(a,b),!0):!1}
function Q(a){for(var b=x,c=a.length-1;0<=c;c--)b=[1,a[c],b];return b}exports.jsArray_to_list=Q;function Lb(a,b,c){for(var e=[];v(a);)e.push(a[1]),a=a[2];return y(a)?b(e):c(e,a)}function Mb(a){return Lb(a,function(b){return b},function(){return!1})}exports.maybe_list_to_jsArray=Mb;function O(){for(var a=[],b=0;b<arguments.length;b++)a[b]=arguments[b];return Q(a)}exports.new_list=O;
function Nb(a){if(!ta(a))return a;for(var b=[];ta(a);)b.push(a),a=a[1];for(var c=0;c<b.length;c++)D(b[c],a);return a}exports.un_just_all=Nb;exports.un_just_comment_all=function(a){for(;ta(a)||q(a);)a=Nb(ea(a));return a};function Ob(a){return 6===a[0]||8===a[0]||7===a[0]||9===a[0]}exports.delay_p=Ob;function R(a){return ta(a)||Ob(a)}exports.delay_just_p=R;function Pb(a){if(6===a[0])return a;if(8===a[0])throw"WIP";if(7===a[0])throw"WIP";if(9===a[0])throw"WIP";return m()}exports.delay_env=function(a){return Pb(a)[1]};
exports.delay_x=function(a){return Pb(a)[2]};
function C(a,b,c,e){function f(F){D(n,F);for(var H=0;H<e.length;H++)D(e[H],F);return F}function h(){c[1]=!0;return g(cb)}function g(F){f(F);return R(F)?(e.push(n),C(F,b,[!1,!1],e)):F}function l(){var F={},H;for(H in k)F[H]=!0;for(H in b)F[H]=!0;return F}void 0===b&&(b={});void 0===c&&(c=[!1,!1]);void 0===e&&(e=[]);var k={},n=a;for(a=0;R(n)&&32>a;a++)e.push(n),n=T(n);for(;R(n);){a=U(n);if(!0===b[a])return h();if(!0===k[a]){c[0]=!0;if(6===n[0])return h();if(7===n[0]){a=n[1];for(var w=n[2],M=!1,V=0,
ca=[jb,kb,lb,nb,ob,pb,rb,sb,tb,ub,vb];V<ca.length;V++)if(X(ca[V],a)){M=!0;break}if(M)return 1===w.length||m(),!1===c[1]||m(),w=C(w[0],l(),c),c[1]?g(B(a,[w])):m();if(X(a,wb)||X(a,xb)||X(a,yb))return h();if(X(a,Ab)&&(3===w.length||m(),!1===c[1]||m(),a=C(w[0],l(),c),c[1]))return g(B(Ab,[a,w[1],w[2]]))}else if(8===n[0]||9===n[0])return h();return m()}k[a]=!0;e.push(n);n=T(n)}return f(n)}
function T(a){var b=Nb(a);!ta(b)||m();a=6===b[0]?Qb(b[1],b[2],a):8===b[0]?Rb(b[1],b[2],b[3]):7===b[0]?Sb(b[1],b[2],a):9===b[0]?Tb(b[1],b[2],a):b;a=Nb(a);D(b,a);return a}exports.force1=T;exports.force_all=function(a){return C(a)};function Aa(a){for(;R(a)||q(a);)a=C(ea(a));return a}exports.force_uncomment_all=Aa;exports.force_uncomment1=function(a){return q(a)?a[2]:T(a)};var Ub=[];exports.env_null_v=Ub;
function Vb(a,b,c){for(var e=[],f=0;f<a.length;f+=2){if(X(a[f],b)){e[f]=b;e[f+1]=c;for(f+=2;f<a.length;f+=2)e[f]=a[f],e[f+1]=a[f+1];return e}e[f]=a[f];e[f+1]=a[f+1]}e[a.length]=b;e[a.length+1]=c;return e}exports.env_set=Vb;function Wb(a,b,c){for(var e=0;e<a.length;e+=2)if(X(a[e],b))return a[e+1];return c}exports.env_get=Wb;function Xb(a,b){for(var c=0;c<a.length;c+=2)if(X(a[c],b))return a[c+1];return m()}function Yb(a){for(var b=x,c=0;c<a.length;c+=2)b=[1,O(a[c],a[c+1]),b];return[3,Ja,O(b)]}
exports.env2val=Yb;function Zb(a,b){for(var c=0;c<a.length;c+=2)b(a[c],a[c+1])}exports.env_foreach=Zb;function $b(a){a=C(a);if(!z(a))return!1;var b=C(a[1]);if(!t(b)||!Kb(b,Ja))return!1;b=C(a[2]);if(!v(b)||!y(C(b[2])))return!1;a=[];for(b=C(b[1]);!y(b);){if(!v(b))return!1;var c=C(b[1]);b=C(b[2]);if(!v(c))return!1;var e=c[1];c=C(c[2]);if(!v(c))return!1;var f=c[1];if(!y(C(c[2])))return!1;c=!0;for(var h=0;h<a.length;h+=2)if(X(a[h],e)){a[h+1]=f;c=!1;break}c&&(a.push(e),a.push(f))}return a}
exports.val2env=$b;function ac(a,b,c,e){var f=[],h=[];a=Nb(a);for(var g=!0;;){if(y(a))return e(h,f);if(q(a))h.push(a[1]),a=a[2];else if(v(a))f.push(a[1]),a=a[2];else if(R(a))if(g)g=!1,a=T(a);else return c();else return b()}}
function Qb(a,b,c){function e(){return[4,E,O(Db,O(yb,O(Yb(a),f)))]}var f=T(b);return R(f)?c:v(f)?ac(f,e,function(){return c},function(h,g){if(0!==h.length)throw"WIP";if(X(g[0],Eb)){if(1===g.length)return e();for(var l=g[1],k=[],n=2;n<g.length;n++)k.push(g[n]);return[8,a,l,k]}if(X(g[0],Fb)){if(1===g.length)return e();l=C([6,a,g[1]]);if(!z(l))return e();k=T(l[1]);if(R(k))return c;if(!t(k)||!Kb(k,J))return e();k=T(l[2]);if(R(k))return c;if(!v(k))return e();l=k[1];k=T(k[2]);if(R(k))return c;if(!y(k))return e();
k=[Yb(a)];for(n=2;n<g.length;n++)k.push(g[n]);return[9,l,k]}if(X(g[0],Db)){if(1===g.length)return e();l=g[1];k=[];for(n=2;n<g.length;n++)k.push([6,a,g[n]]);return[7,l,k]}l=[6,a,g[0]];k=[];for(n=1;n<g.length;n++)k.push([6,a,g[n]]);return[9,l,k]}):y(f)?f:t(f)||z(f)?Wb(a,f,e()):A(f)?e():m()}function bc(a,b){return[a,1,function(c){c=T(c);return R(c)?B(a,[c]):b(c)?Jb:Ib}]}function cc(a,b,c){return[a,1,function(e,f){e=T(e);return R(e)?B(a,[e]):b(e)?c(e):f()}]}
var dc=[bc(lb,z),[ib,2,na],cc(jb,z,oa),cc(kb,z,pa),bc(pb,A),[mb,2,qa],cc(nb,A,ra),cc(ob,A,sa),bc(vb,y),[qb,2,ia],bc(rb,v),cc(sb,v,ja),cc(tb,v,ka),[wb,2,function(a,b){function c(e,f,h,g){h=B(wb,[h(e),h(f)]);e=B(wb,[g(e),g(f)]);return B(Ab,[h,e,Ib])}if(a===b)return Jb;a=T(a);b=T(b);if(R(a)||R(b))return B(wb,[a,b]);if(a===b)return Jb;!R(a)||m();return y(a)?y(a)?Jb:Ib:t(a)?t(b)?Kb(a,b)?Jb:Ib:Ib:z(a)?z(b)?c(a,b,oa,pa):Ib:v(a)?v(b)?c(a,b,ja,ka):Ib:A(a)?A(b)?c(a,b,ra,sa):Ib:m()}],[xb,2,function(a,b,c){var e=
[];for(b=C(b);v(b);)e.push(b[1]),b=C(b[2]);return y(b)?[9,a,e]:c()}],[yb,2,function(a,b,c){a=$b(a);return!1===a?c():[6,a,b]}],bc(ub,t),[zb,1,function(a,b){a=T(a);return R(a)?B(zb,[a]):v(a)?a[1]:b()}],[Ab,3,function(a,b,c,e){a=T(a);if(R(a))return B(Ab,[a,b,c]);if(!z(a))return e();a=C(a[1]);return t(a)?Kb(a,Na)?b:Kb(a,Oa)?c:e():e()}],[Gb,2,da]];
function Tb(a,b,c){function e(){return[4,E,O(Db,O(xb,O(a,Q(b))))]}a=T(a);if(R(a))return c;if(!z(a))return e();c=C(a[1]);if(!t(c)||!Kb(c,G))return e();var f=C(a[2]);if(!v(f))return e();c=ya(f[1]);f=C(f[2]);if(!v(f)||!y(C(f[2])))return e();f=f[1];for(var h=Ub,g=0;!y(c);)if(t(c)||z(c)){for(var l=x,k=b.length-1;k>=g;k--)l=[1,b[k],l];h=Vb(h,c,l);g=b.length;c=x}else if(v(c))if(g<b.length)l=b[g],g++,h=Vb(h,c[1],l),c=c[2];else return e();else return e();return b.length!==g?e():[6,h,f]}
function Sb(a,b,c){function e(){return[4,E,O(Db,O(a,Q(b)))]}for(var f=0;f<dc.length;f++){var h=dc[f];if(X(a,h[0])){if(b.length!==h[1])break;return 1===h[1]?h[2](b[0],e,c):2===h[1]?h[2](b[0],b[1],e,c):3===h[1]?h[2](b[0],b[1],b[2],e,c):m()}}return e()}function Rb(a,b,c){function e(){return[4,E,O(Eb,O(Yb(a),b,Q(c)))]}return X(b,Bb)?1!==c.length?e():c[0]:X(b,Cb)?2!==c.length?e():ec(a,c[0],c[1],e):X(b,Hb)?2!==c.length?e():[11,c[0],[6,a,c[1]]]:e()}
function ec(a,b,c,e){b=ya(b);for(var f=[],h=!1,g=b;!y(g);)if(t(g)||z(g))f.push(g),h=!0,g=x;else if(v(g))f.push(g[1]),g=g[2];else return e();g=h?Q(f):b;var l=[];Zb(a,function(k){for(var n=0;n<f.length;n++)if(X(f[n],k))return;l.push(k)});e=g;for(h=l.length-1;0<=h;h--)e=[1,l[h],e];for(h=l.length-1;0<=h;h--)g=ia(O(Eb,Bb,Xb(a,l[h])),g);return[3,G,O(b,[1,O(Eb,Bb,[3,G,O(e,c)]),g])]}
function X(a,b){function c(e,f,h,g){return X(h(e),h(f))&&X(g(e),g(f))?(D(e,f),!0):!1}if(a===b)return!0;a=C(a);b=C(b);if(a===b)return!0;if(y(a)){if(!y(b))return!1;D(a,x);D(b,x);return!0}return t(a)?t(b)?Kb(a,b):!1:v(a)?v(b)?c(a,b,ja,ka):!1:A(a)?A(b)?c(a,b,ra,sa):!1:z(a)?z(b)?c(a,b,oa,pa):!1:m()}exports.equal_p=X;
function Y(a,b){function c(e,f,h,g){return Y(h(e),h(f))&&Y(g(e),g(f))?(D(e,f),!0):!1}if(a===b)return!0;a=Nb(a);b=Nb(b);if(a===b)return!0;if(y(a)){if(!y(b))return!1;D(a,x);D(b,x);return!0}if(t(a))return t(b)?Kb(a,b):!1;if(v(a))return v(b)?c(a,b,ja,ka):!1;if(A(a))return A(b)?c(a,b,ra,sa):!1;if(z(a))return z(b)?c(a,b,oa,pa):!1;if(6===a[0])throw"WIP";if(7===a[0])throw"WIP";if(8===a[0])throw"WIP";if(9===a[0])throw"WIP";return m()}
function U(a){a=Nb(a);var b;if(y(a))return"()";if(v(a)){var c="(";for(b="";v(a);)c+=b+U(a[1]),b=" ",a=Nb(a[2]);return c=y(a)?c+")":c+(" . "+U(a)+")")}return z(a)?"#"+U([1,a[1],a[2]]):A(a)?"!"+U([1,a[1],a[2]]):t(a)?ha(a):q(a)?";("+U(a[1])+" "+U(a[2])+")":6===a[0]?"$("+U(Yb(a[1]))+" "+U(a[2])+")":7===a[0]?"%("+U(a[1])+" "+U(Q(a[2]))+")":8===a[0]?"@("+U(Yb(a[1]))+" "+U(a[2])+" "+U(Q(a[3]))+")":9===a[0]?"^("+U(a[1])+" "+U(Q(a[2]))+")":m()}exports.simple_print=U;
function fc(a){function b(){return la.length===S}function c(){!b()||m();var d=la[S];S++;return d}function e(d){la[S-1]===d||m();S--}function f(d){void 0===d&&(d="");throw"TheLanguage parse ERROR!"+d;}function h(d){return" "===d||"\n"===d||"\t"===d||"\r"===d}function g(){if(b())return!1;var d=c();if(!h(d))return e(d),!1;for(;h(d)&&!b();)d=c();h(d)||e(d);return!0}function l(){if(b())return!1;var d=c(),p="";if(!V(d))return e(d),!1;for(;V(d)&&!b();)p+=d,d=c();V(d)?p+=d:e(d);return fa(p)?u(p):f("Not Symbol"+
p)}function k(){if(b())return!1;var d=c();if("("!==d)return e(d),!1;for(var p=[10],r=p;;){g();if(b())return f();d=c();if(")"===d)return Ba(p,x),r;if("."===d){g();d=ca();Ba(p,d);g();if(b())return f();d=c();return")"!==d?f():r}e(d);d=ca();var I=[10];Ba(p,[1,d,I]);p=I}}function n(){if(b())return!1;var d=c();if("#"!==d)return e(d),!1;d=k();return!1!==d&&v(d)?[3,d[1],d[2]]:f()}function w(){if(b())return!1;var d=c();if("!"!==d)return e(d),!1;d=k();return!1!==d&&v(d)?[4,d[1],d[2]]:f()}function M(d,p){return function(){if(b())return!1;
var r=c();if(r!==d)return e(r),!1;r=k();if(!1===r||!v(r))return f();var I=r[2];return v(I)&&y(I[2])?p(r[1],I[1]):f()}}function V(d){if(h(d))return!1;for(var p=0,r="()!#.$%^@~/->_:?[]&;".split("");p<r.length;p++)if(r[p]===d)return!1;return!0}function ca(){g();for(var d=0,p=[k,Ga,n,w,wa,xa,ma,gb,hb];d<p.length;d++){var r=(0,p[d])();if(!1!==r)return r}return f()}function F(d){return!1===d?f():d}function H(d){F(!b());F(c()===d)}function N(d){function p(){H("[");var Ha=N();H("]");return Ha}void 0===d&&
(d=!1);var r=0;for(d=d?[k,l,p,n,w,wa,xa,ma,gb,hb]:[k,Ia,n,w,wa,xa,ma,gb,hb];r<d.length;r++){var I=(0,d[r])();if(!1!==I)return I}return f()}function W(d){if(b())return d;var p=c();if("."===p)return p=N(),O(L,O(G,O(d),K),p);if(":"===p)return p=N(),O(L,p,d);if("~"===p)return O(La,d);if("@"===p)return p=N(),O(L,O(G,[1,d,K],K),p);if("?"===p)return O(L,G,O(La,d));if("/"===p){for(d=[d];;){p=N(!0);d.push(p);if(b())break;p=c();if("/"!==p){e(p);break}}return O(Ma,Q(d))}e(p);return d}function Ia(){if(b())return!1;
var d=c();if("&"===d){F(!b());d=c();if("+"===d)return d=N(),O(J,O(E,d));e(d);d=N();return O(J,d)}if(":"===d){F(!b());d=c();if("&"===d)return H(">"),d=N(),O(L,O(J,O(G,K,d)),Fa);if(">"===d)return d=N(),O(L,O(G,K,d),Fa);e(d);d=N();return O(L,d,Fa)}if("+"===d)return d=N(),O(E,d);if("["===d)return d=N(),H("]"),W(d);if("_"===d)return H(":"),d=N(),O(L,d,K);e(d);d=l();return!1===d?!1:W(d)}function Ga(){var d=Ia();return!1===d?!1:t(d)?d:P(d)}var la=a,S=0,wa=M("$",function(d,p){var r=$b(d);return!1===r?f():
[6,r,p]}),xa=M("%",function(d,p){var r=Lb(p,function(I){return I},function(){return f()});return[7,d,r]}),ma=function(d,p){return function(){if(b())return!1;var r=c();if(r!==d)return e(r),!1;r=k();if(!1===r||!v(r))return f();var I=r[2];if(!v(I))return f();var Ha=I[2];return v(Ha)&&y(Ha[2])?p(r[1],I[1],Ha[1]):f()}}("@",function(d,p,r){r=Lb(r,function(I){return I},function(){return f()});d=$b(d);return!1===d?f():[8,d,p,r]}),gb=M("^",function(d,p){var r=Lb(p,function(I){return I},function(){return f()});
return[9,d,r]}),hb=M(";",function(d,p){return[11,d,p]});return ca()}exports.complex_parse=fc;
function Z(a){function b(f,h){function g(M){return h?"["+M+"]":M}if(t(f))return ha(f);var l=Mb(f);if(!1!==l&&3===l.length&&Y(l[0],L)){var k=Mb(l[1]);if(!1!==k&&3===k.length&&Y(k[0],G)){var n=k[1],w=Mb(n);if(!1!==w&&1===w.length&&Y(k[2],K))return g(b(w[0],!0)+"."+b(l[2],!0));if(v(n)&&Y(n[2],K)&&Y(k[2],K))return g(b(n[1],!0)+"@"+b(l[2],!0));if(Y(n,K)&&Y(l[2],Fa))return g(":>"+b(k[2],!0))}n=Mb(l[2]);if(Y(l[1],G)&&!1!==n&&2===n.length&&Y(n[0],La))return g(b(n[1],!0)+"?");if(!1!==k&&2===k.length&&Y(l[2],
Fa)&&Y(k[0],J)&&(k=Mb(k[1]),!1!==k&&3===k.length&&Y(k[0],G)&&Y(k[1],K)))return g(":&>"+b(k[2],!0));k=Y(l[2],K)?"_":Y(l[2],Fa)?"":b(l[2],!0);return g(k+":"+b(l[1],!0))}if(!1!==l&&2===l.length){if(Y(l[0],J))return k=Mb(l[1]),!1!==k&&2===k.length&&Y(k[0],E)?g("&+"+b(k[1],!0)):g("&"+b(l[1],!0));if(Y(l[0],La))return g(b(l[1],!0)+"~");if(Y(l[0],E))return g("+"+b(l[1],!0));if(Y(l[0],Ma)&&(l=Mb(l[1]),!1!==l&&1<l.length)){k=b(l[0],!0);for(n=1;n<l.length;n++)k+="/"+b(l[n],!0);return g(k)}}return h?U(f):U(P(f))}
a=fc(U(a));var c="",e="";if(y(a))return"()";if(v(a)){c="(";for(e="";v(a);)c+=e+Z(a[1]),e=" ",a=a[2];return c=y(a)?c+")":c+(" . "+Z(a)+")")}return z(a)?(c=a[1],a=a[2],e=Mb(a),!1!==e&&2===e.length&&Y(c,Ca)&&Y(e[0],E)?b(e[1],!1):"#"+Z([1,c,a])):A(a)?"!"+Z([1,a[1],a[2]]):t(a)?ha(a):q(a)?";("+Z(a[1])+" "+Z(a[2])+")":6===a[0]?"$("+Z(Yb(a[1]))+" "+Z(a[2])+")":7===a[0]?"%("+Z(a[1])+" "+Z(Q(a[2]))+")":8===a[0]?"@("+Z(Yb(a[1]))+" "+Z(a[2])+" "+Z(Q(a[3]))+")":9===a[0]?"^("+Z(a[1])+" "+Z(Q(a[2]))+")":m()}
exports.complex_print=Z;
exports.machinetext_parse=function(a){function b(){function w(H){function N(S){var wa=[10],xa=[10];M.push(function(ma){return Ba(wa,ma)});M.push(function(ma){return Ba(xa,ma)});H(S(wa,xa))}var W=f();if("^"===W){for(W="";;){var Ia=f();if("^"===Ia)break;W+=Ia}if(W in ba())H([0,W]);else return{value:c()}}else if("."===W)N(ia);else if("#"===W)N(na);else if("!"===W)N(qa);else if("$"===W){var Ga=!1,la=!1;M.push(function(S){Ga=S});M.push(function(S){la=S});k.push(function(){if(!1===Ga||!1===la)return m();
var S=$b(Ga);if(!1===S)return c();H([6,S,la])})}else if("_"===W)H(x);else return{value:c()}}for(var M=[],V=0,ca=g;V<ca.length;V++){var F=w(ca[V]);if("object"===typeof F)return F}g=M}function c(){throw"MT parse ERROR";}function e(w){if(!w)return c()}function f(){e(a.length>l);var w=a[l];l++;return w}for(var h=[10],g=[function(w){return Ba(h,w)}],l=0,k=[];0!==g.length;){var n=b();if("object"===typeof n)return n.value}e(l===a.length);for(n=k.length-1;0<=n;n--)k[n]();return h};
function gc(a){for(var b=[],c=[],e=0;e<a.length;e++){var f=a[e];f=Nb(f);var h=function(g,l,k,n){b.push(l);c.push(k(g));c.push(n(g))};if(t(f))b.push("^"),b.push(f[1]),b.push("^");else if(v(f))h(f,".",ja,ka);else if(y(f))b.push("_");else if(z(f))h(f,"#",oa,pa);else if(A(f))h(f,"!",ra,sa);else if(Ob(f))f=Pb(f),h(f,"$",function(g){return Yb(g[1])},ua);else return m()}return[b,c]}
exports.machinetext_print=function(a){var b=[a];for(a="";0!==b.length;){var c=gc(b);b=c[1];var e=0;for(c=c[0];e<c.length;e++)a+=c[e]}return a};exports.Trampoline=function(){};function hc(a){return function(){return[!1,a]}}exports.trampoline_return=hc;function ic(a){return function(){return[!0,a()]}}exports.trampoline_delay=ic;function jc(a){for(a=a();a[0];)a=a[1]();return a[1]}exports.run_trampoline=jc;var kc=P([1,Ma,[1,[1,ab,[1,[1,L,[1,Za,[1,K,x]]],x]],x]]);exports.return_effect_systemName=kc;
var lc=P([1,Ma,[1,[1,ab,[1,Sa,x]],x]]);exports.bind_effect_systemName=lc;exports.new_effect_bind=function(a,b){return[3,lc,O(a,b)]};exports.new_effect_return=function(a){return[3,kc,a]};
function mc(a,b,c,e,f){void 0===f&&(f=!1);c=C(c);if(z(c)){var h=c[1],g=c[2];if(X(h,kc)){if(g=C(g),v(g)&&(h=g[1],g=C(g[2]),y(g))){if(!1===f){var l=h;h=function(){return a(l,e)}}else{var k=h;h=function(){return mc(a,b,[9,f,k],e)}}return ic(h)}}else if(X(h,lc)&&(g=C(g),v(g)&&(h=g[1],g=C(g[2]),v(g)))){var n=g[1];g=C(g[2]);if(y(g)){if(!1===f){var w=h;h=function(){return mc(a,b,w,e,n)}}else u("\u5e8f\u7532"),h=function(){throw"WIP";};return ic(h)}}}return!1===f?ic(function(){return b(c,e,a)}):ic(function(){return b(c,
e,function(M,V){return ic(function(){return mc(a,b,va(f,[M]),V)})})})}exports.run_monad_trampoline=function(a,b,c,e){return mc(a,b,c,e)};exports.run_monad_stackoverflow=function(a,b,c,e){return jc(mc(function(f,h){return hc(a(f,h))},function(f,h,g){return hc(b(f,h,function(l,k){return jc(g(l,k))}))},c,e))};
